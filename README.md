# Table of contents

- [Installfest](#installfest)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
- [Intro to Javascript](#intro-to-javascript)
  - [Visual Studio Code](#visual-studio-code)
  - [Assignments](#assignments)
- [Intro to Javascript](#intro-to-javascript)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Assignments](#assignments)
- [Intro to Python](#intro-to-python)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Assignments](#assignments)
- [Python List Methods and Modules](#python-list-methods-and-modules)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Modules, Packages, Libraries, and Frameworks](#modules-packages-libraries-and-frameworks)
  - [Resources](#resources)
  - [Assignments](#assignments)
- [Python OOP](#python-oop)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Assignments](#assignments)
- [Decorators, Static Methods vs Instance Methods, Getters and Setters](#decorators-static-methods-vs-instance-methods-getters-and-setters)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [Python OOP Inheritance](#python-oop-inheritance)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [Javascript OOP](#javascript-oop)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Assignments](#assignments)
- [Data Structures](#data-structures)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Why does this matter? Why is there more than one data structure?](#why-does-this-matter-why-is-there-more-than-one-data-structure)
  - [Arrays](#arrays)
  - [Linked list](#linked-list)
  - [stack](#stack)
  - [queue](#queue)
  - [Hash table](#hash-table)
  - [Other data structures](#other-data-structures)
  - [Resources](#resources)
  - [Assignments](#assignments)
- [Big O](#big-o)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Resources](#resources)
  - [Assignments](#assignments)
- [The Call Stack and Recursion](#the-call-stack-and-recursion)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [HTML and CSS](#html-and-css)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [CSS Specificity](#css-specificity)
  - [Assignments](#assignments)
- [CSS Layout](#css-layout)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [Responsive Web Design](#responsive-web-design)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [DOM Events](#dom-events)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Assignments](#assignments)
  - [Additional Resources](#additional-resources)
- [HTTP and AJAX](#http-and-ajax)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [Simplest Django Server](#simplest-django-server)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Assignments](#assignments)
- [Django Projects and Apps](#django-projects-and-apps)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Assignments](#assignments)
- [Backend APIs](#backend-apis)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Assignments](#assignments)
- [Into to Databases and SQL](#into-to-databases-and-sql)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [Hashrocket SQL Workshop](#hashrocket-sql-workshop)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Assignments](#assignments)
- [Constraints and Relationships](#constraints-and-relationships)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Assignments](#assignments)
- [SQL Review Day](#sql-review-day)
  - [Assignments](#assignments)
- [Django-ORM](#django-orm)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [Django validators](#django-validators)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Django Associations](#django-associations)
  - [Another Example using Validator and Associations](#another-example-using-validator-and-associations)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [Django Polls App](#django-polls-app)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [Sessions and cookies](#sessions-and-cookies)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [Django Auth](#django-auth)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [Intro to React](#intro-to-react)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Student Challenge](#student-challenge)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [React Workshop](#react-workshop)
  - [Assignments](#assignments)
- [News Site I](#news-site-i)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Component I: AppNav](#component-i-appnav)
  - [Component II: ArticleTeaser](#component-ii-articleteaser)
  - [Component II: Article](#component-ii-article)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [News Site II](#news-site-ii)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [ArticlePage Component](#articlepage-component)
  - [HomePage Component](#homepage-component)
  - [Assignments](#assignments)
  - [Django ORM Review](#django-orm-review)
- [News Site III](#news-site-iii)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
- [News Site III](#news-site-iii)
  - [Change NavBar](#change-navbar)
  - [The Section Page](#the-section-page)
  - [Section Links in `AppNav.js`](#section-links-in-appnavjs)
  - [Article Search](#article-search)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [News Site IV](#news-site-iv)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Getting Data from an API](#getting-data-from-an-api)
  - [Asynchronous Code](#asynchronous-code)
  - [Promises](#promises)
  - [Axios](#axios)
  - [Integrating ArticlesAPI.js into your App](#integrating-articlesapijs-into-your-app)
  - [Assignments](#assignments)
  - [News Site VI](#news-site-vi)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [- useEffect()](#--useeffect)
  - [Lesson](#lesson)
- [Full-stack App](#full-stack-app)
  - [Lesson](#lesson)
- [Deployment](#deployment)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [Restful API design](#restful-api-design)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [Example API](#example-api)
  - [Caching.](#caching)
  - [HATEOAS (Hypermedia as the engine of application state)](#hateoas-hypermedia-as-the-engine-of-application-state)
  - [When to use/not use REST](#when-to-usenot-use-rest)
  - [Assignments](#assignments)
- [Regex](#regex)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Lesson](#lesson)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
- [Web Security Workshop w/Ronnie Flathers](#web-security-workshop-wronnie-flathers)
  - [Topics Covered / Goals](#topics-covered--goals)
  - [Assignments](#assignments)
- [Intermediate Git](#intermediate-git)
  - [Objectives](#objectives)
  - [Branching strategy and Git Flow](#branching-strategy-and-git-flow)
  - [Assignments](#assignments)
- [Application Testing](#application-testing)
  - [Topics Covered](#topics-covered)
  - [Goals](#goals)
  - [Lesson](#lesson)
  - [External Resources](#external-resources)
  - [Assignments](#assignments)
# Installfest

[example](#intro-to-javascript)

## Topics Covered / Goals
- Get your local machine set up to start the course
- Exploring your IDE (VSCode)
- Be able to navigate your computer using the command line
- Create and manage git repositories using the command line

## Lesson

### Computer Setup (Mac, Linux, & Windows)
Before we get started, just know that this will be chaos. Your goal is to get a working environment. Please follow along closely!
- [Slack](https://slack.com/downloads) - for all communication purposes
- [Zoom](https://zoom.us/support/download)
- Sign up for [Operation Code](https://operationcode.org/join)

### Mac Setup
- Make sure you have an Apple ID
- Download XCode from the Mac App Store
- Ensure that you're running the most recent operating system. You can check your version by going to "System Preferences" and clicking on "Software Update"
- [Complete Installfest (MacOS)](../../page-resources/installfest.md)

### Ubuntu Linux Setup
- [Complete Installfest (Ubuntu Linux)](../../page-resources/installfest_ubuntu.md)

### Windows Setup
- Ensure that you're running the most recent operating system (Windows 10 and 11 are both fine). You can update to the latest Windows version by selecting `Start > Settings > **Windows Update **> Check for updates.`
- Download and install [WSL](https://docs.microsoft.com/en-us/windows/wsl/install) by running `wsl --install` as an Administrator from Powershell
- [Complete Installfest (Windows)](../../page-resources/installfest_windows.md)

### CLI Intro

Review the following BASH commands:
- pwd
- ls, ls -a
- cd, ., .., ~, / (different places to cd to)
- mkdir (make ~/projects for all codeplatoon assignments)
- touch
- cp, cp -r
- mv
- rm, rm -r, rm -rf
- rmdir
- sudo
- clear, cmd+k
- less (useful by itself, also used by git diff)
  - `<spacebar>` moves down a page
  - `b` moves up a page
  - `q` quits
- vim (just learn how to quit. used by git commit)
  - press `<esc>` to enter "normal mode"
  - from normal mode, press `:` to enter "ex mode"
  - from ex mode, type `wq` to save and quit, or `q!` to quit without saving
 
# Intro to Javascript

### Git Intro

- `ls -a` (nothing here)
- `git status` (not a repo)
- `git init` 
- `ls -a` (see .git folder)
- `git status`
- `touch work.txt`
- `git add .`
- `git commit -m 'i did work'` (use -m to add the message inline, or you'll find yourself in vim)
- `git log` (uses `less` to show the commit history)
- `git remote add origin https://github.com/username/reponame` (the name is arbitrary, but origin is VERY conventional)
- `git remote rm origin` (in case you messed up)
- `git remote -v` (maybe you messed up, but aren't sure)
- `git push origin master`
- `git pull origin master`
- `git clone https://github.com/username/reponame` (now you can start today's exercises)

## Visual Studio Code

There are many IDEs (integrated development environments) out there that developers can use. For our class, we're going to be using Visual Studio Code, a free IDE created by Microsoft. By default, VSCode is a powerful, flexible editor that supports many different coding languages. However, VSCode is also highly extensible, with a rich ecosystem of plugins. Here are a few plugins that might make it easier for you to build applications with VSCode. 
- Beautify
- VSCode Icons
- Bracket Pair Colorizer
- Path IntelliSense
- Live Server
- Python
- Live Share
- Live Share Audio
  
 


## Assignments
- [99 Bottles](https://github.com/romeoplatoon/algo-99-bottles) in JS
- [Deaf Grandma](https://github.com/romeoplatoon/algo-deaf-grandma) in JS
- [Terminal Commands In Depth](https://github.com/romeoplatoon/misc-command-line) ...nothing to submit here but necessary reading
- [Incoming Student Survey](https://docs.google.com/forms/d/e/1FAIpQLSePRzeiSCe1hqzud7btr--Xxm791zqCe_RqA_9mGxEIUN_IwQ/viewform)


# Intro to Javascript

## Topics Covered / Goals
- Pair Programming
  - You will likely be pair programming at your first job in some capacity. It's an important skill to have because it helps you communicate your thought process and enables you to learn from other developers.
- Javascript is the language of the Web and you'll need to know it if you want to become a full stack software engineer.
- Javascript Libraries


## Lesson

**Javascript Fundamentals**
- Javascript was created by Brendan Eich during his time at Netscape in 1995 that conforms to the ECMAScript specification.
- JavaScript is one of the core technologies of the World Wide Web.
- JavaScript is high-level language. It has curly-bracket syntax, dynamic typing, prototype-based object-orientation, and first-class functions.
- With the creation of Node.js (by Google) you can leverage Javascript to write server side code

**Data Types**
  - **Strings**
    - Anything enclosed in single, double quotes, or back ticks
    ```js
      'stringOne'
      "string two is also a string with 123456789"
      `Use back ticks for string interpolation to put variables in your string ${someVariable}`
    ```
    - Interpolation is when you substitute a variable into a string.
    ```js
    let firstName = 'Tom';
    console.log(`My first name is ${firstName}`)
    ```

    - Reference [MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String) and [W3 Schools](https://www.w3schools.com/js/js_string_methods.asp) for a list of built-in String Methods
  - **Numbers**
    - Similar to most other languages, `integers` are whole numbers, `floats` are decimals
    ```js
    3.14 //-> Float number
    55 //-> Integer is a whole number
    ```
  - **Booleans**
    - Booleans are `true` or `false`
    ```js
    true
    false
    ```
  - **Undefined**
    - A variable that has no defined value.
    ```js
    let babyName = undefined;
    ```
  - **Null**
    - A variable explicity defined as having no value
    ```js
    let noValue = null
    ```
  - **Arrays**
    - Holds an ordered list of values. These values can be anything: strings, numbers, objects, even other arrays!
    - Once you put something in an array, it stays at that place forever until you alter the array. You can rely on it always being there. Think of an older person's pill box - the pills for Monday are in the Monday slot. If they were to shake it or drop it or something, it wouldn't matter. Those pills are still at the same place.
    - You can access the values in the array by using their `index`. We start counting from 0 and go up from there
    ```js
    const daysOfTheWeek = ['mon', 'tues', 'wed', 'thurs', 'fri']
    // Remember, computers start counting at 0 and move up from there
    daysOfTheWeek[3] // "thurs"
    ```
    - Reference [MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array) and [W3 Schools](https://www.w3schools.com/jsref/jsref_obj_array.asp) for a list of built-in Array Methods

  - **Objects**
    - It's a collection of key/value pairs. You can't access it by `index` like with arrays because objects do not have an order, but you can access it by `key`
    - Useful for holding many details about a single entity, like VIN numbers or social security information
     
    ```js
    // below, we have a object called user that has a name/age key on the left and values on the right
    let user = {
        'name': 'Tom',
        'age': 34
    }

    // To access a particular key's value:
    console.log(user['name'])

    // You can also re-assign a key's value
    user['age'] = 30
    ```

**Variables**
  - Variables are named labels/identifiers for storing values
  - Remember from math class variables “x” and “y”?
  - There are three ways to declare/create a variable in Javascript
  - `var`
    - The most common variable. It can be reassigned but only accessed within a function. Variables defined with `var` move to the top when the code is executed. (don’t use anymore)
  - `const`
    - Can not be reassigned and not accessible before they appear within the code.
  - `let`
    - The `let` variable can be reassigned but not re-declared.

  - `var`, `let`, and `const` are reserved keywords in Javascript. You can’t use them for anything other than declaring variables

**Printing**
- `console.log()`
- Takes whatever you give it and prints it to the terminal/console
```js
let a = 'Hello'
let b = 'World'
console.log(`${a} ${b}`) //-> 'Hello World'
```

**Arithmetic Operators**
- Arithmetic is pretty much the same in all languages. Below are all of the operators:

|Description|Operator|Examples|
|-----------|--------|--------|
|Addition| `+`| `1 + 1 //-> 2`|
|Subtraction|`-`| `3 - 2 //-> 1`|
|Multiplication|`*`| `3 - 2 //-> 1`|
|Exponent|`**`| `3 ** 2` (‘3 to the power of 2’)|
|Division|`/`| `10 / 2 //-> 5`|
|Modulus (returns the remainder)|`%`| `10 % 3 //-> 1`|

**Logic Operators**
|Description|Operator|Examples <br>`let a = 4;`<br> `let b = 2;`<br>`let c = 8`|
|-----------|--------|--------|
|Equal| `==` or `===`| `a == b //-> false`|
|Not equal|`!=` or `!==`| `a !== b //-> true`|
|Greater than|`>`| `a > b //-> true`|
|Less than|`<`| `a < b //-> false`|
|Greater than or equal|`>=`| `a >= b //-> true`|
|Less than or equal to|`<=`| `a <= b //-> false`|
|Logical AND|`&&`| `a > b && b < c //-> true` <br> `a > c && a > b //-> false`|
|Logical OR|`\|\|`| `a > b \|\| b < c //-> true` <br>`a > c \|\| a > b //-> true`|

**Functions**
- Javascript functions are resusable blocks of code that perform a specific set of instructions
- Functions output a value

```js
// To declare a new function use the function keyword followed by the name of the function.
// Pass in parameters (if needed)

// Regular functions
function name(parameter1, paramenter2) {
	let answer = parameter1 + paramenter2
	return answer
}

// OR

// ‘Fat arrow’ functions
const name = (num1, num2) => {
  let answer = num1 + num2
  return answer
}

// Example
let sayHello = (firstName) => {
  return `Hello! My name is ${firstName}`
}

sayHello('Tom')
// Here we have a function called `sayHello` that takes in a single parameter/argument called `firstName`. We passed in `Tom` as the argument, so `Tom` gets saved as `firstName` when we run through the code. We can then interpolate `firstName` into the string that gets printed out.

```

**Conditional Logic**
- When you want to control how a computer goes through your program, use control flow!
- Evaluates to either true or false (boolean values)
- Allows us to select different outcome depending on user input or the result of a computation

```js
// if statement
if (a === b) {
	// do something
}

// if else statement
if (a === b) {
	// do something
} else {
	// do something
}

// else if statement
if (a === b) {
	// do something
} else if (a > b) {
	// do something else
} else {
	// do something else
}
```
- **Example**
```js
let age = 18
if (age >= 21) {
    console.log('Welcome to the bar')
} else {
    console.log('Come back when you are older')
}

// Sometimes, you can drink if you are in another country if you're 18. Let's account for that.

let currentCountry = 'China'
if (age >= 21) {
    console.log('Welcome to the bar')
} else if  (age >= 18 && currentCountry === 'China') {
    console.log('You can drink in China starting at age 18!')
} else {
    console.log('Come back when you are older')
}
```

**Iteration (Loops)**
- Loops are very popular in coding. They are basically instructions for your computer to do things over and over again
- As long as the condition is true, the block of code will continue to execute.
- When the condition becomes false, the code after the end of the loop will be executed.
```js
let age = 12
while (age < 21) {
    console.log(`You are not old enough yet - you are only ${age} years old! Come back when you are older.`)
}
// beware of infinite loops! What is going on above?

// This would be better:
let age = 12
while (age < 21) {
    console.log(`You are not old enough yet - you are only ${age} years old! Come back when you are older.`)
    age += 1
}
```
- `for` loops are a bit different. It's a way for you to iterate over everything in an array or object

```js
let age = 12
for (let i = 0; i < 21; i++) {
  console.log(`You are not old enough yet - you are only ${age} years old! Come back when you are older.`)
}
return `You're now ${age}! You can come on in!`

// Looping through an object
let employee = {
  name: 'Tom',
  title: 'Instructor'
}
for (let key in employee) {
	// execute this code
}
return someValue
```

### Libraries
Libraries used to leverage pre-written code (developed by other developers) to include functionality into our applications without having to do everything from scratch. Javascript libraries/frameworks are primarily focused on the front end. One of the most popular libraries used today is React. Instagram and Facebook are written in this framework.

One library manager is `npm`. We can use npm to easily download and "install" JavaScript libraries to use with our apps. 


- Some of you may be wondering what `exports` is on the Javascript files. The Javascript folders will sometimes have prewritten spec (test) files and in order for the spec file to read the contents of the corresponding Javascript files where your code is written, it must be attached to the `export` Javascript object. To ensure that you are writing correct code, run `node WHATEVER_CHALLENGE_NAME_Spec.js` in the `js` folder. Don't run `node WHATEVER_CHALLENGE_NAME.js` as it will blow up.

## Assignments
- [Roman Numerals](https://github.com/romeoplatoon/algo-roman-numerals) in JS
- [Git Practice](http://learngitbranching.js.org/)
- [Factorial](https://github.com/romeoplatoon/algo-factorial) in JS
- [Fibonacci](https://github.com/romeoplatoon/algo-fibonacci) in JS
- [Linear Search](https://github.com/romeoplatoon/algo-linear-search) in JS



# Intro to Python

​
## Topics Covered / Goals
- Understand basic Python syntax
- Understand variable types
- Understand basic data types
- Understand data structures:
  - lists
  - tuples
  - dictionaries
- Understand control flow in Python:
  - if-statements
  - for-loops
  - while-loops
- Understand some common built-in methods
    - built-in methods for strings, lists, dicts, etc
    - destructive vs non-destructive methods

## Lesson

> In python, like all programming languages, we will manipulate various different types of data, such as numbers and lists. If you want to understand how you can manipulate your data, and compare it to other data, the most important thing to understand is the TYPE of your data. Many of these data types are similar to the data types we use in javascript, but there are some important differences I'll point out. There are two types of types: primitive types, which are just a single value, and non-primitive types, which can contain other data.

### Numbers

> The first type we'll learn about are numbers. Let's create a number literal and assign it to a variable.

```python
a_small_number = 4
```

> In python, unlike javascript, you don't use any keywords (e.g. `let`, `const`) for defining a variable. You simply assign a value to a variable name. When choosing a name, it's conventional in python to use 'snake_case', which consists of lowercase letters connected with underscores.
> To check the type of a variable, we can use the `type()` function. We can print the result to the terminal with `print()`. We'll learn more about functions later today.

```python
print(type(a_small_number))
```

> You can manipulate numbers in python using numeric operators, such as +, -, *, /, %, <, >, ==, etc. These work the same way they do in javascript, so we won't review them again. Python does not perform type coercion like javascript, so there are no operators like === or !==.

### Strings

> Strings can be created in python similarly to how you create them in javascript, using either single or double quotes.

```python
a_string = 'hello world'
another_string = "welcome to the internet"
print(type(another_string))
```

> Python supports string interpolation, just like javascript, but the syntax is a little different

```python
day = 'Friday'
activity = 'bowling'
print(f"Let's go {activity} on {day} afternoon.") # This is sometimes called an "f string"
```

### Booleans

> The last primitive type in python is boolean. There are only two boolean values, `True` and `False`. These work the same as in javascript, except that we spell them with capital letters. 

### Lists

> The most fundamental non-primitive type in python is a list. A python list is roughly equivalent to a javascript array, but lists in python are a bit more flexible. 

```python
berries = ['grape', 'tomato', 'cucumber', 'eggplant', 'banana', 'watermelon', 'pumpkin']
print(type(berries))
print(berries[1]) # normal indexing works how you'd expect
print(berries[-1]) # index from the back of the list
print(berries[2:4]) # slice in the middle
print(berries[:3]) # slice from the start to index 3
print(berries[2:]) # slice from index 2 to the end
```

### Tuples

> A tuple in python is like a list, but it is defined with parentheses instead of brackets. It is used for storing mulTiPLE pieces of data in one data structure. Unlike a list, a tuple is immutable, meaning that it cannot be mutated. You cannot add, remove, or modify items in a tuple. You should use a tuple if you want to make sure that the items in your list never change. For example, you might use a tuple to store the seven days of the week, because there's no reason for that to change. You might also store geographical (lat,long) coordinates in a tuple, because the two numbers together refer to one thing, one specific place. It doesn't make sense to modify just one number in a coordinate pair. Instead, you would just create a new coordinate pair. 

```python
days_of_the_week = ('sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday')
days_of_the_week[6] = 'Caturday' # this throws an error! we can't assign to a tuple
```

### Dictionaries

> A dictionary in python is like an object in javascript (though python objects are more complex than javascript objects). It's used to store pairs of data, a key with its value. For example, you might use a dictionary to store information about a person. Unlike in javascript, we must use quotation marks for defining string keys, and we must use bracket notation for accessing values in a dictionary. 

```python
jeff = {
    'name': 'jeff',
    'age': 44,
    'job': 'influencer',
}
print(jeff['age'])

people = [
    {
        'name': 'alice',
        'age': 44,
        'job': 'influencer',
    },
    {
        'name': 'bob',
        'age': 31,
        'job': 'dog walker',
    },
    {
        'name': 'carol',
        'age': 65,
        'job': 'life coach',
    },
]
print(people[1]['name'])
```

### functions

> To define a function in python, we use the `def` keyword. The body of the function must be indented because python is whitespace-sensitive. Instead of using braces and semicolons to mark the boundaries of our code, python uses indentation and newlines. It's important that you get comfortable defining your own functions to use in your code, but you should also be aware that there are many useful functions predefined in python.

```python
def gimme_five():
    return 5
print(gimme_five() + 10)


# if a function is defined with one parameter, it must be called with one argument
def add_one(n):
    return n + 1
print(add_one(10))

# order matters for positional arguments
def describe_berries(n, color):
    print(f'I have {n} {color}berries.')
describe_berries(3, 'blue')
describe_berries('black', 4)

# keyword arguments can be used in any order
def describe_berries(n=1, color="blue"):
    print(f'I have {n} {color}berries.')
describe_berries(color="rasp", n=3)

# use * to define a function with an unspecified number of parameters
def print_them_all(*args):
    print(args)
print_them_all('alice', 'bob', 'carol')

# use ** to define a function with an unspecified number of keyword arguments
def who_am_i(**kwargs):
    for kwarg in kwargs: # we'll talk more about loops in a minute
        print(f'My {kwarg} is {kwargs[kwarg]}.')
who_am_i(name='dan', age=20, job='skydiving instructor')
```


### If-statements
> If-statements in python work the same as in javascript, except that instead of `&&`, `||`, and `!`, we use `and`, `or`, and `not`.

```python
def can_drink_beer(age, country):
    if age >= 21 or age >= 18 and country == 'Canada':
        return True
    elif country == 'Antarctica':
        return True
    else:
        return False

print(can_drink_beer(20, 'USA'))
print(can_drink_beer(21, 'USA'))
print(can_drink_beer(18, 'Canada'))


```

**for-loop**
```python
## looping over list elements
my_list = ["a", "b", "c"]
for x in my_list:
    print(x)

## loop over a range
for x in range(10):
    print(x)


for i, x in enumerate(my_list):
    print(i, x)

## looping over dictionary entries
my_dict = {
    "donuts": "yummy!",
    "green beans": "icky!",
}
for k in my_dict:
    print(my_dict[k])

for v in my_dict.values():
    print(v) # same output as the previous loop
```

**while-loop**
```python
x = 9
while x > 0:
    print(x)
    x = x - 1

## infinite loop
x = 9
while x > 0:
    print("la la la") 
```


**Built-in Methods**
> Most types of values in python have built-in methods that you can use to manipulate that value. a method is simply a function that belongs to an object. There are two types of methods that you should be aware of: destructive and non-destructive methods. Destructive methods are those that change the original data where non-destructive methods are those that do not change the original data. You have to be careful with the methods that you use as there isn't a clear indication in Python or JS as to which are destructive and which aren't. Let's take a look at the example below:
```python
first_name = 'jonathan'
first_name.capitalize() # this is a string method that converts the first character to upper case
first_name # we see that despite running the method above, my original data does not change

last_name = 'young'
last_name.replace('g', '123')
last_name # same case here - this is a non destructive method

staff = ['jon', 'rod', 'ankur', 'chad', 'alicia']
staff.append('tom')
staff # this is a destructive method because it alters the original
## Let's fire tom. He sucks.
staff.pop()
staff # my original has been changed yet again!
```

​
## Assignments
- [99 Bottles](https://github.com/romeoplatoon/algo-99-Bottles) in Python
- [Deaf Grandma](https://github.com/romeoplatoon/algo-deaf-grandma) in Python
- [Roman Numerals](https://github.com/romeoplatoon/algo-roman-numerals) in Python
- [Fibonacci](https://github.com/romeoplatoon/algo-fibonacci) in Python
- [Factorial](https://github.com/romeoplatoon/algo-factorial) in Python
- [Linear Search](https://github.com/romeoplatoon/algo-linear-search) in Python



# Python List Methods and Modules

## Topics Covered / Goals
- Understand lambda functions
- Understand list methods map(), filter(), sort(), reduce()
- Understand Try-Except error handling

## Lesson

### Lambda functions
- temporary, unnamed ("anonymous") functions
```python
## typical function example
def add_one(x):
    return x + 1

print(add_one(7)) # output would be 8

## lambda function example
add_two = lambda x : x + 2

print(add_two(7)) # output would be 9
```

### List Methods
**map()**
- creates a new list, using a function that returns a new item
```python
my_list = [1,2,3,4,5,6,7,8,9,10]
new_list = map(lambda item : item + 2, my_list)
for x in new_list:
    print(x)
## [3,4,5,6,7,8,9,10,11,12]
```

**filter()**
- creates a new list, using a function that returns a bool (True => include item in new list)
```python
my_list = [1,2,3,4,5,6,7,8,9,10]
new_list = filter(lambda item : item % 3 == 0, my_list)
for x in new_list:
    print(x)
## [3,6,9]
```

**reduce()**
- creates a single value, using a function that aggregates values
```python
import functools
my_list = [1,2,3,4,5,6,7,8,9,10]
sum = functools.reduce(lambda agg, item : agg + item, my_list)
print(sum)
```

**sort()**
```python
from functools import cmp_to_key

people = [
    {
        'name': 'alice',
        'age': 44,
        'job': 'influencer',
    },
    {
        'name': 'bob',
        'age': 49,
        'job': 'dog walker',
    },
    {
        'name': 'carol',
        'age': 35,
        'job': 'life coach',
    },
]

# our sort function will look at list elements 2 at a time
# return any positive number to indicate that a gets sorted before b
# return any negative number to indicate that b gets sorted before a
# return 0 to indicate that you don't care which is first
def sort_by_age(a,b):
    # if a['age'] - b['age'] > 0:
    #     return 1
    # elif a['age'] - b['age'] < 0:
    #     return -1
    # elif a['age'] == b['age']:
    #     return 0
    return a['age'] - b['age']

# key is a 1-argument function that describes how to sort the list.
# in python2, you used cmp, which was a 2-argument function that describes how to sort the list
sorted_people = sorted(people, key=cmp_to_key(sort_by_age))
```

### Try-Except
> When building an application, your code doesn't always run the way you expect it to, and sometimes it throws an error! We can use try/except to write code that we think might throw an error, and then prepare an alternate plan in case the code fails. 
```python
try:
    a = 1
    b = 2
    c = "donuts"
    
    d = a + b
    print(d)

    e = a + c # error
    print(e)
except:
    # handle exception
    print("BOO! there was an error")
else:
    # handle success
    print("YAY! there was no error")
finally:
    # always execute regardless of exception or success
    print("donuts are yummy!")
```

## Modules, Packages, Libraries, and Frameworks

- Modules, libraries, frameworks, and packages are just code that someone else wrote ahead of time to make your life as a developer easier. There is no magic here - it's just meant to make your life easier and for you to make more robust applications
- There are a number of package managers to manage the different libraries we will use. The most popular package manager for Python is Pip, and the most popular (and default) package manager for Javascript is npm. 
- You can find some very useful libraries [here](https://pythontips.com/2013/07/30/20-python-libraries-you-cant-live-without/). We'll be using Django in the next few weeks. If you go the data science route, there are some data science heavy libraries like NumPy and Pandas

You can also write your own modules, which allows for you as the author to organize your code and group it together for ease of use. To put it very simply, a module is a file of Python code that you bring into other files. Let's take a look at an example:

### Python modules

```python
## file1.py
def say_hello():
    print('Hey there')

## file2.py
import file1
import file1 as anything
anything.say_hello()
```
We just created two files: `file1.py` and `file2.py`. `file1.py` has a `say_hello` function. `file2.py` has nothing in it, but imports that file in as the name of the file and we can use all the methods in that file. We can also rewrite it as `import file1 as anything` and call `anything.say_hello()`. You can `import` anything into your file by providing the correct relative path to the file. More on that can be found under external resources.

## Resources
- [Python vs. JavaScript](https://realpython.com/python-vs-javascript/#javascript-vs-python)
- [Python Modules](https://www.tutorialspoint.com/python/python_modules.htm)
- [Python/JS import syntax comparison](https://www.saltycrane.com/blog/2015/12/modules-and-import-es6-python-developers/)

## Assignments

- [Armstrong Numbers](https://github.com/romeoplatoon/algo-armstrong-numbers) in JS/Python
- [Sum Pairs](https://github.com/romeoplatoon/algo-sum-pairs) in JS/Python
- [Credit Check](https://github.com/romeoplatoon/algo-credit-check) in JS/Python
- [Anagrams I](https://github.com/romeoplatoon/algo-anagrams-i) in JS/Python
- [Debug Deaf Grandma](https://github.com/romeoplatoon/debug-deaf-grandma) in JS



# Python OOP

## Topics Covered / Goals
- **Intro to Object Oriented Programming**
	- Object Oriented Programming (OOP) is a commonly used design paradigm. Python is an object oriented language, and so OOP is an essential piece of understanding Python.
- **Classes**
	- Classes are structures in code that allow for developers to create more elaborate data types that can better reflect real-world objects
- **Instantiating objects with __init__ and self**
	- Every class in Python should have an __init__ method, which tells python how to construct instances of that class. The instance to be created is referred to as `self`. 
- **Instance methods and self**
	- Classes can define methods to be called by instances of that class, which can refer to themselves using the `self` keyword. 
- **Dunder Methods**
	- These are special methods that are built-in to use within classes, in Python. 


## Lesson
**Object Oriented Programming in Python**
- Python is an object-oriented programming language where everything is an object (i.e., booleans, strings, hashes, arrays, integers, everything)
- Objects are data structures that have *attributes* and *methods*. Think of objects as nouns. Most nouns have attributes (adjectives) and methods that it can do (verbs)
	- For example, imagine you have a dog. Every dog has attributes such as breed or color. Every dog also has methods that it can do such as: speack, fetch, or roll over
- Objects are organized by `class`-es. Classes are used to combine how data is represented and methods to manipulate that data

- Features of OOP:
	- Encapsulation = Data access can be restricted based on needs (covered today)
	- Abstraction = Logic/Complexity is hidden, for simplicity (covered today)
	- Inheritance = Sharing of similar features and attributes (covered Thursday)
	- Polymorphism = Objects can take different forms depending on needs/situation (covered Thursday)

### Classes Introduction
Creating a class in Python is as simple as the adding the following code:
```python
class Dog: # this is our class definition
	pass

fido = Dog() # this is how we create an instance of our Dog class
```

A class can be viewed as a concept, or blueprint, for some idea. When we turn that concept into reality, we create instances (or objects) of the class. It is important to understand this distinction, and become familiar with the terminology being used: A class definition -vs- an instance of a class. 

### __init__() method
The first thing we'll talk about is how to initialize a class with some data. Let's add on to our Dog class:

```python
class Dog:

	def __init__(self, name): # this method will be used to intialize our Dog instance
		self.name = name

fido = Dog("Fido")
print(fido.name)
```

You can add an ```__init__()``` method to your class to allow data to be passed in upon creation of your instance. In our Dog example, we are passing in a ```name``` value and storing it in the instance. We can access the data we've stored in the instance by calling *[instance].[attribute]*, or for our example: ```fido.name```

The ```__init__()``` method also allows us to initialize anything else we may need to for our instance. Keep in mind that Python automatically calls our ```__init__()``` method when we create our instance. You should never be calling the ```__init__()``` method yourself! Also, you MUST name your initialization method "\_\_init\_\_" (two leading underscores, "init", and two trailing underscores) because Python is looking for this method when our object is being initialized. 

What's up with that `self` parameter though? That's a good question... we'll cover that in a moment. 

### Instance Attributes
In nthe example above, `self.name` is what we call an instance attribute (or instance variable). This is data is belongs to the instance of Dog that is created, and is unique to each instance. In other words, every Dog instance that we create will get it's own name. Let's add a few more instance attributes to our Dog class:

```python
class Dog:

	def __init__(self, name, breed, sound):
		self.name = name
		self.breed = breed
		self.color = color
		self.sound = sound
        
        
fido = Dog("Fido", "Pointer", "white", "woof!")
```

### Instance Methods
Our Dog class isn't too intersting right now. It currently just stores data for us, allowing us to bundle attributes together in a single object, which is great... but let's make our Dog class a little more exciting by adding in some instance methods.

Keep in mind our terminology for classes:
- **attributes** are variables specific to a instance
- **methods** are functions that act upon the instance attributes

```python
class Dog:

    def __init__(self, name, breed, color, sound):
        self.name = name
        self.breed = breed
        self.color = color
        self.sound = sound

    def speak(self): # example of an *instance method*
        print(f">> {self.sound}")
        
    def fetch(self, item):
        print(f">> {self.name} fetched the {item}")

fido = Dog("Fido", "Pointer", "white", "woof!")
fido.speak()
fido.fetch("ball")
```

Some important things to observe about the instance methods we added in the code above:
1. Notice that every instance method (including ```__init__()```) takes in a parameter named "self". This parameter is a reference to the instance calling the instance method. Note that we can name this parameter anything that we want to, but by naming standards, always name it "self". 
2, Notice that we do not (and should not) pass in anything for the value of "self" when we call our instance methods (e.g. ```fido.speak()```). Python automatically will pass a reference to the instance for us, and that is why we must provide a "self" parameter to all instance methods
3. Notice that we are able to make use of instance attributes (and even other instance methods) via the ```self``` object. 

### Other Dunder methods

Python classes come with a bunch of built-in methods that we can leverage for our needs. These methods are called "dunder methods". The reason they are called dunder methods, is because of the naming syntax that we use, which consists of leading and trailing **d**ouble **under**scores. We already introduced the ```__init__()``` method earlier, which is one (and most often used) dunder method. We won't be covering every dunder method that exists (because there are many!), but you can read up on more of them here: [here](https://www.python-course.eu/python3_magic_methods.php)

What happens if we choose to print out our instance to the terminal?

```python
fido = Dog("Fido", "Pointer", "woof!")
print(fido)
```

The output of this shows the type of our object and the memory location where it's being stored on our computer. That's great, but this output isn't really telling us much about our instance. To control what is outputted, we can make use of the ```__str__()``` dunder method:

```python
class Dog:
    def __init__(self, name, breed, color, sound):
        self.name = name
        self.breed = breed
        self.color = color
        self.sound = sound

    def __str__(self):
        return f"I am a {self.color} {self.breed} dog named {self.name} and I say {self.sound}!"

    def speak(self):
        print(f">> {self.sound}")
        
    def fetch(self, item):
        print(f">> {self.name} fetched the {item}")

fido = Dog("Fido", "Pointer", "white", "woof!")
print(fido) # this is a much more descriptive output! This text comes from the __str__() instance method

lassie = Dog("Lassie", "Collie", "golden", "ruff!")
print(lassie)
```

Dunder methods are not generally meant to be called directly by our code. Python automatically will call the appropriate dunder methods for us, depending on the operation being performed.


## Assignments
- [App Users I](https://github.com/romeoplatoon/oop-app-users-i) in Python
- [Guessing Game](https://github.com/romeoplatoon/oop-guessing-game) in Python
- [CSV Reader](https://github.com/romeoplatoon/csv-reader)



# Decorators, Static Methods vs Instance Methods, Getters and Setters

## Topics Covered / Goals
- **Intermediate Object Oriented Programming**
	- Much of the value of OOP comes from calling instance methods on an object, which can refer to that object's specific data using `self` or `this`. However, there are other aspects of OOP that can be useful as well, such as, class methods, getters and setters. 
- **Decorators in Python**
	- Decorators are functions in Python that are used to modify how another function behaves. They aren't inherently related to OOP, but we'll start seeing them as we dive deeper into Python, so now is a good time to learn about them. 
- **Instance Attributes -vs- Class Attributes**
	- Understanding the different types of variables to use with Classes is important for encapsulating your data, so that data is available only where it needs to be.
- **Instance Methods -vs- Class Methods -vs- Static Methods**
	- Understanding the different types of methods to use with Classes is important for encapsulating your data, so that data is available only where it needs to be.
- **Getters and Setters**
	- Provide encapsulation for data in instances of our class, by separating the interface to our data from its internal representation.


## Lesson


### Decorators
> Python decorators are functions that allow us to modify the behavior of another function when that function is defined. It's not essential that you use decorators in your own code, but many python libraries and frameworks use decorators, so it's good to understand how they work.

Like many programming languages, Python has first-class functions. This means that functions in Python can accept other functions as inputs, and return functions as output. Before we talk specifically about decorators, let's see a brief example of a function that returns other functions. We will create a function `WidgetMakerMaker` which does NOT create widgets. It creates other functions that DO create widgets. 

```python
# this function does not make widgets. it makes functions that create widgets
def WidgetMakerMaker(widget_color):

		# this function actually makes widgets
	def WidgetMaker():
		return {
			'type': 'widget',
			'color': widget_color,
		}
		
		# return the function we just created, so it can be used outside of WidgetMakerMaker
		return WidgetMaker

RedWidgetMaker = WidgetMakerMaker('red')
red_widget = RedWidgetMaker()
another_red_widget = RedWidgetMaker()

BlueWidgetMaker = WidgetMakerMaker('blue')
blue_widget = BlueWidgetMaker()
another_blue_widget = BlueWidgetMaker()
```

A function that defines other functions can be useful if you have some logic that is repeated in many functions, but you don't want to write redundant code. For example, let's say we're trying to improve the performance of a slow application, so we want to print the time when every function is called to better understand what's taking so long. We can use one function to `decorate` another, which extends its functionality.

```python
from datetime import datetime

def AddOne(num):
	return num + 1

def MultiplyByTwo(num):
	return num * 2

# This function accepts a function as input, then returns a new function that behaves similarly to the one that is passed in
def PrintCurrentTimeAndAlso(func):

	# this function accepts any number of positional arguments (*args) and any number of named arguments (**kwargs)
	def WrapperFunction(*args, **kwargs):
		print(f'Calling {func.__name__} at {datetime.now()}')
		return func(*args, **kwargs)

	return WrapperFunction

# This creates a new, decorated function
PrintCurrentTimeAndAlsoAddOne = PrintCurrentTimeAndAlso(AddOne)
one_plus_one = PrintCurrentTimeAndAlsoAddOne(1)


# This creates a new, decorated function
PrintCurrentTimeAndAlsoMultiplyByTwo = PrintCurrentTimeAndAlso(MultiplyByTwo)
two_times_two = PrintCurrentTimeAndAlsoMultiplyByTwo(2)

# Using the decorator syntax (@) allows us to create a decorated function all at once,
# instead of creating an undecorated function, and then passing it into the decorator
@PrintCurrentTimeAndAlso
def SubtractThree(num):
	return num - 3

nine_minus_three = SubtractThree(9)
```


### Instance Attributes -vs- Class Attributes
- Instance attributes are variables that are unique to each instance of a class that is created (e.g. name)
- Class attributes are variables that are shared between EVERY instance of a class that are created (e.g. dog species)

Let's add some class attributes to our previous Dog class example: 

```python
class Dog:
	species = "Canis Lupus Familiaris" # all dogs have the same species type => *class attribute*
	legs = 4

	def __init__(self, name, breed, color, sound):
		self.name = name # each dog has a unique name => *instance attribute*
		self.breed = breed
		self.color = color
		self.sound = sound

fido = Dog("Fido", "Pointer", "white", "woof!")
print(fido.name)
print(fido.species)

lassie = Dog("Scooby", "Mutt", "Scooby-Dooby-Doo!")
print(lassie.name)
print(lassie.species)
```

### Instance Methods -vs- Class Methods -vs- Static Methods
> Just like attributes can belong to either an instance of a class or the class itself, methods can belong to either an instance (`instance methods`) or the class itself (`static methods`). In python, we also have access to `class methods`, which are very similar to `static methods`.

> In this example, we'll create a class for making Pizzas. Since all of our pizzas are circles, it would be useful if our class knew how to calculate the area of a circle. This knowledge is not specific to any one pizza, but is generic functionality that belongs to the class. 

```python
import math

class Pizza:
    def __init__(self, radius, ingredients):
        self.radius = radius
        self.ingredients = ingredients

    def area(self):
        return self.circle_area(self.radius)

    @staticmethod
    def circle_area(r):
        return r ** 2 * math.pi
```

> Sometimes, it's useful to have access to the class itself in a static method. We can achieve this using class methods, which are mostly the same as static methods, except that they get the class passed in as an argument. This can be useful if you want to create methods that instantiate objects in specific ways. For example, let's say we noticed that when we create new pizzas, we tend to call the constructor with the same sets of arguments, because people like to order familiar pizzas. We can create class methods to construct specific types of pizzas.

```python
class Pizza:
    def __init__(self, ingredients):
        self.ingredients = ingredients

    @classmethod
    def margherita(cls):
        return cls(['mozzarella', 'tomatoes'])

    @classmethod
    def prosciutto(cls):
        return cls(['mozzarella', 'tomatoes', 'ham'])
```

### Getters and Setters
> Often, you might need to modify an instance variable from outside of the class. In simple cases, you can just assign to an object's properties to update them, e.g. `alice.age = 32`. As your application becomes more complex, you might need to add extra rules about how these properties can be updated. If our class is well designed according to OOP principles such as encapsulation and abstraction, these rules should be described in the class itself. Other code outside of the class shouldn't need to be aware of them. We can achieve this using getters and setters in python, using the `@property` decorator.

```python
class Person:
	def __init__(self):
		self._age = 0
		self.dead = False
       
     # using property decorator
     # a getter function
	@property
	def age(self):
		print("getter method called")
		return self._age
       
     # a setter function
     @age.setter
     def age(self, a):
		self._age = a
		if(a > 100):
			self.dead = True
  
alice = Person()
  
alice.age = 19
print(alice.age)
```

> A great thing about using setters and getters like this is that we don't even have to plan for this up front. We can design our application in a simple way, and directly assign to instance variables, like `alice.age = 32`. Later on, if we decide that we need extra logic when the age changes, like a Person dying when they reach age 100, we can achieve that only by changing the class definition, by replacing `self.age` with `self._age`, and using setter/getter decorators on `def age()`. The rest of our application does not need to know about the internal details of the person class. 

## External Resources

## Assignments
- [App Users II](https://github.com/romeoplatoon/oop-app-users-ii) in Python
- [Contact List](https://github.com/romeoplatoon/oop-contact-list) in Python
- [Caesar Cipher](https://github.com/romeoplatoon/algo-caesar-cipher) in JS/Python



# Python OOP Inheritance

## Topics Covered / Goals
- Understand when and why to use inheritance in your code
- Understand the relationship between child classes and parent classes
- Inherit classes successfully
- Understand the use of `super` in OOP and when to use it
- Understand different types of multiple inheritance:
    - one parent with multiple children
    - one child with multiple parents

## Lesson

### Inheritance in Python
> Inheritance is a relationship between two classes, a parent class and a child class (or a superclass and a subclass). Specifically, inheritance helps us model relationships where one class is a subtype of another class. For example, 'a dog is an animal. All dogs are animals, but not all animals are dogs.'


```python
class Dog:
    def __init__(self, name):
        self.name = name

    def eat(self, food):
        print(f"{self.name} eats a {food}.")
    
    def bark(self):
        print("BARK BARK!")

spot = Dog('Spot')
spot.eat()
```

> In the example above, we say that every dog has an attribute called `name`. Every dog also has the ability to `eat` and `bark`.

```python
class Cat:
    def __init__(self, name):
        self.name = name

    def eat(self, food):
        print(f"{self.name} eats a {food}.")
    
    def meow(self):
        print("meow meow!")

garfield = Cat('Spot')
garfield.eat()
```
> In the example above, we say that every cat has an attribute called `name`. Every cat also has the ability to `eat` and `meow`. This `Cat` class is pretty similar to our previous `Dog`. This isn't just a coincidence, like how a table and a horse both have four legs. Cats and dogs are both able to eat because they are both types of animals. Using inheritance, we can rewrite the above classes to avoid repeating code.

```python
class Animal:
    def __init__(self,name):
        self.name = name
    def eat(self, food):
        print(f"{self.name} eats a {food}.")
    def speak(self):
        print("I'm an animal!")

class Dog(Animal):
    def speak(self):
        print("BARK BARK!")


class Cat(Animal):
    def speak(self):
        print("meow meow!")

lucky = Cat('lucky')
# the name attribute and eat method aren't defined on the Cat class, but this works because Cat inherits them from Animal
lucky.eat('chicken nugget') 

```
> Notice how we passed the `Animal` class to the `Cat` and `Dog` classes. This indicates that `Animal` is a parent class of both `Cat` and `Dog`. As such, `Cat` and `Dog` have access to all of the methods from animal, even `__init__`. This might seem a little unintuitive because the child class is always 'bigger' than the parent. The child class has access to everything in the parent class(`__init__`, `eat`), and then also has its own method `speak`, which overrides `speak` from the parent class.

> Sometimes, we'll want to define a child class that doesn't use the exact same methods as its parent, but we don't want to override it entirely, like we just did with `speak`. We can use the `super()` method to access an instance of the parent class, call any of its methods from the child class, and then add more custom logic afterwards. This is commonly used to repeat the `__init__` method from the parent class, and then add an extra property at the end. For example, a difference between dogs and cats is that a dog can be a registered service animal, whereas a cat cannot.

```python
class Animal:
    def __init__(self,name):
        self.name = name
    def eat(self, food):
        print(f"{self.name} eats a {food}.")
    def speak(self):
        print("I'm an animal!")

class Dog(Animal):
    def __init__(self, name, is_service_animal):
        # use the logic from the parent Animal class without duplicating code
        parent_instance = super()
        parent_instance.__init__(name)

        # add some Dog-specific setup
        self.is_service_animal = is_service_animal

    def speak(self):
        print("BARK BARK!")


class Cat(Animal):
    def speak(self):
        print("meow meow!")

sparky = Dog('sparky', True)
```
> The example above demontrates a common use for inheritance, where you have multiple child classes that share code from a common parent class. Inheritance can also work the other way, where one child class inherits from multiple parent classes. 

```python
import math

class Person:
    def __init__(self, name, job):
        self.name = name
        self.job = job
    def work(self):
        print(f"{self.name} is working hard as a {self.job}.")
    
class Computer:
    def __init__(self, number_of_cores):
        self.number_of_cores = number_of_cores

    def compute(self):
        print(round(math.pi, self.number_of_cores))

toaster = Computer(1)
toaster.compute()

compy386 = Computer(4)
compy386.compute()

class Cyborg(Person, Computer):
    def __init__(self, name, job, number_of_cores):
        Person.__init__(self, name, job)
        Computer.__init__(self, number_of_cores)

    def work(self):
        for n in range(self.number_of_cores):
            Person.work(self)

terminator = Cyborg('Arnold', 'terminator', 8)
terminator.work()
```


**When to use inheritance**
> Use inheritance to write less code. If you are writing an object oriented program with many classes, check if there are many similarities between your classes that have caused you to write redundant code. If you have two classes that are related (e.g. Animal, Dog), but they don't actually share any redundant code, you don't need inheritance. Verify that those similarities are due to inherent is-a relationships that are unlikely to change.
> For example, a table and a dog both have four legs, but this is not due to an inherent relationship, and as your program becomes more complex, there will be more differences between tables and dogs, and it will make less sense for them to inherit from a common ancestor (4-legged). If you have multiple classes that share code with each other, where one is inherently a type of the other, or both of them are inherently types of a third thing, consider using inheritance in your program so that you can write less code. 

## External Resources
- [Python super() method](https://realpython.com/python-super/)
- [Method Resolution Order(MRO)](https://www.educative.io/edpresso/what-is-mro-in-python)

## Assignments
- [App Users III](https://github.com/romeoplatoon/oop-app-users-iii) in Python
- [School Interface I](https://github.com/romeoplatoon/oop-school-interface-i)
- [Boggle I](https://github.com/romeoplatoon/oop-boggle-i)
- Stretch challenge: [Boggle II](https://github.com/romeoplatoon/oop-boggle-ii)



# Javascript OOP

## Topics Covered / Goals
- Few programmers truly embrace prototype-based programming, and neither will we. We will use JS prototypes to recreate OOP.
- The `this` keyword in javascript
    - the global object (`window` in the browser vs `global` in node)
    - Using the `function` keyword vs arrow functions
- Object Oriented Programming in Javascript
    - The `new` keyword and constructor functions
    - Adding instance methods to the prototpye
    - The `class`keyword (syntactic sugar)


## Lesson

### Prototypes vs Classes
> In javascript, we don't actually have proper OOP classes like in most programming languages. Instead of classes, javascript has PROTOTYPES, which can be used to define the shared behavior of a group of objects, similarly to classes. Prototypes in javascript have some unique benefits when compared with classes in other languages, but we will not be exploring the ways that prototypes are better than or different from classes. Instead, we will learn how to recreate OOP in javascript using the tools that are available to use. 

### The `this` keyword
> Before learning about OOP or prototypes in javascript, first we need to understand how the `this` keyword works in javascript. It's mostly the same as using `self` in python, but `this` in javascript actually has uses outside of OOP, so let's see that first. In general, when you see `this` inside of a `function(){}`, `this` refers to the object that the function is attached to. Note that fat-arrow functions `()=>{}` do not rebind the value of `this`. Only regular functions defined with the `function` keyword will affect the value of `this`. This is the primary difference between traditional functions and fat-arrow functions. 

```javascript
// `this` is not attached to any object, so it refers to the window in browser js, or {} in node. either way, it's not what you want
console.log(this)

// This is the simplest way to use `this`. `this` appears in the function `sayHello`, which is attached to the `alice` object, so the value of `this.name` in this case would be alice.name === 'alice'
const alice = {
    name: 'alice',
    sayHello: function(){
        console.log(`Hello, my name is ${this.name}`)
    }
}

alice.sayHello()

// arrow functions do not rebind `this`.
// `this` in this function still refers to the window. not very useful. 
const bob = {
    name: 'bob',
    sayHello: ()=>{
        console.log(`My name is ${this.name}`)
    }
}

bob.sayHello()

// `this` appears in a setTimeout callback, which is not attached to any object,
// so `this` will refer to the window. 
// It doesn't matter that `sayHello` is attached to the carol object, 
// because the actual function that contains `this` is not attached to any object
const carol = {
    name: 'carol',
    sayHello: function(){
        setTimeout(function(){
            console.log(`My name is ${this.name}`)
        })
    }
}

carol.sayHello()

// `this` appears in a ()=>{} function, which doesn't affect `this`.
// We'll have to look for the closest function(){} that contains `this`, which is `sayHello`
// `sayHello` is attached to the dan object, so `this.name` refers to dan.name. 
const dan = {
    name: 'dan',
    sayHello: function(){
        setTimeout(()=>{
            console.log(`My name is ${this.name}`)
       }, 100)
    }
}

dan.sayHello()

// the value of `this` depends on how the function is CALLED, not how it is DEFINED
const sayHello = function(){
    console.log(this.name)
}

// this.name is undefined or empty string, depending on the environment
sayHello()

const eve = {
    name: 'eve',
    sayHello: sayHello,
}

// in this case, `this` refers to the eve object, so `this.name` is 'eve', 
eve.sayHello()
```

### The `new` keyword
> In javascript, we don't use a `class` keyword for creating classes. Instead, we just use normal functions. However, if we want to use a function as a constructor for an OOP class, we call it differently, by adding the `new` keyword. This slightly changes how the function executes. 

```javascript
// we're pretending this is a class, so we named it with a capital letter
const Person = function(name){
    // const this = {}
    this.name = name

    // return this
}

const alice = new Person('Alice')
```

> When we use the `new` keyword, `this` inside the function refers to a new object, which is automatically returned at the end of the function. We can define instance attributes by adding properties to `this`. We can also add methods this way, but that's not the most efficient option. If we had 1,000 objects, they would all have a copy of the same method. Instead, we will use prototypes to define methods that all instances of this class have access to. If you try to call a method that does not exist on an object, javascript will check that object's constructor's prototype, and see if the method exists there. 

```javascript
Person.prototype.sayHello = function(){
    console.log(`Hello, my name is ${this.name}.`)
}

alice.sayHello()
```

### The `class` keyword
> In modern javascript, we have the option of using the `class` keyword to set up our prototypes. This is not an entirely new feature, it's simply a cleaner, more elegant way of writing constructor functions. This is sometimes called 'syntactic sugar' because it provides us a new syntax that is enjoyable to use, but doesn't actually provide any new features. Let's recreate the above `Person` class using javascript's class keyword. 

```javascript
class Person {
    constructor(name){
        this.name = name
    }
    sayHello(){
        console.log(`Hello, my name is ${this.name}.`)
    }
}

// using the class keyword has no effect on how we instantiate objects from our constructor,
// or how we call methods from our instances. 
const bob = new Person('Bob')
bob.sayHello()
```

> When writing modern javascript, there are several reasons to prefer using the `class` keyword instead of explicitly modifying prototypes. Using the `class` keyword lets you write OOP code that is similar to what you would write in most other languages, and it more accurately describes our intentions: we want a class, with a constructor function, and instance methods. Also, using prototypes is a little ugly because your class is defined across multiple code blocks, for the constructor function and also the prototype methods, whereas when you use the `class` keyword, the entire class is stored in the `class` block. HOWEVER, you still need to understand how prototypes work. If you write an object-oriented javascript program, and it's not behaving how you expect it to, there will be no classes for you to inspect. You'll need to debug your prototypes.

## Assignments
- [Stock Picker](https://github.com/romeoplatoon/algo-stock-picker) in JS/Python
- [Pig Latin](https://github.com/romeoplatoon/algo-pig-latin) in JS/Python


# Data Structures


## Topics Covered / Goals
- Know what a data structure is and understand their purposes
- Learn the different types of data structures and the main operations/methods associated with each
    - Queues and Stacks
    - Binary Search Trees
    - Hash Tables

**Stretch**
- Understand how to construct each type of data structure

## Lesson


> in computer science, a data structure is a data organization, management, and storage format that enable efficient access and modification of data. in other words, a data structure is a collection of values, the relationships between them, and the functions or operations that can be performed on them. 

## Why does this matter? Why is there more than one data structure?

> Different data structures can perform different operations at different speeds. Depending on which operations you need to perform most often, you might choose a data structure that prioritizes those operations over others. 

```javascript
const data = ['a', 'x', 'y', 'g', 'n','b']
data.unshift('q') // adds 'q' to the start of the array - O(n)

data.push('L') // adds 'L' to the end of the array - O(1)

locationOfG = data.indexOf('g') // searching for a value in an array - O(n)
```

```javascript
// a sorted array of letters
const data = ['a', 'c', 'l', 'm', 'r', 't', 'x']
data.addButKeepSorted('n') //  O(n)

// searching a sorted list is O(log n), because we can use binary search

```


> "Bad programmers worry about the code. Good programmers worry about the data structures and their relationships" - Linus Torvalds


## Arrays
> javascript has a data structure called arrays. that's not what I'm talking about today.  
> All the data for your array is in adjacent slots in memory. this makes searching fast. if you try to push to an array that is full, your computer needs to create a new, larger array, copy the old array to the new one, and delete the old one. 

## Linked list
> a linked list is a non-contiguous data structure, meaning the elements of a linked list are not necessarily next to each other in memory.
- a singly linked list - each node has a reference to the next node
- a doubly linked list - each node has a reference to the next node and also the previous node

## stack
> a stack is like a list in python, if we could only modify it with `push()` and `pop()`. 
processes items in LIFO order (last in, first out)


## queue
> a queue is a like a list, if we could only modify the first item with `enqueue()`, and remove the last item `dequeue()`. 
A customer service help line would be a good example of a queue


## Hash table
hash tables allow you to create a list of key-value pairs. after creating a pair, you can retrieve a value using the key for that value.

### hashing
- a hashing function takes some value as input, and returns a hash, an integer in this case. 
- hashing is a one-way operation. while it's generally fast to hash a value, there is no straightforward way to reverse a hash
- hashing the same input always produces the same output (no randomness)
- it is possible, but unlikely, that multiple values will have the same hash (hash collision) 

```javascript
class HashTable {
    constructor(){
        this.table = new Array(64).fill(0)
        this.table = this.table.map((el)=>{
            return []
        })
    }

    // given a key, this function should return a numerical index, which we can use to access the table above
    _hash(key){
        let hash = 0
        for ( let i = 0; i < key.length; i++ ) {
            hash += key.charCodeAt(i)
        }
        return hash % this.table.length
    }

    set(key, value){
        const index = this._hash(key)
        this.table[index].push([key,value])
    }

    get(key){
        const index = this._hash(key)
        for ( let data of this.table[index] ) {
            if ( data[0] == key ) {
                return data[1]
            }
        }
    }
}

myHash = new HashTable()

myHash.set('name', 'alice')
myHash.set('age', 34)
myHash.set('mane', 'luxurious') // this key will cause a hash collision with 'name', because they are anagrams

console.log(myHash.table)
console.log(myHash.get('name'))
console.log(myHash.get('age'))
console.log(myHash.get('mane'))
```

## Other data structures
A tree is a data structure with a root node, which can have many child nodes, which each can have many child nodes.
A binary tree is a tree where each node has at most two children. 
A binary search tree is a binary tree in which each left node is smaller than each right node. This structure can be searched efficiently using binary search. 

a B-Tree is NOT a binary tree. It's similar, but can have more than 2 children per node, depending on the order of the tree (a 4th order tree has at most 4 children per node). These are commonly used in popular databases. 


## Resources
- [Data structure visualization](https://cmps-people.ok.ubc.ca/ylucet/DS/Algorithms.html)

## Assignments
- [Bank Accounts](https://github.com/romeoplatoon/oop-bank-accounts)
- [Data Structures](https://github.com/romeoplatoon/algo-data-structures)



# Big O


## Topics Covered / Goals
- Understand algorithmic efficiency
- Know how to read and write notation for runtime complexity
- Take some simple steps to avoid writing inefficient code

## Lesson
Big-O ("big O") notation is used in programming to describe the relative performance of a given algorithm. Note that it is not used to describe how much time a algorithm or program will take to run, but rather how it'll be affected by the change in input size. Programmers are generally  concerned with how much time an algorithm takes to run based on the input size, as well as how much memory it might require to utilize. However, time efficiency is usually what we are focused on improving. 

When analyzing the time complexity of an algorithm, we measure how the total number of operations performed increases as the input size becomes very large. 
- We're only interested in the worst-case scenario
- It is assumed that all operations take the same amount of time, so this is roughly equal to measuring time.
- only the largest term matters. 3N^2 + 4N + 1000 would just be N^2. As the input size gets really large, those smaller terms become irrelevant.

### Time Complexities
Here are some common complexities that you'll encounter:

| Notation | Complexity | Summary | Description |
| -------- | ---------- | ------- | ----------- |
| O(1) | Constant Time | Instant | The relative runtime does not change relative to the input size increasing |
| O(log N) | Logarithmic Time | Quick | The relative runtime increases slowly relative to the input size increasing |
| O(N) | Linear Time | Proportional | The relative runtime increases proportionally relative to the input size increasing |
| O(N log N) | Log-Linear Time | Slow | The relative runtime increases quickly relative to the input size increasing |
| O(N^2) | Quadratic Time | Very Slow | The relative runtime increases quadratically relative to the input size increasing |
| O(2^N) | Exponential Time | Ridiculously Slow | The relative runtime increases exponentially relative to the input size increasing |

Let's take a look at some simple examples below:

O(1): Constant Time
```python
small_list = [4, 9, 5, 12, 2] # 5 items
large_list = [6, 10, 9, 7, 1, 8, 17, 3, 13] # 10 items

def append_to_list(my_list, new_item):
    my_list.append(new_item)

append_to_list(small_list, 77) # just adds on to end, not impacted by size of list
append_to_list(large_list, 77) # just adds on to end, not impacted by size of list
```

O(log N): Logarithmic Time
[Binary Search](https://github.com/romeoplatoon/algo-binary-search)

O(N): Linear Time
```python
small_list = [4, 9, 5, 12, 2] # 5 items
large_list = [6, 10, 9, 7, 1, 8, 17, 3, 13] # 10 items

def find_item_greater_exists(my_list, value):
    for item in my_list: # ...factor of N
        if item > value:
            return True

    return False

find_item_greater_exists(small_list, 10) # may take up to 5 iterations
find_item_greater_exists(large_list, 10) # may take up to 10 iterations
```

O(N log N)
There aren't many simple algorithms that have O(N log N) complexity, but it's important to know that various sorting algorithms exist that can sort an array this fast. If you're working on an algorithm problem, and you're struggling to come up with a solution that is better than O(N^2), try sorting the array first!

O(N^2): Quadratic Time
```python
small_list = [4, 9, 5, 12, 2] # 5 items
large_list = [6, 10, 9, 7, 1, 8, 17, 3, 13] # 10 items

def find_double_exists(my_list):
    for x in my_list: # ...factor of N
        for y in my_list: # ...factor of N => N * N
            if x * 2 == y:
                return True

    return True

find_double_exists(small_list) # may take up to 25 (5*5) iterations
find_double_exists(large_list) # may take up to 100 (10*10) iterations
```

O(2^N): Exponential Time
```python
calls = 0
def fibonacci_recursive(N):
    global calls
    calls += 1

    if N == 0:
        return 0
    elif N == 1:
        return 1

    return fibonacci_recursive(N - 1) + fibonacci_recursive(N - 2)
    
# 0, 1, 1, 2, 3, 5, 8, 13 ...
f_index = 6
print("fib index:", f_index)
print("fib value:", fibonacci_recursive(f_index))
print("total calls:", calls, "\n") 

f_index = 12
print("fib index:", f_index)
print("fib value:", fibonacci_recursive(f_index))
print("total calls:", calls, "\n") # the number of calls grows very quick as the f_index gets larger
```

Here's a great site to reference (with a useful chart) for algorithmic complexities: https://www.bigocheatsheet.com/

### Making Improvements

Anything that is O(N^2) or worse, is considered a bad algorithm in terms of time complexity. Sometimes, there's nothing that we can do about this, because we must solve a problem based on what it requires. Oftentimes though, we can make improvements/optimizations, that might not change our overall complexity, but improve our performance:

```python
def find_double_exists(my_list):
    for x in my_list: # ...factor of N
        for y in my_list: # ...factor of N => N * N
            if x * 2 == y or x == y * 2: # an improvement, but this algo is still O(N^2)
                return True

    return True
```

Other times, we may be able to refactor our algorithm entirely to improve our time complexity:
```python
# a better (more efficient) fibonacci function (non-recursive) ... O(N)!
def fibonacci(N):
    f = 0
    a = 0
    b = 1

    for _ in range(N-1):
        f = a + b
        a = b
        b = f

    return f
```

Going from our naive recursive solution to an iterative one for Fibanacci, we've changed our time complexity from O(2^N) (i.e. "terrible") to be O(N)!

### More Examples

Can you analyze the code snippets below and determine what their relative time complexities are?

Example 1:
```python
def example_1(my_list):
    total = 0
    for x in my_list:
        value = x ** 2
        if value > 20:
            for y in my_list:
                if y > 0:
                    total += y + value
    return total
```

Example 2:
```python
def example_2(my_list):
    for item in my_list:
        counter = my_list.count(item)
        if counter > 2:
            return True

    return False
```

Example 3:
```python
def example_3(my_list):
    yummy_list = ["donut", "cake", "pie", "muffin"]

    food_list = []
    for item in my_list:
        if isinstance(item, str):
            food_list.append(item)

    yummy_count = 0
    for food in food_list:
        for yummy in yummy_list:
            if food == yummy:
                yummy_count += 1

    return yummy_count
```

## Resources
**Big O Notation**
- [Big O Slides](https://docs.google.com/presentation/d/1RNYAhAkNF3-UR9rzlBOaWJ0fyYundS0TAGXEYRv-Ybo/edit#slide=id.g22ef87eb09_0_23)

## Assignments
- [Big O Problems 1](https://github.com/romeoplatoon/algo-big-o-i)
- [Bubble Sort](https://github.com/romeoplatoon/algo-bubble-sort) in JS/python



# The Call Stack and Recursion


## Topics Covered / Goals
- Understand what the call stack is and how it operates
- Understand the difference between a recursive function and an iterative function
- Implement recursive solutions to challenges

## Lesson

### The Call Stack
- [The Call Stack](https://docs.google.com/presentation/d/123b2TsW6k0OfvBOH4fmVkKUq7xT3WZ1SEWEUBpfnrqc/edit?usp=sharing)
- A stack is a type of data structure, similar to a Python list. The difference is, a stack follows a Last In First Out (LIFO) model.
  - Think of a deck of playing cards. The first card you're able to pick up is the last card added to the top of the deck.
- The Call Stack is what keeps track of functions that are executing. When a function is invoked, it's added to the top of the stack, and removed once it's resolved.
- If another function is beneath the latest one on the Call Stack, it cannot resolve until the top function has finished resolving
```python
def first():
    print('(PUSH) first function executing...')
    second()
    print('(POP)  first function resolving...')
    return

def second():
    print('(PUSH) second function executing...')
    third()
    print('(POP)  second function resolving...')
    return

def third():
    print('(PUSH) third function executing...')
    print('Hello World!')
    print('(POP)  third function resolving...')
    return

first()
```

- The output of this will be...
```
(PUSH) first function executing...
(PUSH) second function executing...
(PUSH) third function executing...
Hello World!
(POP)  third function resolving...
(POP)  second function resolving...
(POP)  first function resolving...    
```
...because the first function can't resolve fully until the second function is done executing, and the second function can't fully resolve until the third function is done executing.
A good way to visualize the call stack is by using the debugger. If we step through the above program using our debugger, we can watch the individual function calls as they get pushed and popped from the stack.

What happens if an error occurs while our program is running? If you look in your terminal, you should see the call stack. It will tell you not only which function threw the error from which file, but also what function was calling that function, and so on. This is essential information for debugging!

### Recursion

- Recursion is what happens when a function invokes itself. Like an iterative loop, it'll keep invoking itself until a certain condition is met
  - The finishing condition for a recursive solution is called a "base case", a condition where the function no longer returns itself. Without a base case, a recursive function will run until the Call Stack is completely full. In other words, a Stack Overflow.
- Let's consider a simple linear search function. An iterative solution would use a for loop, like this:
```python
def linear_search_iterative(my_list, search_item):
    for i in range(len(my_list)_:
        if my_list[i] == search_item:
            return True

    return False
```
- A recursive solution would need one or more base cases. One of them is obvious: we find the item we're looking for.
  - The other one has to be something that one of our recursions will eventually hit. Perhaps this?
```python
def linear_search_recursive(my_list, search_item):
    if len(my_list) == 0:
        return False

    last_item = my_list.pop()
    if last_item == search_item:
        return True
    else:
        return linear_search_recursive(my_list)

```
- In this solution, `.pop()` removes the last item from the array and returns it. If the last item is a match for our `search_item`, then we can return true. If not, we invoke the function again with the shortened array. Our second base case comes when we empty the array entirely. If the array is empty, the `search_item` is not present at all, so we return false.
- Any problem that can be solved with a loop can also be solved with recursion (and vice versa):
```python
## ------ITERATION
def space_x_countdown_iterative(num):
    for i in range(num, 0, -1):
        print(i)
    
    return console.log("LIFTOFF!")

## ------RECURSION
def space_x_countdown_recursive(num):
    # BASE CASE
    if num == 0:
        return console.log("LIFTOFF!")

    print(num)
    
    # RECURSIVE CASE
    return space_x_countdown_recursive(num-1)
```

Sometimes, it might be hard to know what the base case should be for a recursive algorithm, but your intuition tells you that your algorithm shouldn't need to recurse many times, and you DEFINITELY don't want an infinite loop. In these cases, it can be useful to define a `max_depth` parameter for your recursive algorithm.

```python
def limited_recursion(calls, max_depth):
    if calls < max_depth:
        # do useful stuff here
        print('again!')
        limited_recursion(calls + 1, max_depth)
    }
}

limited_recursion(0, 10)
```

## External Resources
- [Python Tutor](http://www.pythontutor.com/visualize.html#mode=edit)
  - This tool breaks down code step by step, allowing you to see the Call Stack in real-time.

## Assignments
- [School Interface III](https://github.com/romeoplatoon/oop-school-interface-iii)
- [Recursion](https://github.com/romeoplatoon/algo-recursion)
- [Binary Search](https://github.com/romeoplatoon/algo-binary-search) in JS/Python


# HTML and CSS


## Topics Covered / Goals
- **HTML**
  - What is HTML?
    - HTML = Hyper Text Markup Language
    - Instructs the web browser how to display a page.
    - Separates content from presentation.
    - Elements define content types by containing tags that contain or express content.
  - HTML is not...
    - Programming in its purest sense.
    - Easy, because it requires quite a bit of memorization.
    - Easy, because different browsers display markup in different ways.
- **CSS**
  - What is CSS?
    - CSS stands for Cascading Style Sheets
    - CSS describes how HTML elements are to be displayed on screen, paper, or in other media
    - CSS saves a lot of work. It can control the layout of multiple web pages all at once
  - Why use CSS?
    - CSS is used to define styles for your web pages, including the design, layout and variations in display for different devices and screen sizes.
  - How to debug CSS
    - Use the `elements` tab in devtools
    - Use the `network` tab in devtools


## Lesson
**HTML Tag Architecture**

```html
<!-- index.html  -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Code Platoon!</title>

  <link href="styles.css" rel="stylesheet" /> <!-- A link to our style sheet  -->
  <script src="app.js" defer></script> <!-- A link to our javascript file  that will interact with our webpage -->

</head>
<body>
  <h1 id="title" >My Website</h1>
  <p class='sub-title'>Subtitle for my website</p>
  <!-- The rest of your HTML goes here  -->
</body>
</html>

```

**HTML Elements & Tags**
HTML consists of __elements__ which are the building blocks to HTML pages and which are represented by HTML __tags__.
```html
<!-- index.html  -->

<!-- An HTML element is the start of an HTML tag and the end of an HTML tag. -->
<h1>This is a heading tag</h1>

<!-- This is an HTML element with a button tag -->
<button>PRESS HERE</button>
```

[Here is a list of HTML Tags from HTML](https://www.w3schools.com/tags/ref_byfunc.asp) and [htmlreference.io](https://htmlreference.io/)

**HTML Attributes (__id__ & __class__)**
When styling webpages with colors, fonts, sizes, and photos you will rarely apply CSS properties directly to the __element__ or __tag__.
```html
<!-- index.html -->
<h1>My Website</h1>
<p>Subtitle for my website</p>
```

You will apply an __id__ or __class__ to select the desired HTML element. The difference between an __id__ and a __class__ is that an __id__ can be used to identify only one element, whereas a __class__ can be used to identify more than one.

```html
<!-- index.html -->
<h1 id="title" >My Website</h1>
<p class='sub-title'>Subtitle for my website</p>
```

```css
/* styles.css */
#title {
  font-size: 34px;
  text-align: center;
  color: #66B6FF
}

.sub-title {
  font-size: 18px;
  text-align: center
}
```

**Example**
- Let's `touch` a new html file called `index.html` and put this content inside: `<h1>Hello World!</h1>`
- Break this down:
  - The `<h1>` is called a `tag`, _most_ tags will have openings `<h1>` and closings `</h1>`.
  - The `content` is what is between the tags. Tags can be used to express content in different ways.
    - Let's take a look at what exactly the `<h1>` does to the content that resides within it:
      - Try this: `<h1>content</h1>`
      - Then this: `<em>content</em>`
      - What do you notice that the HTML tags do to the content inside?
  - The combination of everything: `<h1>This is a heading</h1>` is an element. The web is full of elements!
- Sometimes, `elements` have `children`.
- Here is an example of an element with children:
```HTML
<div>
  <h1>Heading</h1>
</div>
```
In this example, the `<div>` has a child, `<h1>`.

**Display types**
It is _crucial_ to know how an element is displayed.

A `block` element, such as `<h1>` takes up the **entire** width of the browser window.

An `inline` element, such as `<a>` only takes up the **space** of its content

**Individual Discovery (Not to be submitted)**
1. [Check out some of the tags and what they do](https://developer.mozilla.org/en-US/docs/Web/HTML/Element)
2. Right-click on some text in your browser and select 'Inspect' to see some elements on your own.
    ![inspect-element](https://cloud.githubusercontent.com/assets/2447940/21957062/4c6b6238-da54-11e6-8219-537af59e20ee.gif)
3. There are some really weird tags like `bdo`, what does it do?
    - Try: `<bdo dir="rtl">uoy htiw eb ecrof eht yam</bdo>`
    - The `rtl` from above is called an `attribute`.

**What is CSS?**
- _Cascading_ Style Sheets
    - The emphasis on cascading means that the last style line of code to run is what is rendered by the browser.
    - A way to think of the relationship between HTML and CSS is building a building.
      - The architecture of a building is the HTML
      - CSS is the color of the paint, the size of the windows, etc.
    - On the web, HTML contains and expresses content, CSS _styles_ the content.

- How to apply CSS (code together)
  - Put it directly `inline`
    - `<p style="color: red;">Paragraph</p>`
  - Create an internal stylesheet
    ```HTML
    <html>
      <head>
        <style>
          p { color: red; }
        </style>
      </head>
      <body>
        <p>Paragraph</p>
      </body>
    </html>
    ```
  - Link an external stylesheet:
    ```HTML
    <html>
      <head>
        <link rel="stylesheet" type="text/css" href="styles.css">
      </head>
      <body>
        <p>Paragraph</p>
      </body>
    </html>
    ```
    `styles.css` file:
    ```CSS
    p { color: red; }
    ```

**The structure of CSS**

`selector { property: value }`

Let's say I wanted to center some text on a line (Let's do this together).

1. `<h5>Text</h5>`
2.  Apply CSS `<h5 style="text-align: center;">Text</h5>`
3.  In this case, the `h5` is the `selector`, `text-align` is the property, and `center` is the value.

**Student Exploration**
1. [Look at all the properties](https://meiert.com/en/indices/css-properties/)
2. Use the browser's element inspector to see what properties have been applied to content across the web.
3. Try altering the CSS through the console!

    ![alter-css](https://cloud.githubusercontent.com/assets/2447940/21957697/17d0c8de-da62-11e6-8e45-00575bbae501.gif)

## CSS Specificity
- What happens if you you have `div`, `class`, or `id` elements with style conflicts? (i.e., a `div` has X style, a `class` has Y style, and an `id` has Z style)? The browser won't know what to do!
- Luckily, there is specificity built into CSS. The higher the weight,
the greater the superiority when styling conflicts occur.

Selector | Weight
--- | ---
`<>` | .001
`.class` | .010
`#id` | .100

Selectors can be combined to result in a greater weight.

`.red-text .capital { background-color: yellow; }`

The above carries a weight of `.020`

**The Box Model**

**~~Everything is a box.~~ Everything on the internet is a box.**

![box model](https://cloud.githubusercontent.com/assets/2447940/21958828/a870607e-da7c-11e6-9447-6e7d8e4d67fe.PNG)

Check it out for yourself

![box-model-gif](https://cloud.githubusercontent.com/assets/2447940/21958874/76a5aff8-da7d-11e6-91d3-e9e4fd97cd2b.gif)

Let's make a box together.

```HTML
<style>
  div {
    border: 6px solid #949599;
    height: 200px;
    margin: 20px;
    padding: 20px;
    width: 200px;
  }
</style>
<div>Hello</div>
```

Hints:

- `border` is shorthand for setting multiple border properties.
- `#949599` is a hexadecimal color code.
- `div` is a tag that has no meaning, except that it is a block element. `span` is the same, except inline.

**Class Practice**
1. Make a square.
2. Make a rectangle.
3. Try different border values, such as `dashed` or `inset` (replace `solid` from above).
4. Adjust the `margin` and padding, and see its effect.
5. [Try out some new colors](http://www.color-hex.com/)
6. Can you make a circle?
7. Can you make an oval?
  - Change the `background-color` to something more desirable to your eyes.

**Debugging CSS**


## Assignments
- [Front End Intro](https://github.com/romeoplatoon/html-front-end-intro)
- [Recreate hacker news](https://github.com/romeoplatoon/html-hacker-news)
- [Top Ten](https://github.com/romeoplatoon/html-top-ten)


# CSS Layout

## Topics Covered / Goals
- Display
- Position
- Z-index
- float
- overflow
- pseudo classes
    
> The purpose of this lecture is to learn how to use the most fundamental CSS properties for laying out a page, such as `display` and `position`. You should be able to place elements precisely on an HTML page, and be able to make a pixel-perfect recreation of a web page, given only a picture. 

### Display
> All elements have a default display type. Display types have very important nuances that affect the way elements appear on a page. The main display types are:
- `block` by default, take up the full width of a page, line break before and after
- `inline` tightly wraps content, no true dimensions
- `inline-block` best of both worlds, has dimensions but will also share horizontal line space
- `none` completely removes the element from the document flow
- `flex` creates a flex-container, a new feature that is useful for complex layouts where elements must be centered in a row or column (we'll talk about this later)

The following table includes the most commonly used tags and their default display types:

| display        | tags                                         |
|----------------|----------------------------------------------|
| `block`        | `body`, `div`, `section`, `p`, `header`, ... |
| `inline`       | `span`, `i`, `b`, `em`, `strong`, `sup`, ... |
| `inline-block` | `img`                                        |

Create several more divs that all have the class `.box`.

```html
<div id="boxes">
    <div class="box">Some Content</div>
    <div class="box" id="theBox"><strong>Some Content</strong></div>
    <div class="box">Some Content</div>
    <div class="box">Some Content</div>
    <div class="box">Some Content</div>
    <div class="box">Some Content</div>
    <div class="box">Some Content</div>
    <div class="box">Some Content</div>
    <div class="box">Some Content</div>
    <div class="box">Some Content</div>
    <div class="box">Some Content</div>
    <div class="box">Some Content</div>
</div>
```

> By default, divs have `display:block`. 
Use the inspector to see that this default style is being applied by the browser. Notice how each box takes up the full width of the page. 
> By default, `strong` elements have `display:inline`. 
Use the inspector to see that this default style is being applied by the browser. Notice how the strong tag's dimensions are the same as the text it contains.
It may be necessary to use the 'computed' tab in the inspector, instead of the 'styles' tab, to show the default styles that the browser applies.

In the linked stylesheet, add `display: inline-block` to the `.box` class.

```css
.box {
    height: 100px;
    width: 100px;
    padding: 2px;
    margin: 10px;
    border: 2px solid black;
    display: inline-block;
}
```

Refresh the page to see how the divs now form multiple rows. 

### How do we know how these divs will line up?
> By default, all elements are subject to the "document flow", meaning that they "fall" into the top left corner, then line up to the right.
> When there's no more space on the current line, elements form a new line below, to the left. 
> Some CSS styles can change the way elements flow (e.g. `display:block`, `display:inline-block`) and some styles can remove elements from the document flow entirely (e.g. `display:none`).
> During this lecture, we'll see other examples of styles that change how elements flow. 

### How do we know how many divs I can fit in one row? (box-sizing)
> Our divs have `width:100px;`. If our window is 1000px wide, you might think that we could fit 10 divs in one row.
> However, the element's width only includes the content, not the padding, margin, or border. 
> If we take the rest of the box model into account, each div actually takes up 100px + 2(2px) + 2(2px) + 2(10px) = 128px.
> We can make our lives easier by setting `* { box-sizing: border-box }`. This means that the border and padding should be included when calculating the element's width.
> For example, if we set `* { box-sizing: border-box }`, then our divs only take up 104px, because the padding and border are included in the 100px width. Only the element margin adds to the total space it takes up.
> The benefit of this is that we can now make small adjustments to our padding and border, without messing up the rest of our layout.
> The default value for `box-sizing` is `content-box`, meaning that only the content is included in the width. Another option is `box-sizing:margin-box`, which means that all layers of the box model are included when calculating the element's width.

Use the inspector to temporarily change the padding or border of one of the boxes. 
The size of the content changes dynamically so that the total width remains the same while the padding or border change.

### What's that extra space between the divs? It's not margin, or padding. What's going on?
> "**IMPORTANT**: One of the nuances of using `inline-block` is that **white-space** is still calculated in the layout of `inline-block` elements. This effectively creates a gap between `inline-block` elements, meaning the boxes will have this gap between them that is not a result of the `margin` or `padding` properties. In fact, the gap one sees is the actual `space` character!"
> One way to get rid of this space is to set the font-size of parent element wrapping the `inline-block` to **zero**
> However, doing this will also set the font-size of child elements to zero, so you may have to re-establish a sensible font-size for child elements. Unlike most CSS properties, font-related properties are inherited from parent to child.

```css
#boxes {
    font-size: 0; /* 0px is the same as 0inches, which is the same as 0%, etc etc. If you have 0 of something, the units don't matter. */
}

#boxes * {
    font-size: 12px;
}
```
### Why is there extra space around the edge of the screen?
> Remember that `body` is itself an html element, and it can have styles applied to it. By default, many browsers apply margin to the body. 

```css
body {
    margin: 0;
}
```
    
### Positioning
> Often, we want to position elements in ways that are totally different from how elements normally flow on the page.
> We can take more control over where an element displays on the page using the CSS `position` property. 

#### Static Position
> By default, all elements have `position:static`. Static elements are subject to the normal document flow, which we've been learning about today.
> Elements with `position:static` are considered to be **not positioned**. Elements with any other value for their `position` property are considered **positioned**.

#### Relative Position
> The next simplest value for `position` is `relative`. An element with `position:relative` mostly behaves the same way as an element with `position:static`, except:
- An element with `position:relative` is technically **positioned**. 
- An element with `position:relative` can be nudged in any direction using properties top, left, bottom, and right.
    - For example, setting `top:20px` pushes the element **down** 20px.
    - Don't forget, these properties (top, left, bottom, right) do **nothing** to static elements. 

Add position:relative to theBox to demonstrate relative positioning. 

```css
#theBox {
    position: relative;
    top : 20px;
    right: 30px;
}
```

> Even though `#theBox` appears to be floating off in space, it actually takes up space in its usual location, as if it were static. 
> You can tell because all the other divs are in their usual locations. They don't get pushed around when we add `top` or `left` to `#theBox`.

#### Fixed Position

> Fixed position removes an element from the document flow entirely, and positions it relative to the window. This is easy to understand from an example.

Add several dozen more `.box`es, enough that the page can be scrolled.

```css
#theBox {
    position: fixed;
    bottom : 20px;
    right: 30px;
}
```

> This will position `#theBox` in the lower right corner of the screen, 20px from the bottom edge, and 30px from the right edge.
> As we scroll down the page, you can see that `#theBox` stays in the same corner of the screen, and doesn't seem to interact with other elements on the page.
> `position:fixed` is commonly used for navbars, paywalls, and the worst kinds of advertisements. 

#### Absolute Position

> `position:absolute` is the most complicated value for `position`, so pay attention!
> An element with `position:absolute` is removed from the document flow entirely, and is positioned relative to its closest **positioned** parent.

To demonstrate `position:absolute`, we'll need to make some new html.

```html
<div class="outer">
    <div class="middle">
        <div class="inner"></div>
    </div>
</div>
```

```css
.outer {
    height: 400px;
    width: 400px;
    background-color:black;
    position: relative;
}
.middle {
    height: 300px;
    width: 300px;
    background-color: green;
}
.inner {
    height: 50px;
    width: 50px;
    background-color: red;
    position: absolute;
    right: 5px;
    bottom: 10px;
}
```

Using the inspector, notice how the `.inner` div is positioned relative to the bottom right edge of the `.outer` div, not the `.middle` div, because the `.outer` div is positioned, while the `.middle` div is not positioned.

### z-index
> z-index controls the position of an element on the z-axis (towards or away from the user).
> Because screens are flat, there are no units to the z-index, it's just a ranking of what's on top of what. 
> Be careful, a page can have multiple 'stacking contexts', so an element with a high z-index might not appear on top of another element with a low z-index, if they're in different stacking contexts.
> Best practice: set z-indexes in increments of 10, so that other developers can put elements above, below, or in between yours. 

### Floats
> Floating an element moves it to the left or right side of its container.
> The purpose of floating an element is to wrap text around images, like in a magazine or newspaper layout. 
> Floating an element also has many side effects which can be difficult to reason about. To keep your code simple, only use floats for wrapping text around images.
> If you just need to move an element to the side of its container, `position:absolute` or `text-align:right` are probably better choices. 

```css
    .pretendThisIsAnImage{
        height: 50px;
        width: 50px;
        background-color: red;
    }

    .floatMeRight {
        float: right;
    }

    .text-block {
        font-size: 24px;
    }
```

```html
        <div class="floatMeRight pretendThisIsAnImage"></div>
        <p class="text-block">
            This is a lot of text. This is a lot of text.
            This is a lot of text. This is a lot of text.
            This is a lot of text. This is a lot of text.
            This is a lot of text. This is a lot of text.
            This is a lot of text. This is a lot of text.
            This is a lot of text. This is a lot of text.
            This is a lot of text. This is a lot of text.
            This is a lot of text. This is a lot of text.
            This is a lot of text. This is a lot of text.
            This is a lot of text. This is a lot of text.
            This is a lot of text. This is a lot of text.
        </p>
```

> Now, you can see that the text is wrapped around the paragraph. 
> This might seem a bit odd, because the 'image' appears to be inside the `p`, even though the 'image' is a sibling of the `p`, not a child.

### Clear
> Elements with the `clear` property will refuse to share horizontal space with floated elements on the specified side.

```css
    .text-block {
        clear: left;
    }
```

Show students how the above styles do nothing, because no elements are floating to the left of the text block.

```css
    .text-block {
        clear: right;
    }
```

Show students how the above styles force the text block to render below the floated element. 

### Overflow
> Normally, html elements will automatically expand their size to accomodate all of their children. 
> However, if you explicitly set a height on an element, and it has more content than will fit in that height, the content will overflow from the container.

Set a fixed height `#boxes`.

```css
#boxes {
    height: 700px;
}
```

All the boxes on the page won't fit in 700px of vertical space. Use the inspector to see how the content is flowing outside of its container.

> If we want to control what happens when there is more content than fits in its container, we can set the `overflow` property.
> The most common value is `overflow:hidden` which makes the overflowing content invisible. 

```css
#boxes {
    height: 700px;
    overflow: hidden;
}
```

> If you want the extra content to be accessible without messing up your layout, then `overflow:scroll` will make `#boxes` scrollable.
> If you think that `#boxes` will have too much content only **some** of the time, you may want to use `overflow:auto`. This will make the scrollbars appear only when necessary. 

```css
#boxes {
    height: 700px;
    overflow: scroll;
}
```

Briefly show students that they can now scroll the `#boxes` div to view all the boxes that don't fit in 700px.

### Pseudo and Dynamic Classes
> Pseudo and dynamic classes are created as a result of user actions. For example:

```HTML
a:link    { color: green; }
a:visited { color: yellow; }
a:active { color: red; }
a:hover { color: orange; }
input:checked { height: 50px; width: 50px; }
input:valid { color: green; }
input:invalid { color: red; }
input:focus { color: gray; }
li:first-child {}
li:nth-child(2) {}

```
> Let's create an html file, put this CSS in the `style` tag and see the above in action:

> The first line of code would change the color of the links on the page to green, and if those links had been previously visited, they would be yellow.

> A commonly used dynamic class is `hover`.

```HTML
a:hover {
  text-decoration: none;
  color: blue;
  background-color: yellow;
}
```

## External Resources
- [Learn Layout](https://learnlayout.com/)

> The above code would cause links on the page to change colors only when hovered upon by the cursor.

## Assignments
- [LinkedIn](https://github.com/romeoplatoon/html-linkedin.git)



# Responsive Web Design

## Topics Covered / Goals
- What is Responsive Web Design (RWD)?
    - accomodates different device sizes, input methods, data network limits
    - progressive enhancement vs graceful degradation
- How do we make a responsive website?
    - meta viewport tag
    - responsive units (%, vh/vw/vmin, ems/rems,)
	- flexbox
    - media queries
	- use a CSS framework (e.g. bootstrap)
- Bootstrap basics
	- Grid system
	- Useful components


## Lesson


### What is responsive web design?
> Responsive web design is an approach to building websites in which the website responds to various aspects of the user's device to show them a more appropriate version of the website. Most commonly, a responsive website needs to adapt to the width of the user's device, to show a version of the website that fits in the screen. Aside from screen size, a responsive website should be usable across different devices with different capabilities, such as touchscreens, mouse and keyboard, or even browsers that don't have javascript.

> Most approaches to responsive web design fall into one of two categories, depending on whether you are primarily targeting larger, fully featured devices, or smaller, more limited devices. 
- Progressive Enhancement is a style of rwd in which you design primarily for the smallest, most limited devices (touch screen devices without mouse/keyboard), and then gradually add non-essential features for larger screens. For example, notice what happens on your linkedin profile page as you expand the window from phone-sized to full-size.
- Graceful degradation is a style of rwd in which you design primarily for the largest, most capable devices (laptops with a mouse and keyboard), and then gracefully remove features for devices that can't handle them. Ideally, removed features are replaced with an alternative, or at least the user is informed that their browser does not support the required feature. One simple example of graceful degradation would be the `<noscript>` tag, which only renders on the screen for users that don't run javascript. Ideally, this element should be used to display a plain-text version of your website for users that don't have javascript enabled. More commonly, this tag is just used to tell users that the website won't work without javascript. 

```html
	<noscript>you need javascript for this webpage!</noscript>

```

### How do we create a website that looks good at different screen sizes?
> There are many aspects of responsive web design, but we will be focused mostly on building layouts that adapt to different screen widths. 

#### Responsive Meta Tag
> The first problem you'll need to solve if you want your website to be usable on phones is that all of the content will appear tiny by default, much smaller than you'd expect. Let's build a basic webpage, and then look at it in the device simulator (left of the 'elements' tab in dev tools) to see how much smaller it gets. 

```html
<html>
    <head>
        <!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->
    </head>
    <body>
        <h1>Look at this header!</h1>
        <p>this is a paragraph</p>
    </body>
</html>
```
> The problem is that since mobile browsers were invented before mobile websites, many mobile browsers will automatically scale down the size of content so that a website that was designed for a large screen will fit. Since we're actually designing our website for a small screen, we need to control this behavior. This is done by adding a responsive meta tag to the head of the html document. There are [several settings](https://css-tricks.com/snippets/html/responsive-meta-tag/) you can set to control the scaling and zoom. Here's a common responsive meta tag that causes content to render at a consistent size across mobile and desktop browsers.

```html
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
        <h1>Look at this header!</h1>
        <p>this is a paragraph</p>
    </body>
</html>
```

#### Responsive Units
##### %
> One way to make a design that works at different screen sizes is to avoid using fixed units like `px`, and instead use responsive units. The most common or basic responsive unit might be `%`, although it's not the simplest one, actually. `1%` in CSS means 1% of the parent element, for most CSS properties, like height and width. This can make % tricky to work with, because restructuring your HTML might resize an element that is sized with %, even if the screen size is the same. For some CSS properties, such as `transform`, % refers to a percentage of the element itself, not its parent. 

##### vh, vw, vmin, vmax
> Some other responsive units that might be easier to work are vh and vw. One vh is always 1% of the height of the browser window, and one vw is always 1% of the width of the window. These can be useful for a paywall or login modal that you want to cover 'most' of the user's screen, regardless of their window's dimensions. 

> Similarly, 1 vmax is equal to 1 vh or 1 vw, whichever is bigger. A vmin is just the opposite. These can be useful for designing a layout that adapts to the device's orientation, either landscape or portrait. For example, you could use vmin to make an element that expands proportionally to the screen size, but always fits entirely in the screen, regardless of orientation. 

```css
.annoying-popup {
    position: fixed;
    width: 80vmin;
    height: 80vmin;
    background-color: purple;
    border-radius: 999px;
}
```

##### ems and rems
> There are two responsive units that are used for sizing fonts in particular: `em`, and `rem`. `em` lets you set a size for an element relative to that element's parent's font-size. This can be tricky to work with, since the size of an element sized in `em` will change if you move it around the page. Also, nested elements sized with `em` will multiply each other. 


> The other option for responsive font sizing is `rem`, which is a root em. A `rem` lets you size elements as a multiple of the font-size of the `html` element. This makes it easy to have user-adjustable font, or have all of your fonts change size with a media query, as we'll learn about later. If all the text on your site is sized with `rem`, then you only need to change the font-size for the `html` element in order to resize all the text on the site. 

```html
<div class="rem-size">
	<p>wow!</p>
	<div class="rem-size">
		<p>wow!</p>
		<div class="rem-size">
			<p>wow!</p>
			<div class="rem-size">
				<p>wow!</p>
			</div>
		</div>
	</div>
</div>
```

#### Flexbox
> Flexbox is useful for solving one-dimensional layout problems, i.e. when you're trying to line items up in a row or column. This is a different use case from CSS grid, which is used for solving two-dimensional layout problems. `flex` is a relatively new display type that changes the document flow in a container, giving you more options for how you want to center or align content. A `flex` container can have other flex properties, such as `justify-content`. Individual items in a flex container can have flex properties set on them, if you want them to flow differently from their siblings. [This article](https://css-tricks.com/snippets/css/a-guide-to-flexbox/) has a lot of good visual examples of different flex properties. 
```css
.container {
  display: flex; /* or inline-flex */
  justify-content: space-evenly; /* spaces the child elements evenly in relation to the parent container
}
```

#### Media Queries
> If all of the above techniques are not sufficient to make your website responsive, then you might need to use media queries, which let you apply completely different CSS based on various device properties, primarily the width. Uncommonly, you might also need to use media queries to add or remove relevant elements when displaying your page for other devices like screen readers or printers. You probably wouldn't need to print the website's navbar, since you can't click on a piece of paper. 

```css
	@media (max-width: 1245px) {
		html {
			font-size: 18px;
		}
	}
	@media (max-width: 845px) {
		html {
			font-size: 14px;
		}
	}
```

### Styling with Bootstrap

#### What is it?
> Bootstrap is a very popular CSS framework, essentially just a bunch of class selectors with pre-defined CSS rules
- Provides Normalization (standardizes the way some elements look by default - Normalize.css)
- Helps you build your layout (Grid system)
- Helps you build a Responsive design (uses media queries and relative units to accomodate devices of different sizes)

#### Grid System
> Bootstrap's grid system uses a 12 column layout. You will be specifying how many columns (how wide) an element takes up
- 12/12 columns => 100% width
- 6/12 columns => 50% width
- Grid system has a specific pattern you must follow
	- You NEED to have these classes in order for the grid to work

		1. .container / .container-fluid
		2. .row
		3. .col-*-* (.col-SCREENSIZE-COLUMNS)

	- Column Classes
		`.col-xs-8` => on `xs` screens and up, 8/12 columns
		Screen sizes : `xs`, `sm`, `md`, `lg`
		columns : 1 - 12

```html
<div class="container">
	<div class="row">
		<div class="col-md-4"></div>
		<div class="col-md-8"></div>
	</div>
</div>
```

> You can use multiple column classes on an element. Also, if there are more than 12 columns in a row, they will wrap around and make another row.
> In the example below, we'll see 3 rows of 4 columns on medium screens, and 4 rows of 3 columns on small screens.

```html
<div class="container">
	<div class="row">
		<div class="col-md-3 col-sm-4"></div>
		<div class="col-md-3 col-sm-4"></div>
		<div class="col-md-3 col-sm-4"></div>
		<div class="col-md-3 col-sm-4"></div>
		<div class="col-md-3 col-sm-4"></div>
		<div class="col-md-3 col-sm-4"></div>
		<div class="col-md-3 col-sm-4"></div>
		<div class="col-md-3 col-sm-4"></div>
		<div class="col-md-3 col-sm-4"></div>
		<div class="col-md-3 col-sm-4"></div>
		<div class="col-md-3 col-sm-4"></div>
		<div class="col-md-3 col-sm-4"></div>
	</div>
</div>
```

> COLLUMNS CAN CONTAIN OTHER ROWS. THE POSSIBILITIES ARE ENDLESS!

```html
<div class="container">
	<div class="row">
		<div class="col-sm-4">
			left column!
		</div>
		<div class="col-sm-4">

			<div class="row">
				<div class="col-sm-5">
					left subcolumn
				</div>
				<div class="col-sm-7">
					right subcolumn
				</div>
			</div>
		</div>
	</div>
</div>
```

#### JS Components
> Bootstrap provides many interactive components, powered by javascript.
- Collapse
- Accordion (many collapses together, used commonly in FAQs)
- Carousel (for showing a series of images or slides)
- Dropdown (for simple menus)
- Modal (for prettier alert and confirm boxes)
- Navbar (responsive navigation with a hamburger menu)

## External Resources
- [Guide to Flexbox](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)

	
## Assignments
- [Styling with Bootstrap](https://github.com/romeoplatoon/html-bootstrap)



# DOM Events

## Topics Covered / Goals
- Understand what the DOM (Document Object Model) is
- Understand how to use JavaScript to manipulate the DOM
- Understand how to handle browser events

## Lesson

### JavaScript
We've been using [node](https://en.wikipedia.org/wiki/Node.js) to run our javascript code in the terminal. This is a relatively new development for Javascript. Originally, it was created to run exclusively in the browser so that developers could add behavior to web pages. Since then, it has become the primary language of the web. Let's look at how Javascript runs in the browser, and how we can use it to make our web pages more dynamic.

### The DOM
Before we can start using Javascript on our front end, we need to understand what the DOM is and how it works. When the browser receives a webpage (HTML and CSS) it breaks it up into a tree like structure called the Document Object Model (DOM).

![The DOM](../page-resources/DOM_example.png)

Each element in our HTML document is represented as a 'node' in the DOM. We can use Javascript to access these nodes and manipulate them. Let's start with a simple HTML file. Create a file called `index.html` and paste the following code:

```HTML
<!DOCTYPE html>
<html>
  <head>
    <title>My HTML Page</title>
    <script>
      const showGreeting = () => {
        let nameInput = document.getElementById("input-name")
        let greetingOutput = document.getElementById("output")
        if (nameInput && greetingOutput) {
          greetingOutput.innerHTML = "Hello " + nameInput.value + "!"
        }
      }
    </script>
  </head>   
  <body>
    <input id="input-name" placeholder="name"/>
    <button onclick="showGreeting();">Submit</button>
    <div>
      <p id="output"></p>
    </div>
  </body>
</html>
```

### External JavaScript

We have included our JavaScript logic internally to our HTML document. This usually isn't the best organization, so let's move our logic to a separate file ("scripts.js") and link it externally...
```HTML
<!-- index.html -->
<!DOCTYPE html>
<html>
  <head>
    <title>My HTML Page</title>
    <script src="scripts.js" defer></script>
  </head>   
  <body>
    <input id="input-name" placeholder="name"/>
    <button onclick="showGreeting();">Submit</button>
    <div>
      <p id="output"></p>
    </div>
  </body>
</html>
```

```javascript
// scripts.js
const showGreeting = () => {
  let nameInput = document.getElementById("input-name")
  let greetingOutput = document.getElementById("output")
  if (nameInput && greetingOutput) {
    greetingOutput.innerHTML = "Hello " + nameInput.value + "!"
  }
}
```

Note that we have a `defer` keyword included in our `script` tag. This tells the browser to only load the javascript logic after the HTML document has fully loaded. This is usually preferred, since we may want to interact with the DOM when the javascript logic loads and executes, so we need to ensure that the DOM has fully been created. 

### Accessing elements from the DOM
We're using the `getElementById()` method on the `document` object in the code above, to retrieve the element model that we're interested in. Common methods for retrieving items from the DOM are:
- `document.getElementById()`
  - retrieves the [first] element object that matches the specified `id` attribute
  - returns a single element (if found)
  - ids on a given html pages should always be unique!
- `document.getElementsByClassName()` 
  - retrieves every element that matches the specified `class` attribute 
  - returns an array element objects
  - can only be used for a single class name lookup
- `document.getElementsByTagName()` 
  - retrieves every element that matches the specified tag name
  - returns an array of element objects
- `document.querySelector()` 
  - very similar to getElementById() 
  - retrieves the [first] element object that matched the css selector
  - returns a single element (if found)
  - generally use with id-selectors
- `document.querySelectorAll()` 
  - similar to getElementsByClassName() and getElementsByTagName()
  - retrieves every element object that matches the css selector 
  - returns an array of element objects
  - can be used with any combination of class and/or tag names! (CSS combinators)

Let's add some more elements to our HTML page:
```html
<!-- index.html -->

    <!-- in body -->
    <hr />
    <button onclick="updateColor('#DD0000')">Red</button>
    <button onclick="updateColor('#0088FF')">Blue</button>
    <hr />

    <div id="parent-div">
      <div id="one" class="alpha apple">
        This is the first div.
      </div>
      <div id="two" class="alpha avacado">
        This is the second div.
      </div>
      <div id="three" class="beta banana">
        This is the third div.
      </div>
    </div>
```

And now let's see different ways we can access elements using the methods mentioned earlier, by modifying our `scripts.js` file:

- document.getElementById()
```javascript
// scripts.js
const updateColor = (color) => {
  let e = document.getElementById("one") // will return the [*first*] element that has an id equal to 'one'
  if (e) {
    e.style.color = color
  }
}
```

- document.getElementsByClassName()
```javascript
// scripts.js
const updateColor = (color) => {
  let elems = document.getElementsByClassName("alpha") // will return *every* element that has 'alpha' as a listed class name
  for (let e of elems) {
    e.style.color = color
  }
}
```

- document.getElementsByTagName()
```javascript
// scripts.js
const updateColor = (color) => {
  let elems = document.getElementsByTagName("div") // will return *every* div element on the page
  for (let e of elems) {
    e.style.color = color
  }
}
```

- document.querySelector()
```javascript
// scripts.js
const updateColor = (color) => {
  let e = document.querySelector("#one") // will return the [*first*] element that has an id equal to 'one', similar to getElementById() 
  if (e) {
    e.style.color = color
  }
}
```

- document.querySelectorAll()
```javascript
// scripts.js
const updateColor = (color) => {
  let elems = document.querySelectorAll(".alpha") // will return *every* element that has 'alpha' as a listed class name, similar to getElementsByClassName() 
  for (let e of elems) {
    e.style.color = color
  }
}
```

### Creating/Inserting elements into the DOM

In addition to manipulating existing nodes from the DOM, we can use JavaScript to create new elements and insert them into the DOM manually. This allows our pages to be more dynamic, rather than always having to create our HTML elements statically. The main document method to create a new element, is aptly named `createElement()`. 

Let's add a new button to our HTML page:
```html
<!-- index.html -->
    <!-- in body -->
    <button onclick="insertNewElement()">Insert New Div</button>
```

And let's also add in our new javascript code:

```javascript
// scripts.js
const insertNewElement = () => {
  let newDiv = document.createElement("div") // this creates a new div element
  newDiv.innerHTML = "This is a newly created div!"
  newDiv.className = "alpha added"

  let parentDiv = document.getElementById("parent-div")
  if (parentDiv) {
    parentDiv.appendChild(newDiv) // this attaches our new div element into the DOM, by nesting it under an existing element
  }
}
```

Notice that we have to create our new element and then also attach it to an element that already exists in the DOM, in order for it to show up. Don't forget this step!

We've only covered a few methods and properties that can be accessed through an element object. You can view a full list of properties and methods for an HTML element object [here](https://www.w3schools.com/jsref/dom_obj_document.asp)


### Events

The browser is always listening, always keeping track of user behavior. It can tell you when a user has clicked on something, when the mouse enters or leaves an element's bounds, the location of the mouse at any given time, and much more. We've already seen the use of the `onclick` event attribute, which specifies how a click event is handled when generated by the user. You can find a full list of event attributes [here](https://www.w3schools.com/tags/ref_eventattributes.asp). 

We can add event attributes to pretty much every element that exists in the DOM. If we're creating elements just in our HTML file, we simply add the event attribute and specify the event listener (i.e. the function that will be called when the event is triggered) value like any other attribute for an element. However, if we need to specify an event listener dynamically in our JavaScript file, we need to use the `addEventListener()` method on an element object. 

Let's continue to add on to our code from above:

```javascript
// scripts.js
const insertNewElement = () => {
  let newDiv = document.createElement("div") // this creates a new div element
  newDiv.innerHTML = "This is a newly created div!"
  newDiv.className = "alpha added"
  
  // add a new event listener, which will trigger when the user moves the mouse cursor across this element
  newDiv.addEventListener("mousemove", (evt) => {
    // change the background color of the element based on the x-pos of the cursor!
    let xRatio = 1.0 - evt.x / document.documentElement.clientWidth
    let nonRedValue = Math.round(256 * xRatio)
    evt.target.style.backgroundColor = `rgb(256, ${nonRedValue}, ${nonRedValue})`
  })

  // add a new event listener, which will trigger when the user moves the mouse cursor off of this element
  newDiv.addEventListener("mouseout", (evt) => {
    evt.target.style.backgroundColor = "initial"
  })

  let parentDiv = document.getElementById("parent-div")
  if (parentDiv) {
    parentDiv.appendChild(newDiv) // this attaches our new div element into the DOM, by nesting it under an existing element
  }
}
```

The `addEventListener()` method takes in two parameters: 1) The event name, and 2) The event listener function. 

Notice that the event listener function takes in one parameter (that we have named `evt`). This is the event object that is *automatically* passed to our event listener from the browser. This event object contains a bunch of information about the event that occured, including the element that triggered the event (`evt.target`). In the example able, we are also choosing to use the x-position of the mouse (`evt.x`), which is another piece of information available to us from the event object. You can read up more about all of the information stored in the event object [here](https://www.w3schools.com/jsref/obj_event.asp)

There are also some methods that can be called on the event object, if needed:

#### event.preventDefault()
Many user events will trigger some default action in the browser (even if we don't specify an event listener ourselves). Some events that have default behavior:
- When you submit a form, your browser sends an HTTP request based on the form's `method` to the url in the form's `action`.
- When you click on a hyperlink, the browser automatically navigates to the location of the link's href attribute.
- When you press spacebar on a page, it scrolls the page down

All of these default functionality for events that are handled by the **browser** can be prevented by calling `event.preventDefault()`. We can choose to do some other action in response to the event, or just ignore it entirely. 

Let's try this example:

First... add a bunch of new div elements using our button, and then try to hit the <spacebar> key. Notice that your page scrolls, because the browser had a default behavior for handling this particular event.
  
Next... let's add in an event listener to intercept this event, and block it's processing by the browser.

``` javascript
scripts.js

window.addEventListener("keydown", (evt) => {
  if (evt.code == "Space") {
    evt.preventDefault()
  }
})
```

Now... add a bunch of new div elements using our button, and then try to hit the <spacebar> key and see if your page still scrolls down!


#### event.stopPropagation()
Sometimes, you might have an element with event listeners attached to it, nested inside of another element with event listeners attached to it. Consider this example:

```html
<!-- index.html -->
  <div id="parent-div" onclick="sayHello(event)">
    <div id="one" class="alpha apple" onclick="sayHi(event)">
      This is the first div.
    </div>
    <div id="two" class="alpha avacado">
      This is the second div.
    </div>
    <div id="three" class="beta banana">
      This is the third div.
    </div>
  </div>
```

An important thing to notice in the code above is that we are passing an `event` object to our event listener. This is a reserved keyword object, that we have access to in our HTML file. We have to manually pass this value in, since we are calling our event listener ourselves in this case (as opposed to before when our event listener was autmatically called, and automatically passed an event object by the browser).
  
```javascript
// scripts.js

const sayHi = (evt) => {
  console.log("hi (inner)")
}

const sayHello = (evt) => {
  console.log("hello (outer)")
}
```

If we click on the first nested div element, notice that both "hi (inner)" and "hello (outer)" are printed out to the console. The click event is being processed by the inner div, and the outer div because they both have onclick event listeners. What if we wanted to prevent the outer div from processing the event? We can simply add `evt.stopPropagation()` to our `sayHi()` function:

```javascript
// scripts.js

const sayHi = (evt) => {
  evt.stopPropagation() // this will prevent this event from continuing up the DOM tree
  
  console.log("hi (inner)")
}

const sayHello = (evt) => {
  console.log("hello (outer)")
}
```

Notice how the behavior changes now when you click on the first nested div element. You should only see "hi (inner)" printed out to the console, when clicking on the first nested div element. Clicking on any of the other divs, however, continues to print out "hello (outer)"

To summarize the difference: `preventDefault()` prevents the browser from doing it's default behavior based on an event, whereas `stopPropagation()` prevents other elements in the DOM from processing an event.
  
  
### Working with HTML Forms
  
Forms are HTML elements used to collect user data and pass it on to somewhere else. To create a form, we use the `<form></form>` tag, and insert form controls inside of the form. Let's change our HTML file to use a form instead of just an input control:
  
```html
<!-- index.html -->
  
    <!-- in body -->
    <form onsubmit="handleFormSubmit(event)">
      <input id="input-name" name="name" placeholder="name"/>
      <br />
      <input id="favorite-color" name="favColor" placeholder="color"/>
      <br />
      <button type=""submit>Submit</button>
    </form>

    <div>
      <p id="output"></p>
    </div>
```
  
```javascript
const handleFormSubmit = (evt) => {
  evt.preventDefault() // this will prevent the default browser behavior (page refresh)

  const formData = new FormData(evt.target);
  const formProps = Object.fromEntries(formData);
  
  // print out all the field names and values
  for (let fieldName in formProps) {
    console.log(fieldName, formData.get(fieldName))
  }

  showGreeting(formData.get("name"))
  
  // // alternate way (without using FormData)
  
  // let nameElem = evt.target.elements[0]
  // console.log(nameElem.name, nameElem.value)
  // let favColorElem = evt.target.elements[1]
  // console.log(favColorElem.name, favColorElem.value)
  
  // showGreeting(nameElem.value)
}
  
  
const showGreeting = (name) => { // update our function to take in a parameter
  let greetingOutput = document.getElementById("output")
  if (greetingOutput) {
    greetingOutput.innerHTML = "Hello " + name + "!"
  }
}
```
  
Some things to notice from the code above... 
  - We are using a `<form>` element, which has an onsubmit event attribute. 
  - We have added `name` attributes for our form fields, so that we can identify the fields within the form (the `id` attribute is not referenced for form data).     - Our button within our form has a `type=submit` attribute, which triggers the submit event for the form. All form should have at least one element with a `submit` type.
  - We are using the aforementioned `preventDefault()` method to avoid the default behavior of a form submit event. Normally, our browser would refresh the page automatically. We don't want this behavior because this will refresh our javascript application.
  
Forms are generally used to send data to another location on the web (usually an external server for processing). For example, when we enter in our username and password information on a site login page, the form data is collected and sent to a server to process when we hit the 'login' button. 
  
  
## Assignments
- Read the [MDN Introduction to Events](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events) and work through it's [Simple Example DOM Events tutorial](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#a_simple_example).
- [DOM Manipulation](https://github.com/romeoplatoon/html-dom-manipulation)  
- [Guess A Number](https://github.com/romeoplatoon/html-number-guessing-game)
- Stretch Challenge: [Create a Static Webpage](https://github.com/romeoplatoon/html-static-webpage)

## Additional Resources
- [Eloquent Javascript: The DOM](https://eloquentjavascript.net/14_dom.html)
- [Excellent guide to DOM Event Bubbling & Capturing, Good Diagrams](https://javascript.info/bubbling-and-capturing)
- [MDN Event Reference](https://developer.mozilla.org/en-US/docs/Web/Events)


# HTTP and AJAX


## Topics Covered / Goals
**Core**
- Understand the basics of HTTP
  - web protocol built on top of TCP (guarantees packets are delivered in order)
  - request/response cycle
  - What does the structure of an HTTP request look like, and what is the purpose of the `body` and `header`?
  - What action verbs does HTTP use, and when should you use them? `GET`, `POST`, etc.
- Understand what an API is
- Learn to send AJAX requests using `axios`, a popular, modern HTTP client for javascript
- Learn some tools (other than the browser) for testing APIs


## Lesson
> There are strict rules about how applications can communicate with each other over the internet, known as a protocol. However, communication on the web is not defined by a single protocol, but by a stack of protocols, known as the OSI model.

### IP
> The first protocol you should be aware of is IP, Internet Protocol. IP is concerned with WHERE a server is located on the internet. This location is described with a number called an IP address, which is similar to a physical address. Most of the world currently uses the fourth version of the IP protocol (IPv4), in which an IP address is a series of 4 numbers, separated by periods, like '192.0.2.1'. Whenever you type a domain name into your browser's url bar, your browser has to convert that into an IP address to know where to send the request. This is done using the Domain Name System (DNS).

### TCP
> IP is only concerned with WHERE a server is, but not HOW to get there. TCP (transmission control protocol) provides reliable, ordered, and error-checked delivery of a stream of bytes between applications running on hosts communicating via an IP network. The reliability makes this protocol a little bit slower, since every single TCP connection actually requires multiple requests to initiate, known as a 3-way handshake. TCP was designed alongside IP, so they're often referred to together as TCP/IP. 

### HTTP
> TCP is only concerned with HOW data is transferred, but not WHAT data is transferred, or how the data is formatted. The format of our application data is determined by the HTTP protocol. 
- [HTTP Slides](https://docs.google.com/presentation/d/15Mq7xn5nQVDjShPOZd4cwVi807oQvNfLE3irJDrlgwU/edit#slide=id.p)

### APIs
> An API is an Application Programming Interface. An API is essentially a contract between two pieces of software that determines how they can interact with each other. For example, every library or framework you'll use has an API that describes what methods you can call from the library/framework, and what you can expect them to do. Today, we'll be using a JSON API that lets our front end request data from someone else's database. There are [many free, public APIs](https://github.com/public-apis/public-apis) that you might want to use.

### AJAX
> There are many ways to send an HTTP request, such as clicking a link, submitting a form, or just typing a url into your browser. However, most ways of sending HTTP requests from your browser will unload the page, and replace it entirely with the contents of the HTTP response. To build a more elegant, modern application, we need a way to send an HTTP request in the background without interrupting the user's experience. This technique is known as AJAX: 'asynchronous javascript and xml'. 'asynchronous javascript' just means that we're doing work with javascript in the background, while other processes continue. XML is a data type that can potentially be returned by an AJAX request. In modern applications, XML is not commonly used, but JSON (javascript object notation) is used instead. However, even though we typically get JSON, not XML, from AJAX requests, we still call this technique 'AJAX', because that sounds cool, and 'AJAJ' sounds weird. 

> This technique was first made possible in 1999 in Internet explorer, through an object that is now known as `XMLHttpRequest`, or XHR. XHR enabled developers to build many kinds of applications that wouldn't have been possible otherwise, although it was pretty awkward to work with. More recently, modern browsers have started supporting `fetch()`, which provides more convenient access to the same functionality. However, neither of these options is as powerful and convenient as some 3rd party AJAX tools. 

### Axios
> Axios is a popular, modern HTTP client for javascript. Let's try using Axios to make some requests to the pokemon API. 

### Promises from Axios
> When Axios performs a request, it takes a few hundred milliseconds to complete, but we wouldn't want our application to just do nothing while it waits. Instead, axios immediately returns a `promise` object, which lets us specify what we want to do once the request finishes. The promise object has two important methods: `.then()` accepts a callback function to specify what happens if the request succeeded, and the promise is 'resolved'. The promise also has a method called `.catch()`, which accepts a callback function to specify what happens if the request fails, and the promise is 'rejected'. It's also important to understand that `.then()` and `.catch()` also return promises, so these methods can be chained off of each other.

```javascript
axios.get('ttps://pokeapi.co/api/v2/pokemon/12/').then((response)=>{
    console.log(response)
}).catch((error)=>{
    console.log('no good: ', error)
})
```

### async/await
> Handling promises is an essential skill for an intermediate javascript developer. However, one downside to using promises is that if you're performing a series of asynchronous actions, your code will keep getting indented deeper and deeper. One way to work around this problem is by using async/await, which lets us write promise-based async code in a similar way to how we would write synchronous code. Any time you could call `.then()` on a promise, you can instead `await` that promise, so that your program will wait until the promise resolves, and then returns that value. You can only use `await` inside functions that are marked as `async`. 

```javascript
const getMon = async ()=>{
    const response = await axios.get("https://pokeapi.co/api/v2/pokemon/1/")
	const typeUrl = response.data.types[0].type.url
	console.log(typeUrl)
    const typeResponse = await axios.get(typeUrl)
    console.log(typeResponse)
}
getMon()
```

### Making our own promises
> Generally, when you need to perform an asynchronous action, whatever library you are using will create promises for you to use. However, sometimes we'll have to create our own. For example, `setTimeout` is an asynchronous function, but it doesn't return a promise. We can create our promise if we want to handle `setTimeout` using `.then()` and `.catch()`. 

```javascript
const myPromise = new Promise((resolve, reject) => {
    setTimeout(() => {
		resolve('foo');
    }, 300);
});
```




## External Resources
- [Axios docs](https://axios-http.com/docs/intro)
- [Postman docs](https://learning.postman.com/docs/getting-started/sending-the-first-request/)

## Assignments
- [Pokemon Theme Team](https://github.com/romeoplatoon/pokemon-theme-team)



# Simplest Django Server


## Topics Covered / Goals
- Learn to use virtual environments in python
- manage packages with pip
- create a new django project
- manage your application with `python manage.py`
- create simple route handlers 
- Understand how servers can receive data from clients (method type, headers, query string, url params, request body )
- Understand how servers send data back to clients (response body, headers, status code)

## Lesson

Django has a great tutorial, but it can be hard to understand all the pieces of it if you've never worked with servers before. 
In this demo, we'll build the simplest possible server with django that can accept requests from a browser and return HTML.

### Virtual Environments

Developers have a variety of projects they are working on at any given time, especially if you work for a consultancy. Given the nature of working on greenfield (i.e., brand new) projects and old projects at the same time, versions of software will be all over the place. Your greenfield project may use Python 3 and your client's older code base may use Python 2. How do you protect your computer against getting confused on which versions of software to use? How do you ensure that you have a clean environment to develop from each time? Enter *virtual environments*.

Virtual environments are containers that wrap around your project to ensure that whatever you install inside your virtual environment stays there / doesn't affect the rest of your computer. Think of it as a placemat at the dining table for babies. Those babies can drool and drop all the food they can on that placemat, but it doesn't affect the rest of your dining table. At the end of the meal, you can throw that placemat away if you wish.

> More specifically, when you set up python on your machine, it was installed to a particular location (check its location with `type python3`), and you also declared a location for that installation of python to store python modules that you install. Lastly, a variable in your system called the `PATH` was adjusted so that when you simply type `python` at the command line, it refers to that version of python you installed, wherever it was installed to. 

> When you create a virtual environment, you're installing another copy of python, with its own set of installed modules that are separate from other python modules you've installed previously. The virtual environment also includes an activation script, which adjusts your `PATH` so that when you type `python`, it refers to this new version of python instead. The activation script also defines a function called `deactivate()` that resets your `PATH` back to how it was before. As a convenience, the virtual environment also changes your shell prompt to include the name of the virtual environment, to help you avoid accidentally installing modules into the wrong virtual environment. 

Let's create a virtual environment whenever we work with Django so that it doesn't mess up the rest of our machine setups. The 3 commands that you need to remember:

```bash
# 1. Create your virtual environment
python -m venv <envname>

# 2. Start your virtual environment. Running the script with 'source' applies it to our current shell, instead of a subshell
source <envname>/bin/activate

# 3. Eject from your virtual environment (once you're done - this is run at the very end of development)
deactivate
```

### Installing Django
> Up until now, you may have seen a few built-in python modules used, both in python scripts (re, random, math) and at the command line (http, venv). Now, we're going to use `pip` to install django, a new python module, that we will use both from the command line, and in our scripts. 

```bash
pip install django
```

### Starting a New Django Project

> Now that we've installed Django in our project, let's invoke it at the command line and see what it does. 

```bash
python -m django
```

> You should see a menu of options. You'll learn to use several of these options, but we won't need most of them. Don't worry about the warning about django-settings. We'll fix that in a second. Since we don't have a django project yet, let's start by creating one. Let's imagine we're creating an application for a school, so we'll name our project `school`. 


```bash
python -m django startproject school
```

> When we start our project, django will create a folder with the name of the project. Inside of this project folder, django will create a subfolder for the main module of the project, which has the same name.  Tomorrow, you'll learn about proper project organization and make other modules, but today we'll just be working with the main module. 

> In addition to creating our main module, starting our django project created a file called `manage.py`. Running this file is almost the same as running `python -m django`, except using the manage.py file also loads some settings specific to this project.

> Before we forget, it's important that we record all of the dependencies used in this project, starting with Django. We can do this by using the command `pip freeze`, and redirecting the output to a file.

```bash
pip freeze > requirements.txt
```

> Now when we push this project to github, if another developer pulls it down, they won't receive Django with it. However, they can use the requirements.txt file to install all of the modules used for this project with `pip install -r requirements.txt`.

### Start the dev server
> Django comes with its own built-in webserver. We can't use this to deploy our application, but it'll be useful while we develop on our local machines, because it automatically restarts every time we edit a python file. 

```bash
python manage.py runserver
```

> After running this command, your terminal will tell you what port the app is running on, so you can visit it in your browser. At first, you'll just see a generic welcome message, because we haven't defined any routes. So let's define some routes.  

### Handling requests in urls.py
> Routes for our application can be defined in urls.py. There's only one thing in here by default, a route handler for `/admin`. Since our server is running, we can actually check out the admin login page in our browser, but it won't be very useful to us yet, since we don't have a database set up. 

> In a well organized django project, this file would not have any actual routes defined. Instead, it would only contain references to other files which contain route definitions, like how the table of contents of a book contains only chapter titles and page numbers. To keep this demo as simple as possible, we'll just define a route handler for our homepage right in this file.

> In some ways, handling HTTP requests to our back end is similar to handling user events on the front end. On the front end, we define an event handler by choosing the type of event, like `click` or `keypress`, and writing a function that receives the event object and reacts to the user's action. To handle an HTTP request, we write a function that handles a certain type of HTTP request (GET in today's demo), and takes in a request object. One big difference is that front end event handlers do not need to return a value, whereas server side route handlers must always return a value for the response that is sent to the client. If you don't return anything, the client will be waiting until the request times out. 
```python
from django.http import HttpResponse

def rootRouteHandler(request):
    response = HttpResponse("<h1>Welcome to the internet</h1>") # every request must receive one response
    print('=-=-=-=-=-=-=-=')
    print(dir(request))
    print('--------------')
    print(dir(response))
    print('=-=-=-=-=-=-=-=')
    return response


def anotherRouteHandler(request):
    response = HttpResponse("<marquee>We can make as many routes as we want</marquee>")
    response.status_code = 418

    # django automatically puts query string variables into a dictionary
    print(request.GET.get('format'))

    return response 

def withParams(request, format='h1'):
    print(format)
    return HttpResponse(f"<{format}>Hello Django</{format}")

urlpatterns = [
    path('admin/', admin.site.urls), # default admin routes, provided for free by django
    path('', rootRouteHandler),
    path('another-route/', anotherRouteHandler),
    path('another-route/<str:format>', withParams),

]
```

- requests have a method, route, headers, and maybe a body
- responses have headers, a body, and a status code

## Assignments
- [Hello Django](https://github.com/romeoplatoon/hello-django)


# Django Projects and Apps

## Topics Covered / Goals
- For the reminder of this course, and possibly in future projects, you will be using Django to handle the backend (and sometimes the frontend) of any web apps you build.
- Respond to clients by rendering templates instead of sending raw HTML
- Learn how to handle static files using Django, to add CSS, JS, and images

## Lesson

> Today, we're going to get started with using Django as a full stack framework, handling both the front and back end of our application. Later, we'll learn how to run Django just as an API (backend) layer and use it in conjunction with React on the frontend.

### Start Our Project

> This tutorial is largely based off of [the official docs](https://docs.djangoproject.com/en/3.1/intro/tutorial01/). A few things have been removed to account for our current level of knowledge. Notably, the app we build today won't have a proper database. 

> First things first for any new Django project, we need a new virtual environment to keep our dependencies isolated to this project and the versions we build it with.

> **NOTE**: This will become a repetive workflow for setting up a new project.


1. Create a Python Virtual Environment: `python -m venv ~/venvs/polls_env`
2. Activate your `venv`:
  On Mac/Linux 
  > `source ~/venvs/polls_env/bin/activate`

  On Windows 
  > `~\venvs\polls_venv\Scripts\activate`

3. Install `django` into your environment: `pip install django`
4. Create a Django project called `polls_project`: `python -m django startproject polls_project `

> We've got the beginnings of our Django app. This creates a bunch of files in our project directory, but we didn't talk about most of them yesterday. Let's take a moment to check them out and try to understand them better.  Here's the breakdown of each file with explanations from the Django documentation and our explanation from us on how we interpret the Django documentation:

- `manage.py`
  - *Docs say*: A command-line utility that lets you interact with this Django project in various ways
  - *In our words*: It's code that allows you to use your terminal to interact with your app. This includes running migrations, interacting with the console, and starting the server. 
- `mysite/__init__.py`
  - *Docs say*: An empty file that tells Python that this directory should be considered a Python package
  - *In our words*: It's a file with dunder (double underscores) in the filename that Python needs in order to run this properly
- `mysite/settings.py`
  - *Docs say*: Settings/configuration for this Django project
  - *In our words*: This is the file that will tell Django things like which database to use, what apps are installed, etc.
- `mysite/urls.py`
  - *Docs say*: The URL declarations for this Django project; a "table of contents" of your Django-powered site. You can read more about URLs in URL dispatcher.
  - *In our words*: This is the file where you declare (write) all your routes. Think of this as the phone operator of an organization. You call the operator and tell them what you want. Then, the operator directs to you to where you need to go
- `mysite/wsgi.py`
  - *Docs say*: An entry-point for WSGI-compatible web servers to serve your project
  - *In our words*: It's what we need to fire the app up on different types of servers. You won't have to edit this file. 

*Let's fire up the server:* `python manage.py runserver`. Next, visit http://localhost:8000 and see what you get!

*Don't worry about any unapplied migrations yet. We're not using our database just yet.*

### Projects and Apps
> Django projects are split into many apps (i.e., a project has many apps). Imagine a new _project_ at Amazon where they are selling lots of space on the Moon. That _project_ requires a bunch of different _apps_ in order to run. For example, there might be a billing _app_ to collect money from individuals, a searching _app_ for people to look up lots, a VIP _app_ where they target VIPs, etc. Today, our project will just start with a `polls_app` app.

```bash
$ python manage.py startapp polls_app
```

> A quick sidebar - we ran `startproject` earlier and we are now running `startapp`. The difference between these two is that a `project` consists of many `apps`. An `app` can belong to many `projects`.

Next, we need to add the `polls_app` app to our `settings.py` file.
```python
## mysite/settings.py

INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'polls_app',
]
```

In `polls_app/views.py`, let's put the following code inside:
```python
from django.shortcuts import render
from django.http import HttpResponse

def index(request):
    return HttpResponse("Hello, world. You're at the polls index.")
```

We created a request method called `index` inside the `views` file. Next, we need to register this page in `polls_app/urls.py` *(you need to create this file)*. Create that file and paste the following code in there:

```python
from django.urls import path

from . import views

urlpatterns = [
    path('', views.index),
]
```

Finally, we will connect our recently created `urls.py` to `polls_project/urls.py`. *Delete the code that is already in the `urls.py` file and replace it with the code below*:

```python
from django.urls import include, path

urlpatterns = [
    path('polls/', include('polls_app.urls')),
]
```

Whoa, a lot of code just now - let's break it down. We started off earlier with creating a project called `polls_project`. Projects can consist of many apps. We then created a `polls_app` app which is at the same level as `polls_project`. Whenever anyone hits any route (aka endpoint) with `/polls`, the `polls_project/urls.py` file will direct them to the `polls_app` app, specifically the `urls` file. From there, it'll send the user to `index` method in `views.py`.

In `polls_app/urls.py`, let's break down the `path` method that we imported. `path` takes in 4 arguments. 2 of them are required and 2 of them are optional. In order, they are `route`, `view`, and `kwargs` / `name`. `route` is the path that you enter in the URL. `view` is the file that handles the logic behind what shows up on your screen. `views.index` means "Look at the index method in the `views.py` file."

Visit http://localhost:8000/polls to see what you get!

### Additional Views

We're going to add 3 new routes:
- `/polls/:question_id` (view a particular question)
- `/polls/:question_id/results` (view the results of that particular question)
- `/polls/:question_id/vote` (vote on the choices on that question)

In `polls_app/urls.py`, let's register these routes and their corresponding methods:
```python
from django.urls import path
from . import views

urlpatterns = [
    # ex: /polls/
    path('', views.index),
    # ex: /polls/5/
    path('<int:question_id>/', views.detail),
    # ex: /polls/5/results/
    path('<int:question_id>/results/', views.results),
    # ex: /polls/5/vote/
    path('<int:question_id>/vote/', views.vote),
]
```

Next, create the following methods in `polls_app/views.py`:
```python
from django.http import HttpResponse
from django.shortcuts import render

def index(request):
    return HttpResponse("Hello, world. You're at the polls index.")

def detail(request, question_id):
    return HttpResponse(f"You're looking at question {question_id}.")

def results(request, question_id):
    return HttpResponse(f"You're looking at the results of question {question_id}.")

def vote(request, question_id):
    return HttpResponse(f"You're voting on question {question_id}.")
```
Visit those routes with `question_id` as 1 and see what you get!

### Data

We haven't learned about databases yet, so for today's demo we'll simulate having a database by using a list of dictionaries. Add the following data to `views.py`:

```python
latest_question_list = [
    {
        'id' : 1,
        'question_text': 'whats up',
        'pub_date':'2022-01-04',
        'choices': [
            {
                'id':1,
                'choice_text':'not much',
                'votes': 0,
            },
            {
                'id':2,
                'choice_text':'the sky',
                'votes': 0,
            },
        ]
    },
    {
        'id' : 2,
        'question_text': 'whats new',
        'pub_date':'2022-02-09',
        'choices': [
            {
                'id':1,
                'choice_text':'not much',
                'votes': 0,
            },
            {
                'id':2,
                'choice_text':'the sky',
                'votes': 0,
            },
        ]
    },
]
```

### Server-side rendering 
> Most web applications need to render dynamic content. The web wouldn't be very interesting if every page was the same for every visitor, every time they visited. Generally, when a user sends a request to a web application, the application needs to get necessary data from various sources such as APIs or a database, and then insert that data into a template, which gets rendered into HTML. However, there is an important decision to be made about when and where HTML gets rendered.
- One option, which we'll be exploring today, is server-side rendering.
    - This is the most traditional and simplest way to make a dynamic webpage, since you don't need a front-end framework like React.
    - Server-side rendering is generally faster for the initial page load, since the client only has to download the initial HTML document before they can start seeing content. It might still take some time to load scripts and below-the-fold images, but at least the user can read your content as soon as the page loads. First impressions are important. Subsequent page loads may be a little faster, if the user has cached files that are used on all pages, but the page still needs to unload before new content can be rendered.
- Another option, which we'll be exploring later with React, is client-side rendering. 
- You don't have to choose one or the other! An application can use server-side and client-side rendering on different pages. For example, you might choose server-side rendering for parts of your application that don't require a login, like the login/signup pages, home page, about, contact, etc. Then, once a user logs in, all content that requires authentication is delivered in a SPA. 
- Some applications perform both server-side rendering and client-side rendering at the same time. This combines the benefits of a fast initial load with fast page transitions, as well as interactive front-end content. The downside is that this is the most complex way to render content. However, there are frameworks that can make this easier, if this is what you need to do (e.g. Next.js, Nuxt.js)


We want to create templates with Django's templating system, where we can pass in Python objects of data to be rendered into HTML. Under your `polls_app` directory, create a `templates` folder, and under that directory, create another `polls_app` folder, and under that directory create an `index.html` file:

```html
<!-- polls/templates/polls/index.html -->
<h1> All Polls </h1>
{% if latest_question_list %}
  <ul>
    {% for question in latest_question_list %}
      <li><a href="/polls/{{ question.id }}/">{{ question.question_text }}</a></li>
    {% endfor %}
  </ul>
{% else %}
  <p>No polls are available.</p>
{% endif %}
```

Django templates have their own syntax, and it lets us insert Python into our HTML. Here are three of the basic uses:

```html
{% code blocks %}
{{ variable interpolation }}
{# comments #}
```

Next, we'll update the def `index` view in `polls_app/views.py` to send a dictionary to our new template. The method `render()` requires a dictionary and is used to send `latest_question_list` to be displayed by our markup at `polls_app/index.html`:

```python
from django.shortcuts import render
from django.http import HttpResponse

def index(request):
    data = { 'latest_question_list': latest_question_list }
    return render(request, 'polls/index.html', data)

def detail(request, question_id):
    return HttpResponse(f"You're looking at question {question_id}.")

def results(request, question_id):
    return HttpResponse(f"You're looking at the results of question {question_id}.")

def vote(request, question_id):
    return HttpResponse(f"You're voting on question {question_id}.")
```


If you were to visit http://localhost:8000/polls, you'd see all of the questions we've written thus far. Let's move onto the detail function in our `polls_app/views.py` file which will be `/polls/1` page:

```python
from django.shortcuts import render
from django.http import HttpResponse

def index(request):
    data = { 'latest_question_list': latest_question_list }
    return render(request, 'polls/index.html', data)

def detail(request, question_id):
    question = latest_question_list[question_id-1]
    data = { 'question': question }
    return render(request, 'polls_app/detail.html', data)

def results(request, question_id):
    return HttpResponse(f"You're looking at the results of question {question_id}.")

def vote(request, question_id):
    return HttpResponse(f"You're voting on question {question_id}.")
```

In our **`polls_app/templates/polls_app`** directory create a file called `detail.html`:

```html
<h1> Details about Question {{ question.id }} </h1>
<h2> {{ question.question_text }} </h2>
<ul>
  {% for choice in question.choices %}
    <li>{{ choice.choice_text }}</li>
  {% endfor %}
</ul>
```


**Forms in Django**

Let's create a form so that people can vote on a question. In `polls/templates/polls/detail.html`, put the following code:

```html
<h1> Details about Question {{ question.id }} </h1>
<h2> {{ question.question_text }} </h2>

<form action="/polls/{{ question.id }}/vote" method="POST">
  {% csrf_token %}
  {% for choice in question.choices %}
    <input type="radio" name="choice" id="choice{{ forloop.counter }}" value="{{ choice.id }}">
    <label for="choice{{ forloop.counter }}">{{ choice.choice_text }}</label><br>
  {% endfor %}
  <input type="submit" value="Vote">
</form>
```
There are a few things to note with this form:
1. We are explicitly declaring that the method for our form is `POST` because we are _sending_ information
2. We're creating a bunch of radio button options in one loop to account for each `choice` for our `question`. Each radio button has an unique `id` using `forloop.counter` (comes for free with Python)
3. The `<label>` has a `for` attribute that refers to the `id` of the `<input>`. This lets a user select a radio button by clicking on its associated label. This is very important for accessibility, especially on mobile devices. 

If you refresh your page (`/polls/1`), you'll see your choices come on the screen. Submit it and you'll be directed to a page that simply says "You are voting on question 1". That's because we haven't accounted for the `POST` request in our code yet. If you look in your `urls.py`, you'll see that we defined the route but the action in `views.py` isn't really doing anything yet. We need to fix that up!

```python
## polls/views.py
from django.http import HttpResponse, HttpResponseRedirect
from django.shortcuts import render


def index(request):
    data = { 'latest_question_list': latest_question_list }
    return render(request, 'polls_app/index.html', data)

def detail(request, question_id):
    question = latest_question_list[question_id-1]
    return render(request, 'polls_app/detail.html', {'question': question})

def results(request, question_id):
    return HttpResponse(f"You're looking at the results of question {question_id}.")

def vote(request, question_id):
    question = latest_question_list[question_id-1]
    selected_choice = question['choices'][int(request.POST['choice'])-1]
    selected_choice['votes'] += 1
    
    # redirect the user to a GET route, so they don't resubmit their vote if they refresh the page
    return HttpResponseRedirect(f'/polls/{question_id}/results')
```


When we vote, we get redirected to the results page which just has some text in it. Let's alter that:
```python
## polls/views.py
def results(request, question_id):
    question = latest_question_list[question_id-1]
    return render(request, 'polls_app/results.html', {'question': question})
```
`results` is telling us to create a `results.html` file in our `polls_app/templates/polls_app` directory:
```html
<h1> Details about Question {{ question.id }} </h1>
<h2> {{ question.question_text }} </h2>

<ul>
  {% for choice in question.choices %}
    <li>{{ choice.choice_text }} -- {{ choice.votes }} vote{{ choice.votes|pluralize }}</li>
  {% endfor %}
</ul>

<a href="/polls/{{ question.id }}/detail">Vote again?</a>
```



### Serving Static Files
> Our app is functional, but not very pretty. In order to style our site with CSS, we need to configure django to serve static files.

> Create a folder called `static` in the root of the project, right next to the `manage.py`. Inside of that, create a folder called `css`, and create a `main.css` inside of there.

> In your `settings.py`, tell django what URL prefix clients should use to request static files, and also specify where in your server the static files are located.

```python
STATIC_URL = 'static/'

STATICFILES_DIRS = [
    BASE_DIR / "static",
]
```

```html
<html>
  <head>
    <title>Polls</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/css/main.css">
  </head>
```

### Intermediate Templating

#### Includes
> `include` lets us insert one template file into another. The included file would be only a part of an HTML file, called a partial. The file it is included into may or may not be a complete HTML file. This is useful if you have a component that is repeated in many different pages, or in different places in the same page. Including a file can also be useful if the included file is very large or complex, so that you don't have to look at the whole thing when you're reading the template that contains it. 

```html
<!-- subscribe.html -->
<button type="button" onclick="alert('thanks for subscribing!')">Please Subscribe!</button>
```

```html
<div>
	{% include 'blog/subscribe.html' %}
</div>
```

#### Extends
> Sometimes you'll have elements that are repeated on every page, in the same location. These repeated elements together can be considered your 'layout'. In the layout, we define places where dynamic content will be inserted, called 'blocks'. We can define parts of an HTML page with matching 'blocks' and insert them into the layout using `extends`. This is useful for navbars and footers.

```html
<!-- layout.html -->
<html>
    <head>
        {% block title %}
        <title>Welcome to my blog!</title>
        {% endblock %}
        <link rel="stylesheet" href="/static/css/main.css">
    </head>
    <body>
        <h1>Polls</h1>
        {% block content %}{% endblock %}
    </body>
</html>
```

```html
{% extends "layout.html" %}

{% block title %}
<title>Polls</title>
{% endblock %}

{% block content %}
<h1> All Polls </h1>
{% if latest_question_list %}
  <ul>
    {% for question in latest_question_list %}
      <li><a href="/polls/{{ question.id }}/">{{ question.question_text }}</a></li>
    {% endfor %}
  </ul>
{% else %}
  <p>No polls are available.</p>
{% endif %}
{% endblock %}
```


## Assignments
- [Django School Roster](https://github.com/romeoplatoon/django-school-roster)



# Backend APIs

## Topics Covered / Goals
- Using APIs from the backend
    - Many APIs cannot be used easily like we did in week 4 (front end -> api -> front end), for security reasons
    - Send requests from front end -> back end -> api > back end -> front end

## Lesson

> One reason why we might need to use an API from the back end is because some APIs are inaccessible from the front end, due to the Same Origin Policy (SOP) and lack of Cross Origin Resource Sharing (CORS). This is intended to be a security feature, but it can sometimes be frustrating to work around. 

> Another reason is that many APIs require users to be authenticated to use the API, so you need to send the request from the back end, where you can keep your credentials secret.

> The process for acquiring and using an API key may be different for different APIs, so be sure to read the documentation. The API Key is a unique key associated with your developer account for billing/usage purposes. You will often have public and/or private API keys - the public key can be used on the front end, since it's not sensitive or private. The private key must be stored securely on the server (using env variables, not in a git repo). If you are getting charged money for using an API, make sure you protect your private key. If anyone gets a hold of your private key, they can impersonate you and you can get charged boatloads of money. Public keys are public - don't worry about protecting these.


> Today, we'll be using the noun project API, but every API is different. [Read the documentation](http://api.thenounproject.com/getting_started.html) in order to know how you're supposed to authenticate and send requests.

> After reading the docs, I want to get an API key. After creating an account, we need to create an 'app', and then we can create a set of keys associated with that app. Before we write any code, we can test our keys in the [api explorer](https://api.thenounproject.com/explorer)

> Now that we have some idea how the API works, let's build a django project that uses it. The first new thing we'll need for this project is a library that will help us send requests, called `requests`. It's similar to axios, except it's used on the back end with python.

```bash
pip install requests
pip install requests_oauthlib
```

```python
import requests
from requests_oauthlib import OAuth1

# public key and private key
auth = OAuth1("*******************", "**********************")
endpoint = "http://api.thenounproject.com/icon/1"

response = requests.get(endpoint, auth=auth)
responseJSON = response.json()
```



> There's a lot of content here! In the browser, it was easier to dig into large data structures, but it's not quite as easy to read large data structures in python due to how they print in the terminal. I'm going to use a built-in python module, pprint (pretty print) that'll help me read the responses from the API. 

```python
import pprint

# only go 2 levels deep, so we get a general idea of the response without having to look at the whole thing
pp = pprint.PrettyPrinter(indent=2, depth=2)

response = requests.get(endpoint, auth=auth)
responseJSON = response.json()
pp.pprint(responseJSON)
```

> Now that we can get a response from the API, let's use that data in a template that we send to the client. 

> There's one last problem we need to solve before I commit this in github. Currently, my private key is visible in the code, so if I pushed it up to github, other people might steal my credentials. We need to use environment variables, which are not committed in git, to supply credentials to our app. We could use actual env variables in BASH, but it's common practice to use a .env file, which looks a little like this:

```bash
# my .env file
env=prod
apikey=******
secretkey=*****
```

 To help us read it, we'll use a python package called `python-dotenv`.

```bash
pip install python-dotenv
```

```python
from dotenv import load_dotenv
import os

load_dotenv()  # take environment variables from .env.
print(os.environ['apikey'])

```

## Assignments
- [Django Pokemon Theme Team](https://github.com/romeoplatoon/django-pokemon-theme-team)
- [API Show and Tell](https://github.com/romeoplatoon/API-show-and-tell)
# Into to Databases and SQL


## Topics Covered / Goals
- Understand the need for persistent data
- Explain the structure of a relational database
- Install and manage postgreSQL on your local machine
- Query a database using SQL commands

## Lesson

### Persistence
> This week we're going to focus on writing programs that save their output by reading from and writing to a Relational Database Management System (RDBMS). You might hear this type of database called a "SQL database", after the language (Structured Query Language) that's commonly used to query a relational database.

### Why Use a Database?
> Before we just jump into a new technology we should pause and ask ourselves if we have a simpler option available? One option we always have available is reading & writing from a text or JSON file. Let's imagine storing a school's database of students in text files. We could store one file per student, naming each file with the student's school id number:

```
data/
  321-531.json
  934-894.json
  947-189.json
```

Each file might contain the student's entire school record:

```json
{
  "first_name": "Meghan",
  "last_name": "Remy",
  "birthdate": "09/13/87",
  "address": {
    "line_1": "234 Maple St.",
    "city": "Chicago",
    "state": "IL",
    "zip": "60657"
  },
  "classes": [
    "CS 101",
    "HIST 107",
    "SPAN 210",
    "PHYS 218",
    "ART 118"
  ]
}
```

If the only use case for the school database was retrieving a student's record by their school id, this persistence design might be exactly what we need. In fact the entire lookup program could be written as such:

```python
import 'json'

print("** WELCOME TO THE ACME SCHOOL DATABASE **")

# get student ID from user input
id = raw_input('Enter a student id: ')

# open the student's data file
filename = "data".join("#{id[0..3]}-#{id[3..6]}.json")
student_data = json.loads(open(filename, 'r'))

# print student's data
print(f"{student_data['first_name']} {student_data['last_name']}")
print(f"Birthdate: {student_data["birthdate"]}")

address = student_data["address"]:
print("Mailing Address")
print(f"{address['line_1']}")
print(f"{address['city']}, {address['state']}")
print(f"{address['zip']}")

print("Classes")
for class_name in student_data["classes"]:
    print(f"{class_name}")
```

But consider how we'd have to modify our program to support these additional use cases:

- Finding a student record by name instead of id number
- Listing all the students enrolled in a particular course
- Finding the number of students whose birthday is in the next month

You should be realizing that our persistence approach of one file per student isn't very flexible. It's a great fit for some use cases and cumbersome fit for others. These design pains were felt almost as soon as software developers began to solve real world problems with software. They found a hierarchical, file focused approach to persistence limiting.

You might have also heard of NoSQL databases. These are generally schema-less databases that don't speak SQL. Don't get to thinking one type of database is better than another, there's a time & place for each type of database.

### A Relational Approach

The solution proposed in 1970 by E.F. Codd in his paper ["A Relational Model of Data for Large Shared Data Banks"](http://www.seas.upenn.edu/~zives/03f/cis550/codd.pdf) was the genesis of what we consider an RDBMS today. You might read the paper if you're feeling extra curious, but if not, here are some choice quotes from the abstract:

> Future users of large data banks must be protected from having to know how the data is organized in the machine (the internal representation).

Translation: We need some flexible persistence mechanism that insulates users (and our code) from exactly how the data is stored.

> Activities of users at terminals and most application programs should remain unaffected when the internal representation of data is changed and even when some aspects of the external representation are changed. Changes in data representation will often be needed as a result of changes in query, update, and report traffic and natural growth in the types of stored information.

> Existing noninferential, formatted data systems provide users with tree-structured files or slightly more general network models of the data. In Section 1, inadequacies of these models are discussed.

Translation: Existing hierarchical tree approaches to persisting & organizing data aren't adequate.

The relational approach to our student record system means we'll be storing our data in tables with columns & rows. Each table will store a different type of record. We'd likely design our schema of tables like so:

**students** |
--- |
id |
first_name |
last_name |
birthdate |
address_id |

**addresses** |
--- |
line_1 |
city |
state |
zipcode |

**classes** |
--- |
id |
name |
credits |

**enrollments** |
--- |
id |
student_id |
class_id |
grade |

In contrast with our earlier hierarchical approach, an RDBMS approach is flat. While there are connections between rows in different tables (these are called foreign keys), there isn't a fixed final form. We're able to retrieve records from one or more tables, mixing the data to fit the question we're trying to answer.

By separating our records into different tables that only contain the fields for a particular type of record, we can avoid committing to any single structure. This flexibility is one of the key features of an RDBMS.

In an RDBMS with our new schema we can support the use cases we couldn't with our file based approach. Here are the solutions in SQL:

- Find a student record by name instead of id number

```sql
SELECT * FROM students WHERE last_name = 'Garvis';
```

- List all the students enrolled in a particular course

```sql
SELECT * FROM students LEFT JOIN enrollments ON students.id = student_id WHERE class_id = 4;
```

- Find the number of students whose birthday is in the next month

```sql
SELECT count(*) FROM STUDENTS WHERE birthdate >= 2017/01/01 AND birthdate <= 2017/01/30;
```

### Additional RDBMS Benefits
> A modern RDBMS (Postgres, MySql, MS SQL, Oracle, etc) can do more than just store our data. Additional benefits include:

- Scaling. A Modern database server can allow multiple users to query & update records at the same time so our programs can scale. Additionally, multiple individual database servers can be grouped together into a cluster, which allows even more people to query our data simultaneously.
- Data Validation. They can also validate records, preventing incomplete or incorrect data from entering a system. For example, if `birthdate` is a required column, the database won't let us `INSERT` a row in the `students` table without a value for `birthdate`.
- Data Integrity. With features like transactions & locking, we can ensure that critical updates like debiting one bank account only succeeds when crediting another also succeeds.
- Filtering & Searching. Things we take for granted today like only returning records that match a certain criteria or summing a particular column are all standard features of database servers.

### SQL Syntax Basics
> Now that we understand the problem that a relational database is intended to solve, let's take a quick look at the [basics of SQL syntax](https://docs.google.com/presentation/d/1_bzAJyf6sQBI2BGMhv2RbAvbCaeL3_4jbt1ZQgcFR14/edit#slide=id.p).

## External Resources
- [psql guide](https://www.postgresguide.com/utilities/psql/)

## Assignments
- [SQL Basics](https://github.com/romeoplatoon/sql-basics)
- Read [SQL Queries](https://github.com/romeoplatoon/curriculum/blob/main/page-resources/sql-queries.md)
- [SQL Queries](https://github.com/romeoplatoon/sql-queries)




# Hashrocket SQL Workshop

## Topics Covered / Goals
- Understand the need for persistent data
- Explain the structure of a relational database
- Query a database using SQL commands

## Lesson
- [Slides](https://docs.google.com/a/natedelage.com/presentation/d/1834tfN6g9gvl2t0JDQY2RPMCIAnvN08Wrd-bO-usruQ/edit?usp=sharing)

**Persistence**

How else might we make use of a relational database? Consider a firm that makes software for agriculture. Their clients want an application that keeps track of which employee is tending to which field, and how much they harvest. What tables would we need? What rows make sense for each table?

**employees** |
---|
id |
first_name |
last_name |
salary |

**fields** |
---|
id |
latitude |
longitude |
crop_type |
current_status |

**harvests** |
---|
id |
employee_id |
field_id |
total_yield |

In this case, the `harvests` table acts as a join table between employees and fields. You can use it to find out which fields an employee is harvesting with a simple query:

```sql
SELECT * FROM fields LEFT JOIN harvests ON fields.id = field_id WHERE employee_id = 12;
```

Harvests also has data in its own right, so we can retrieve every harvest whose total yield is less than 10:
```sql
SELECT * FROM harvests WHERE total_yield < 10;
```

We could even get the sum total of an employee's harvests:
```SQL
SELECT SUM(total_yield) FROM harvests WHERE employee_id = 3;
```

## Assignments
- [SQL Zoo](http://sqlzoo.net/) 




# Constraints and Relationships


## Topics Covered / Goals
- Database Constraints
- Database Relationships
- Database Schema Design

## Lesson

The larger your application, the more tables you will have, and the more ways they will intersect. Database schema design is especially important for fullstack applications. Today, we'll talk about types of constraints you can add to database tables, types of relationships you can create between database tables, and how to put it all together to create a database schema design that works for our application needs. 

### Constraints

A database constraint is effectively a rule (or limitation) that we add to a column or multiple columns for a table. These help us create proper relationships without worrying about invalid data. There are a few types of constraints that we can add (see: [constraints](https://www.postgresql.org/docs/14/ddl-constraints.html)) to our tables, but we're going to focus on these three:

- Primary Key (PK)
  - Establishes the main (i.e. primary) unique identification column(s) for a table's records
  - Every table in a relational database should have a PK
  - PK column values can't be NULL

```sql
CREATE TABLE professors (
  id serial PRIMARY KEY,
  ...
);
```

- Foreign Key (FK)
  - Establishes column(s) whose values references (i.e. matches) a PK in another table (common), or even in the same table (rare)
  - FK column values can be NULL ("orphaned record")

```sql
CREATE TABLE courses (
  ...
  professor_id integer REFERENCES professors (id),
);
```

...or...

```sql
CREATE TABLE courses (
  ...
  professor_id integer
);

ALTER TABLE courses
ADD CONSTRAINT fk_course_professors
FOREIGN KEY (professor_id) 
REFERENCES professors (id);
```

- Unique Key (UQ) 
  - Establishes column(s) whose values must be unique across all records 
  - UQ column values can be NULL

```sql
CREATE TABLE lockers (
  ...
  user_id integer UNIQUE,
);
```


### Relationships

Entities (i.e. tables) in our database can have one of three main relationships with one another:
- One-to-One
  - A relationship where AT MOST one record from Table-A can ever be referenced by a record from Table-B
  - This is usually a rare relationship to find in most database models
  - This is achieved in one of two ways:
    - A primary key + foreign key
    - A foreign key + unique key   
- One-To-Many
  - A relationship where one record from Table-A may be referenced by one or more records from Table-B
  - This is achieved by creating a foreign key on a column in Table-B, to reference the PK in Table-A
- Many-To-Many
  - A relationship where a record from Table-A may be associated with one or more records from Table-B, and a record from Table-B may be associated with one or more records from Table-A
  - This is achieved by creating a join table (a.k.a. a through table)

### Database Schema Design

Let's use Facebook as a simple example to understand how to create a database schema that satisfies our needs, and incorporates using some of the constraints and relationships we talked about above. We're going to try to model the concept of having users who can write posts, write comments, or react to posts on Facebook. Here are the main tables we would need to create:


**user_accounts** |
---|
id |
username |
password |
last_login_date |


**user_profiles** |
---|
id |
user_id |
profile_photo_url |
about_me |
personal_quote |

**posts** |
---|
id |
content |
user_id |

**comments** |
---|
id |
content |
user_id |
post_id |

**reaction_types**
---|
id |
type |


Now let's talk about some relationships that we'd want to establish here between our tables...

**What is the relationship between `user_accounts` and `user_profiles`?**

...Can a user have more than one profile? **No.**  
...Can a profile have more than one user? **No.**  

This is a one-to-one relationship!

- *Solution:* Create a FK + UQ constraint for column `user_id` in table `user_profiles`

**What is the relationship between `user_accounts` and `posts`?**

...Can a user create more than one post? **Yes.**  
...Can a post be created by more than one user? **No.**  

This is a one-to-many relationship!

- *Solution:* Create a FK constraint for column-`user_id` in table-`posts`

**What is the relationship between `posts` and `reaction_types`?**

...Can a post have more than one reaction (i.e. "LIKE")? **Yes.**  
...Can a reaction ("LIKE") be made to more than posts? **Yes.**  

This is a many-to-many relationship!

- *Solution:* Create a new join table (using FKs) between table-`posts` and table-`reaction_types`, called table-`post_reactions`:

**post_reactions**
---|
id |
post_id |
reaction_id |
user_id |

In this new table, column-`post_id` would have a FK to table-`posts`, column-`reaction_id` would have a FK to table-`reaction_types`, and colunm-`user_id` would have a FK to table-`user_accounts`. 

Additionally, we may want to create a UQ for column-`post_id` + column-`user_id` because the same user is not allowed to have multiple reactions to the same post. 

## Assignments
- [Schema Design](https://github.com/romeoplatoon/sql-schema-design)
- [Schema Script](https://github.com/romeoplatoon/sql-schema-script)
- [Schema Modifications](https://github.com/romeoplatoon/sql-schema-modifications)


# SQL Review Day


### SQL Queries

We use SQL commands to interact with our data in our database tables. 

- SELECT
  - Used to extract data records from a table
  
  ```sql
  -- retrieve all students whose first name begins with the letter 'A'
  SELECT students.first_name, students.last_name -- sepficy the fields to display in the result
  FROM students -- specify which table to search
  WHERE students.first_name ILIKE 'A%'; --specify the condition our to-be-retrieved records much satisfy
  ```

- INSERT
  - Used to insert data records into a table
  
  ```sql
  -- insert a few new students
  INSERT INTO students (first_name, last_name, birth_date, locker_id) --specify which fields to add values into
  VALUES --specify the values of each new record (value order must match the field order listed above)
    ('Anna', 'Abrams', '2005-05-05', 2),
    ('Biil', 'Brooks', '2006-06-06', 4),
    ('Cassie', 'Cage', '2007-07-07', 6),
    ('David', 'Derby', '2008-08-08', 8);
  ```
- UDPATE
  - Used to update data records in a table
  
  ```sql
  -- reassign student with id 77 to a new locker with id 101
  UPDATE students -- speficy which table to search and update
  SET locker_id = 101 -- specify the new field value
  WHERE student.id = 77; --specify the condition our to-be-updated record(s) much satisfy
  ```
- DELETE
  - Used to delete data records in a table 
  
  ```sql
  -- delete all students with the last name of 'Cage'
  DELETE FROM students -- speficy which table to search and update
  WHERE student.last_name = 'Cage'; --specify the condition our to-be-deleted record(s) much satisfy
  ```
- JOIN
  - Used to link data records from two different tables together
  - Often used on Foreign Key related fields
  
  ```sql
  -- display the student id, locker number, and locker combination for all students
  SELECT S.id, L.number, L.combination
  FROM students S
  JOIN lockers L ON S.locker_id = L.id; -- link the student record with their corresponding locker record, matching the locker_id field from the student record with the primary id from the locker record 
  ```

### Constraints

We create constraints in our database tables so that the data records within those tables adhere to certain rules.

- Primary Key (PK)
  - A field (i.e. column) that acts as the the primary unique identifier for a given table
- Foreign Key (FK)
  - A field whose values references (i.e. must match) another column's value, usually from another table
  - Essentially used to "link" a record from one table to a record in another table
- Unique Key (UQ)
  - A field whose value will be guaranteed to be unique across all other records in the SAME table
  - Similar to a primary key
- NULL
  - Can the value for a field be left empty?
- CHECK
  - Does the value for a field need to satisfy some condition? (e.g gpa <= 4.0 && gpa >= 0.0)

### Entity relationships

We create relationships between our database tables to model our application's data in a correct manner.

- One-to-One
  - Example: Students & Lockers
    - Each student can have only ONE locker
    - Eack locker can be only used by ONE student
  - Solution: Add a Foreign Key + Unique Key
    - Create a Foreign Key constraint on the "locker_id" field in the Students table, referencing the Lockers table, so that a student is guaranteed to be assigned to an existing locker
    - Create a Unique Key constraint on the "locker_id" field in the Students table, so that no single locker can be assigned to two different Student records in the Students table

  ```sql
  CREATE TABLE lockers (
    id SERIAL PRIMARY KEY,
    number INTEGER  NOT NULL,
    combination VARCHAR(12) NOT NULL
  );

  CREATE TABLE students (
    id SERIAL PRIMARY KEY,
    first_name VARCHAR(32) NOT NULL,
    last_name VARCHAR(32) NOT NULL,
    birth_date DATE NOT NULL,
    locker_id INTEGER UNIQUE REFERENCES lockers (id) -- foreign key relation + unique key relation, nullable (a student might not have a locker)
  );
  ```

- One-to-Many
  - Example: Professors & Courses
    - Each professor can teach MANY different courses
    - Each course can only have ONE professor teaching it
  - Solution: Add a Foreign Key
    - Create a Foreign Key constraint on the "professor_id" field in the Courses table, referencing the Professors table, so that the course is guaranteed to be taught by an existing professor

  ```sql
  CREATE TABLE professors (
    id SERIAL PRIMARY KEY,
    first_name VARCHAR(32) NOT NULL,
    last_name VARCHAR(32) NOT NULL,
    start_date DATE NOT NULL
  );

  CREATE TABLE courses (
    id SERIAL PRIMARY KEY,
    name VARCHAR(64) NOT NULL,
    description TEXT,
    credits SMALLINT NOT NULL,
    professor_id INTEGER NOT NULL REFERENCES professors (id) -- foreign key relation, non-nullable (a course MUST have a professor)
  );
  ```

- Many-to-Many
  - Example: Students & Courses
    - Each student can be enrolled in MANY different courses
    - Each course can have MANY different students enrolled in it
  - Solution: Create a Join Table
    - Create a new table, which should contain a Foreign Key "student_id" field, referencing the Students table, and a Foriegn Key "course_id" field, referencing teh Courses table
    - This new table allows us to sastify our many-to-many relationship without having to duplicate record data in other tables 

  ```sql
  -- join table to combine students with courses in a many-to-many relation
  CREATE TABLE enrollments (
    id SERIAL PRIMARY KEY,
    student_id INTEGER NOT NULL REFERENCES students (id),
    course_id INTEGER NOT NULL REFERENCES courses (id),
    grade VARCHAR(2),
    UNIQUE(student_id, course_id) -- unique key relation (prevent a student from being enrolled in the same course more than once)
  );
  ```
  
### Final Schema

```sql
CREATE TABLE lockers (
  id SERIAL PRIMARY KEY,
  number INTEGER  NOT NULL,
  combination VARCHAR(12) NOT NULL
);


CREATE TABLE students (
  id SERIAL PRIMARY KEY,
  first_name VARCHAR(32) NOT NULL,
  last_name VARCHAR(32) NOT NULL,
  birth_date DATE NOT NULL,
  locker_id INTEGER UNIQUE REFERENCES lockers (id) -- foreign key relation + unique key relation, nullable (a student might not have a locker)
);


CREATE TABLE professors (
  id SERIAL PRIMARY KEY,
  first_name VARCHAR(32) NOT NULL,
  last_name VARCHAR(32) NOT NULL,
  start_date DATE NOT NULL
);


CREATE TABLE courses (
  id SERIAL PRIMARY KEY,
  name VARCHAR(64) NOT NULL,
  description TEXT,
  credits SMALLINT NOT NULL,
  professor_id INTEGER NOT NULL REFERENCES professors (id) -- foreign key relation, non-nullable (a course MUST have a professor)
);


CREATE TABLE enrollments (
  id SERIAL PRIMARY KEY,
  student_id INTEGER NOT NULL REFERENCES students (id),
  course_id INTEGER NOT NULL REFERENCES courses (id),
  grade VARCHAR(2),
  UNIQUE(student_id, course_id) -- unique key relation (prevent a student from being enrolled in the same course more than once)
);
```

### Seed Data

```sql
INSERT INTO lockers (id, number, combination)
VALUES
  (1, 101, '11-21-31'),
  (2, 102, '12-22-32'),
  (3, 103, '13-23-33'),
  (4, 104, '14-24-34'),
  (5, 205, '15-25-35'),
  (6, 206, '16-26-36'),
  (7, 207, '17-27-37'),
  (8, 208, '18-28-38');


INSERT INTO students (first_name, last_name, birth_date, locker_id)
VALUES
  ('Anna', 'Abrams', '2005-05-05', 2),
  ('Biil', 'Brooks', '2006-06-06', 4),
  ('Cassie', 'Cage', '2007-07-07', 6),
  ('David', 'Derby', '2008-08-08', 8);


INSERT INTO professors (first_name, last_name, start_date)
VALUES
  ('Charlie', 'Chaplin', '2010-01-01'),
  ('Rachael', 'Ray', '2012-01-01'),
  ('Steven', 'Spielburg', '2014-01-01'),
  ('Tina', 'Turner', '2016-01-01'),
  ('Vince', 'Vaughn', '2018-01-01');


INSERT INTO courses (name, description, credits, professor_id)
VALUES
  ('CS 101', 'Computer Science Fundamentals', 3, 1),
  ('CS 202', 'Computer Science Intermediate', 4, 5),
  ('Databases 203', 'Working with databases', 4, 3),
  ('Cooking 301', 'Learn how to cook', 3, 2),
  ('Singing 203', NULL, 3, 5),
  ('Singing 307', NULL, 4, 4);


INSERT INTO enrollments (student_id, course_id, grade)
VALUES
  (1, 2, 'B+'),
  (1, 3, 'A-'),
  (1, 5, NULL),
  (2, 1, 'B'),
  (2, 3, 'A+'),
  (2, 5, NULL),
  (3, 1, 'C'),
  (4, 4, 'B-'),
  (4, 1, 'F'),
  (4, 2, NULL);
```


## Assignments
- [PG Exercises](https://pgexercises.com/questions/basic/) 
# Django-ORM


## Topics Covered / Goals
- Be able to create a new Django project within your virtual enviornment
- Understand how to create a database and models
- Know how to communicate with your database using Python and Django ORM

## Lesson


**Connecting Django to Postgresql using Django ORM**

> Recently, we learned how to query postgreSQL, which stores data in relational tables. Before that, we learned about Django servers, which store much of their data in python objects. It can be tricky to write a python application that queries a SQL database, since these are different ways of storing data. To help us translate between these formats, developers often use an Object-Relational Mapping library (ORM). Fortunately, Django includes a very useful ORM, creatively called Django-ORM. 

> When using Django-ORM, we won't write raw SQL anymore. Instead, we'll define Classes, called `models`, from which Django-ORM can automatically create tables in postgres. Instances of these classes will be used to represent individual rows of our tables. Django-ORM provides other useful features too, such as helping us manage changes to our database schema, known as `migrations`.


**Starting a New Django Project**

Once we have our venv up and running, we can install Django and start a new project. We are going to call our project `school_project`, but you can call it whatever you want.

```bash
$ pip install django
$ python -m django startproject school_project
$ cd school_project
```

**Create a database**

Today we're learning on how the Python classes we write will connect to our database using Django ORM. We'll be creating a `school` database with one table: `students`.

```bash
$ createdb school
```

**Pyscopg2**

Now we install psycopg2, the Python library that will help Django talk to Postgres. We won't actually be calling this library directly, it's just a depency of Django-ORM that we need to install.

```bash
$ pip install psycopg2
```

And then tell Django we want to use Postgres as our database instead of the default, SQLite3. We also tell it what database to attach to

```python
## school/settings.py
## our settings.py file is in the school directory, but if you named your app a different name then it look for that folder name.

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'school',
    }
}
```

**Create our App**

Django projects are split into many apps (i.e., a project has many apps). Imagine a new _project_ at Amazon where they are selling lots of space on the Moon. That _project_ requires a bunch of different _apps_ in order to run. For example, there might be a billing _app_ to collect money from individuals, a searching _app_ for people to look up lots, a VIP _app_ where they target VIPs, etc. Today, our `school` project will just start with an `attendance_app` app.

```bash
$ python manage.py startapp attendance_app
```

Next, we need to add the `attendance_app` app to our `settings.py` file in our school folder.
```python
## school/settings.py

INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'attendance_app',
]
```

**Creating Our Model**

Now we can create our `student` model:

```python
## attendance/models.py
from django.db import models

class Student(models.Model):
    name = models.CharField(max_length=200)
    email = models.CharField(max_length=200)
```

We've created a Python class that directly maps to a database table (i.e., a model). Next, let's tell Django to create the necessary code for us to get this table into the database:

```bash
$ python manage.py makemigrations attendance
```

A folder was just generated called `migrations`. Look inside there and take a look at the Django code that was generated for us to put our tables into the database. If we were not using an ORM, we would have to write these migrations ourselves, by hand, so let's take a moment to appreciate all the time and effort that Django-ORM is saving us. Next, let's `migrate` our database, so that it reflects the current state of our models.  

```bash
$ python manage.py migrate
```

We should have a `attendance_app_student` students table in our db. Check it out with `psql school`

**Django Console**

While we can interact with our data using Postgres, more often we want to interact with our data using Python. We're going to use a console for our project that will pull in all our Python classes and allow us to query the database directly using Django's ORM.

```bash
python manage.py shell
from school.models import Student
```

The shell will allow us to load in our models from Django. Once in the shell, we can create a new student.

```bash
In [1]: student = Student(name="Jon", email="jon@jon.com")
In [2]: student.save()
```

This should look familiar - the object oriented lessons from weeks 2 and 3 were in preparation for this. Just by writing those two lines of code, we are able to instantiate a Student object for us and save it into the database. Under the hood, it's just running:

```sql
INSERT into students (name, email) VALUES ('Jon', 'jon@jon.com')
```

Now we can query our database using Python and see our new record.
```bash
In [3]: Student.objects.all()
## SELECT * from students;
```
You should get back a query object. Exit the shell by typing `exit`. Let's confirm that our new record got saved in our Postgres db.

```bash
$ psql school
psql (11.1, server 9.6.3)
Type "help" for help.

school= \d
                          List of relations
 Schema |               Name                |   Type   |     Owner
--------+-----------------------------------+----------+---------------
 public | attendance_app_student            | table    | joshuaalletto
 public | attendance_app_student_id_seq     | sequence | joshuaalletto
 public | auth_group                        | table    | joshuaalletto
 ...

```
Django creates our database tables with the app name first, followed by the app name. Before we even wrote our own models, there were many built-in tables here, named after the built-in apps in Django, such as `admin`, `auth`, and `sessions`. Also, take note of the `django-migrations` table, which django manages automatically in order to keep track of which migrations have already been run. Our app's table is `attendance_app_student`. Let's query for the records in that table and see what we get.

```bash
## select * from attendance_app_student;
school=
 id | name | email
----+------+-----+
  1 | Jon | jon@jon.com
(1 row)
```


**Communicating with the Front-end**

So far, we've interacted with our database using PSQL or the django shell. For a real application, queries to the database will be handled in our views, initiated by user requests. There are many ways that this might work, but for our first project using Django-ORM, let's simply display all of our students on the home page, and then create a form that allows the user to add more students. 

```python
def index(request):

    students = Student.objects.all() # get list of all students

    # the home page should show a roster of all the students, so we pass the whole list into the template
    return render(request, 'attendance_app/index.html', {'students': students} )
```

Then we'll need a template that can render this data.

```html
<h1>Class Roster</h1>

<ul>
    {% for student in students %}
    <li>{{student.name}} - {{student.email}}</li> 
    {% endfor %}
</ul>
```

We'll also need a route that allows us to add new students.

```python
@csrf_exempt
# this function creates a cartItem / updates a cartItem quantity
def add_student(request):
    body = json.loads(request.body) 

    new_student = Student(name = body['name'], email = body['email'])
    new_student.save()

    return  JsonResponse({'success':True})
```

Finally, we'll build a form that users can use to specify a new student's name and email.

```js
function add_student(event)  {
    event.preventDefault() 
    // 'name' is already globally defined in js, so I'm using 'username' here just to be extra safe.
    const username = document.getElementById('username').value
    const email    = document.getElementById('email').value

    axios({
        method: 'POST',
        url: '/student/',
        data: {
            // when our django server receives this data, it will be called 'name' instead of 'username'
            name: username,
            email: email,
        }
    }).then(function (response){
        console.log(response.data)
    })
}
```



## External Resources
- [Django Docs](https://docs.djangoproject.com/en/2.2/)
- [Django Queries Cheat Sheet](https://github.com/chrisdl/Django-QuerySet-Cheatsheet)
- [Django Validators Resource](https://docs.djangoproject.com/en/2.2/ref/validators/)
- [Database Diagramer](https://www.quickdatabasediagrams.com/)

## Assignments
- [Assessment #3](https://github.com/romeoplatoon/assessment-3)
- [Django Queries](https://github.com/romeoplatoon/django-queries)

# Django validators


## Topics Covered / Goals
- Know how to write Django Validators
- Know how to create Django Associations (relationships between models)

## Lesson

**Connecting Django to Postgresql using Django ORM**

##### 1. Create your virtual environment
`python -m venv <envname>`

##### 2. Start your virtual environment
`source <envname>/bin/activate`

##### 3. Eject from your virtual environment (once you're done - this is run at the very end of development)
`deactivate`

**Starting a New Django Project**

Once we have our venv up and running, we can install Django and start a new project. We are going to call our project name `twitter_project`, but you can call it whatever you want.

```bash
$ pip install django
$ django-admin startproject <projectname>
$ cd <projectname>
```

**Create a database**

Today we're learning on how the Python classes we write will connect to our database using Django ORM. We'll be creating a `twitter` database with one table: `user`.

```bash
$ createdb twitter
```

**Pyscopg2**

Now we install the Python library that will help Django talk to Postgres.

```bash
$ pip install psycopg2
```

And then tell Django we want to use Postgres as our database instead of the default SQL adapter, SQLite3. We also tell it what database to attach to

```python
## twitter_project/settings.py
## our settings.py file is in the twitter_project directory, but if you named your app a different name then it look for that folder name.

DATABASES = {
	'default': {
		'ENGINE': 'django.db.backends.postgresql',
		'NAME': 'twitter',
	}
}
```

**Create our App**

Django projects are split into many apps (i.e., a project has many apps). Imagine a new _project_ at Amazon where they are selling lots of space on the Moon. That _project_ requires a bunch of different _apps_ in order to run. For example, there might be a billing _app_ to collect money from individuals, a searching _app_ for people to look up lots, a VIP _app_ where they target VIPs, etc. Today, our `twitter_project` project will just start with a `twitter_app` app.

```bash
$ python manage.py startapp twitter_app
```

Next, we need to add the `twitter_app` app to our `settings.py` file in our school folder.
```python
## school/settings.py

INSTALLED_APPS = [
	'django.contrib.admin',
	'django.contrib.auth',
	'django.contrib.contenttypes',
	'django.contrib.sessions',
	'django.contrib.messages',
	'django.contrib.staticfiles',
	'twitter_app',
]
```

**Creating Our Model**

Now we can create our `user` model:

```python
## attendance/models.py
from django.db import models

class User(models.Model):
	first_name = models.CharField(max_length=255)
	last_name = models.CharField(max_length=255)
	email = models.EmailField(max_length=100)
	age = models.IntegerField()
	account_type = models.CharField(max_length=4) # 'paid' or 'free'
```

We've created a Python class that directly correlates to a database table (i.e., a model). Next, let's tell Django to create the necessary code for us to get this table into the database:

```bash
$ python manage.py makemigrations twitter_app
```

A folder was just generated called `migrations`. Look inside there and take a look at the Django code that was generated for us to put our tables into the database. Next, let's `migrate` our data from the app into the database itself:

```bash
$ python manage.py migrate
```

We should have a `twitter_app_user` students table in our db. Check it out with `psql twitter`

**Database Validators**

Our User model has an `age` field but with our twitter app, we only want to allow users who are 13 years old or older to signup. However, our `age` field allows for any age to get entered and saved into the database. So as a developer maybe when a user signs up we have a select drop down that only has ages 13 and above to choose from, will that prevent someone signing up who is under the age of 13? Nope, what if a hacker somehow hacks our form and enters an age less than 13? That's why we need validators to validate all the data right before the data gets saved into our database. It's the last line of defense before the data gets saved.

We can create a **validator** which is a method to check if the user is 13 years of age or older.

```py
from django.core.exceptions import ValidationError # import ValidationError from Django
from django.utils.translation import gettext_lazy as text # import gettext_lazy

## Create minimum age validator
def validate_age(age):
	if age < 13:
		raise ValidationError(text(f"You need to be 13 years of age or older. You currently are {age} years old. Get older!"))

class User(models.Model):
	first_name = models.CharField(max_length=255)
	last_name = models.CharField(max_length=255)
	email = models.EmailField(max_length=100)
	age = models.IntegerField(validators=[validate_age]) # add this code
	account_type = models.CharField(max_length=4)
```

Luckily Django has very common validators built-in to the Django Framework. If we want to validate a minimum (or maximum) integer we can use the built-in validator `MinValueValidator()`. Let's replace our `validate_age` validator with the built-in ``MinValueValidator()`.

```py
from django.core.exceptions import ValidationError # import ValidationError from Django
from django.utils.translation import gettext_lazy as text # import gettext_lazy
from django.core.validators import * # import built-in Django Validators

class User(models.Model):
	first_name = models.CharField(max_length=255)
	last_name = models.CharField(max_length=255)
	email = models.EmailField(max_length=100)
	age = models.IntegerField(validators=[MinValueValidator(13)]) # replaced with MinValueValidator(13)
	account_type = models.CharField(max_length=4)
```

Also, what if we only want user's to have a `paid` or `free` account and we only want the string `'paid'` or `'free'` to be saved into the database. We can create a Django Validator to check to see if they enter `paid` or `free`.

```py
from django.db import models
from django.core.exceptions import ValidationError # import ValidationError from Django
from django.utils.translation import gettext_lazy as text # import gettext_lazy

## Add this validator to validate the account type field
def validate_account_type(account_type):
  	valid_account_types = ['free', 'paid']
  	if account_type not in valid_account_types:
		raise ValidationError(text(f"{account_type} is not valid. Please select a valid account type {valid_account_types}"))

class User(models.Model):
	first_name = models.CharField(max_length=255)
	last_name = models.CharField(max_length=255)
	email = models.EmailField(max_length=100)
	age = models.IntegerField(validators=[MinValueValidator(13)])
	account_type = models.CharField(max_length=4, validators=[validate_account_type])
```

**Testing**

In our `twitter_app` directory, inside the `tests.py` file we can write our unit tests.

```py
from django.test import TestCase
from django.core.exceptions import ValidationError
from .models import User # import User model

## Create your tests here.
class AppUserTest(TestCase):

  	def test_01_create_user(self):
		new_user = User(first_name='Tom', last_name='Prete', email='tom@email.com', age=12, account_type='free')
		try:
			new_user.full_clean()
			self.fail() # should fail if it reaches here
		except ValidationError as e:
			self.assertFalse('user cannot be under the age of 13' in e.message_dict['age'])

	def test_02_create_user(self):
		new_user = User(first_name='Tom', last_name='Prete', email='tom@email.com', age=13, account_type='free')
		try:
			new_user.full_clean()
			self.fail()
		except ValidationError as e:
			self.assertTrue('user cannot be under the age of 13' in e.message_dict['age'])

  	def test_03_account_type(self):
		new_user = User(first_name='Tom', last_name='Prete', email='tom@email.com', age=15, account_type='free')
		try:
			new_user.full_clean()
			self.fail()
		except ValidationError as e:
			self.assertTrue('Please enter a valid account type' in e.message_dict['account_type'])
```

To run your tests execute the command `python manage.py test` in the terminal.

## Django Associations

As with database schema design, we can create relationships between our Django models to reflect certain requirements. Django provides some model fields to make achived this task much simpler:
- models.OneToOneField()
- models.ForiengKeyField()
- models.ManyToManyField()

Let's take a look at how we could create a foreign key relationship:

```python
class Professor(models.Model):
	# ...other fields
	pass
	
class Course(models.Model):
	# ...other fields
	professor = models.ForeignKey(Professor, on_delete=models.CASCADE, related_name="courses")
```

The models.ForeignKey() field takes in the model you want to reference, the deletion behavior, and the alias field we want *on the the side* of the relationship.
The `related_name` field is optional... if we do not provide a value for it, Django provides some default naming for the field.

Creating a foreign key field relationship here does the same thing that we would expect for in a database: We reference another model and there must be a matching entry in the corresponding model's table. Additional, using models.ForeignKey() essentially creates a new field on the other side of the relationship, for convenience:

```python

c = Course.objects.get(pk=3)
print(c.professor) # accessing the professor field on the course object

p = Professor.objects.get(pk=c.professor.id)
print(p.courses.all()) # accessing ALL of the courses that this professor teaches (the relate_name value is used in this manner)
```

## Another Example using Validator and Associations

```python
# models.py

from django.core.validators import MinValueValidator, MaxValueValidator, RegexValidator
from django.db import models
from .validators import *

class Locker(models.Model):
	locker_number = models.IntegerField(unique=True)
	combination = models.CharField(max_length=10, validators=[validate_locker_combination])

	def __str__(self):
		return f"LOCKER: {self.locker_number}"

class Student(models.Model):
	first_name = models.CharField(max_length=32)
	last_name = models.CharField(max_length=32)
	birth_date = models.DateField()
	locker = models.OneToOneField(Locker, null=True, blank=True, on_delete=models.CASCADE, related_name="student")

	def __str__(self):
		return f"STUDENT: {self.first_name} {self.last_name}"

class Professor(models.Model):
	first_name = models.CharField(max_length=32)
	last_name = models.CharField(max_length=32)
	start_date = models.DateField()

	def __str__(self):
		return f"PROFESSOR: {self.first_name} {self.last_name}"

class Course(models.Model):
	name = models.CharField(max_length=64)
	description = models.TextField()
	credits = models.IntegerField(validators=[MinValueValidator(1), MaxValueValidator(6)])
	professor = models.ForeignKey(Professor, on_delete=models.CASCADE, related_name="courses")
	students = models.ManyToManyField(Student, through="Enrollment")

	def __str__(self):
		return f"COURSE: {self.name}"

class Enrollment(models.Model):
	student = models.ForeignKey(Student, on_delete=models.CASCADE, related_name="enrollments")
	course = models.ForeignKey(Course, on_delete=models.CASCADE, related_name="enrollments")
	grade = models.CharField(max_length=2, validators=[RegexValidator(regex=r"[ABCDF][+-]?")])

	class Meta:
		unique_together = (("student", "course"))

	def __str__(self):
		return f"ENR: {self.student} in {self.course}"
```

```python
# validator.py

from django.core.exceptions import ValidationError
import re

def is_locker_digit_valid(digit):
	num = int(digit)
	return num >= 0 and num < 60

def validate_locker_combination(combination):
	pattern = r"(\d{1,2})-(\d{1,2})-(\d{1,2})"
	match = re.search(pattern, combination)
	error = ""

	if not match:
		error = "Invalid combination format!!!"

	elif not is_locker_digit_valid(match.group(1)) or \
		not is_locker_digit_valid(match.group(2)) or \
		not is_locker_digit_valid(match.group(3)):
		error = "Invalid combination digit!!!"

	if error:
		raise ValidationError(
			error,
			params={'combination': combination},
		)
		
	return combination
```

## External Resources
- [Django Docs](https://docs.djangoproject.com/en/2.2/)
- [Django Queries Cheat Sheet](https://github.com/chrisdl/Django-QuerySet-Cheatsheet)
- [Django Validators Resource](https://docs.djangoproject.com/en/2.2/ref/validators/)

## Assignments
- [Django Validations](https://github.com/romeoplatoon/django-validations)
- [Django Associations](https://github.com/romeoplatoon/django-associations)



# Django Polls App


## Topics Covered / Goals
- Install and setup Django within a virtual enviornment
- Practice creating a database and models
- Add views to a simple Django app and understand its underlying structure
- Use Django forms to allow users to interact with your app

## Lesson
**Introduction to Django**

Django is the web framework for Python. As we've mentioned before, a library is nothing more than thousands of lines of code that someone else wrote ahead of time to make your job as a developer easier. A framework is merely a bunch of libraries woven together. In today's web, we generally have a framework taking care of the backend (e.g., Django, Rails, Node) and a framework taking care of the frontend (e.g., React, Angular, Backbone). Fullstack solutions like Ruby on Rails and Django are available, but are too slow for the modern web user.

Today, we're going to get started with using Django as a full stack framework, handling both the front and back end of our application. Later, we'll learn how to run Django just as an API (backend) layer and use it in conjunction with React on the frontend.

**Setup**

This tutorial is largely based off of [the official docs](https://docs.djangoproject.com/en/3.1/intro/tutorial01/). A few things have been removed for brevity and others have been added to account for our current level of knowledge.

First things first for any new Django project, we need a new virtual environment to keep our dependencies isolated to this project and the versions we build it with.

> **NOTE**: This will become a repetive workflow for setting up a new project.

1. Create a Python Virtual Environment: `python -m venv ~/venvs/polls_env`
2. Activate your `venv`:
  On Mac/Linux 
  > `source ~/venvs/polls_env/bin/activate`

  On Windows 
  > `~\venvs\polls_venv\Scripts\activate`

3. Install `django` into your environment: `pip install django`
4. Create a Django project called `polls_project`: `python -m django startproject polls_project`


*Let's fire up the server:* `python manage.py runserver`. Next, visit http://localhost:8000 and see what you get!

*Don't worry about any unapplied migrations yet. We're not using our database just yet.*


**Poll App / Views**

Now the server will continue running until you stop it with Ctrl-C, but that means you can't use the command line. So to continue running commands, open a second terminal window. In the same directory / level as `manage.py`, run:

```bash
source ~/venvs/polls_env/bin/activate
python manage.py startapp polls_app
```

A quick sidebar - we ran `startproject` earlier and we are now running `startapp`. The difference between these two is that a `project` consists of many `apps`.

In `polls_app/views.py`, let's put the following code inside:
```python
from django.shortcuts import render
from django.http import HttpResponse

def index(request):
    return HttpResponse("Hello, world. You're at the polls index.")
```

We created a request method called `index` inside the `views` file. Next, we need to register this page in `polls_app/urls.py` *(you need to create this file)*. Create that file and paste the following code in there:

```python
from django.urls import path

from . import views

urlpatterns = [
    path('', views.index),
]
```

Finally, we will connect our recently created `urls.py` to `polls_project/urls.py`. *Delete the code that is already in the `urls.py` file and replace it with the code below*:

```python
from django.urls import include, path

urlpatterns = [
    path('polls/', include('polls_app.urls')),
]
```

Whoa, a lot of code just now - let's break it down. We started off earlier with creating a project called `polls_project`. Projects can consist of many apps. We then created a `polls_app` app which is at the same level as `polls_project`. Whenever anyone hits any route (aka endpoint) with `/polls`, the `polls_project/urls.py` file will direct them to the `polls` app, specifically the `urls` file. From there, it'll send the user to `index` method in `views.py`.

In `polls_app/urls.py`, let's break down the `path` method that we imported. `path` takes in 4 arguments. 2 of them are required and 2 of them are optional. In order, they are `route`, `view`, and `kwargs` / `name`. `route` is the path that you enter in the URL. `view` is the file that handles the logic behind what shows up on your screen. `views.index` means "Look at the index method in the `views.py` file." 

Visit http://localhost:8000/polls to see what you get!

**Setting up our Database**

We are going to use Postgres for our database.

Let's ensure that the `ENGINE` reads `'ENGINE': 'django.db.backends.postgresql'` in `polls_project/settings.py` before moving on.


**Models & Migrations**

Django's architecture is based off the MVC pattern - Model, View, Controller. The Controller layer (`views.py`) can be seen as the brains of the app - it handles the logic . The View layer (`templates/`) is responsible for everything that a user sees, and the Model layer (`models.py`) is what connects your Python objects to the database. As you're starting to see, everything that we have been teaching has led to us writing this framework code.

| MVC Framework | Django  |
|---|---|
| Model  | `models.py`  |
| View  |  Template folder (`templates/{app_name}/example.html`) |
| Controller  | `views.py`  |

This might seem a little confusing at first because Django has something called 'views', which are used to represent the Controller in MVC, not the View.

![django architecture](../../page-resources/django-architecture.png)

In Django, we declare all of our models in one file: `models.py`. In polls_app/models.py, let's write:

```python
from django.db import models

class Question(models.Model):
    question_text = models.CharField(max_length=200)
    pub_date = models.DateTimeField('date published')

class Choice(models.Model):
    question = models.ForeignKey(Question, on_delete=models.CASCADE)
    choice_text = models.CharField(max_length=200)
    votes = models.IntegerField(default=0)
```

We've got two tables in our polls app: question and choice. A question has `question_text` and a `pub_date`, and has many choices. A choice belongs to a question through the `question = models.ForeignKey(Question, on_delete=models.CASCADE)`, has `choice_text` and `votes`.

Next, we have to hook up our polls app to `polls_project`'s configuration in `polls_project/settings.py`:
```python
INSTALLED_APPS = [
    'polls_app',
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
]
```

Now we're ready to migrate our database schema to reflect our models in `models.py`:
```bash
python manage.py makemigrations
```

A new file was created for us: `polls_app/migrations/0001_initial.py`. Every time that you run `python manage.py makemigrations`, it will detect differences and save it as a numbered migration under your `migrations` folder. This allows you to store changes to your models and ultimately your database schema over time.

Finally, to get our code into the database:
```bash
python manage.py migrate
```

**Playing with the Django shell**

```
python manage.py shell
```
This gives us access to the Python shell, but with our entire app loaded into it! We can interact with the database using Python code:

```python
from polls_app.models import Question
Question.objects.all() # should return an empty collection, which makes sense since we have nothing in the database yet. Let's create a question record.

from django.utils import timezone
question = Question(question_text="What's new?", pub_date=timezone.now())
question.save()
question.id
question.question_text
question.pub_date

## If you want to change the attributes, go ahead and overwrite them, then call save()
question.question_text = 'What is up?'
question.save()

## Now if you wanted to get all the questions
Question.objects.all()
```

You'll notice that the result we get back (`<Question: Question object (1)>`) is not descriptive. In `polls_app/models.py`, we are going to add a `__str__` method in for Question and Choice. All dunder methods are built in to Django; the dunder `str` method is a method we're going to overwrite so that we get a better description of each object.

```python
## polls/models.py
from django.db import models

class Question(models.Model):
    question_text = models.CharField(max_length=200)
    pub_date = models.DateTimeField('date published')
    
    def __str__(self):
        return f"ID: {self.id} Question Text: {self.question_text}"

class Choice(models.Model):
    question = models.ForeignKey(Question, on_delete=models.CASCADE)
    choice_text = models.CharField(max_length=200)
    votes = models.IntegerField(default=0)
    
    def __str__(self):
        return f"ID: {self.id} Choice Text: {self.choice_text}"
```

Fire up a new console and run some commands. A bunch of commands can be found [here](https://docs.djangoproject.com/en/3.1/topics/db/queries/):

```python
Question.objects.all() # note how you get a much more descriptive representation than what you got before

question = Question.objects.get(id=1)
question.choice_set.all() # verifying that we have no choices for our questions
```

What is `choice_set`? This is how django lets you access one model from another, related model. Django creates this name automatically based on the name of the model (e.g. f"{model_name}_set"). Like many default settings in Django, it's possible to configure the name of this property by setting a "related_name" in the model, if you want to call it something else, like `choices`. 

```python
question.choices.all() # verifying that we have no choices for our questions
## Let's create 3 choice objects that are linked to our question variable
question.choices.create(choice_text='Not much', votes=0)
question.choices.create(choice_text='The sky', votes=0)
choice = question.choices.create(choice_text='Just hacking again', votes=0)

## Now we can go from a question to a choice and vice versa
question.choices.all()
choice.question
```

**Additional Views**

We're going to add 3 new routes:
- `/polls/:question_id` (view a particular question)
- `/polls/:question_id/results` (view the results of that particular question)
- `/polls/:question_id/vote` (vote on the choices on that question)

In `polls/urls.py`, let's register these routes and their corresponding methods:
```python
from django.urls import path
from . import views

urlpatterns = [
    # ex: /polls/
    path('', views.index, name='index'),
    # ex: /polls/5/
    path('<int:question_id>/', views.detail, name='detail'),
    # ex: /polls/5/results/
    path('<int:question_id>/results/', views.results, name='results'),
    # ex: /polls/5/vote/
    path('<int:question_id>/vote/', views.vote, name='vote'),
]
```

Next, create the following methods in `polls/views.py`:
```python
from django.http import HttpResponse
from django.shortcuts import render

def index(request):
    return HttpResponse("Hello, world. You're at the polls index.")

def detail(request, question_id):
    return HttpResponse(f"You're looking at question {question_id}.")

def results(request, question_id):
    return HttpResponse(f"You're looking at the results of question {question_id}.")

def vote(request, question_id):
    return HttpResponse(f"You're voting on question {question_id}.")
```
Visit those routes with `question_id` as 1 and see what you get!

**Templating**

Of course, having plain text is not terribly useful. We want to create templates in HTML (the View layer of MVC) where we can pass in Python objects of data. Under your `polls_app` directory, create a `templates` folder, and under that directory, create another `polls_app` folder, and under that directory create an `index.html` file:

```html
<!-- polls/templates/polls/index.html -->
<h1> All Polls </h1>
{% if latest_question_list %}
  <ul>
    {% for question in latest_question_list %}
      <li><a href="/polls/{{ question.id }}/">{{ question.question_text }}</a></li>
    {% endfor %}
  </ul>
{% else %}
  <p>No polls are available.</p>
{% endif %}
```

```html
{% code blocks %}
{{ print statements }}
{# comments #}
```
Next, we'll update the def `index` view in `polls/views.py` to send a dictionary to our new template. The method `render()` requires a dictionary and is used to send `latest_question_list` to be displayed by our markup at `polls/index.html`:
```python
from django.shortcuts import render
from django.http import HttpResponse
from .models import Question

def index(request):
    latest_question_list = Question.objects.order_by('-pub_date')
    data = { 'latest_question_list': latest_question_list }
    return render(request, 'polls_app/index.html', data)

def detail(request, question_id):
    return HttpResponse(f"You're looking at question {question_id}.")

def results(request, question_id):
    return HttpResponse(f"You're looking at the results of question {question_id}.")

def vote(request, question_id):
    return HttpResponse(f"You're voting on question {question_id}.")
```


If you were to visit http://localhost:8000/polls, you'd see all of the questions we've written thus far. Let's move onto the detail function in our `polls/views.py` file which will be `/polls/1` page:

```python
from django.shortcuts import render
from django.http import HttpResponse
from .models import Question

def index(request):
    latest_question_list = Question.objects.order_by('-pub_date')
    data = { 'latest_question_list': latest_question_list }
    return render(request, 'polls/index.html', data)

def detail(request, question_id):
    question = Question.objects.get(id=question_id)
    data = { 'question': question }
    return render(request, 'polls/detail.html', data)

def results(request, question_id):
    return HttpResponse(f"You're looking at the results of question {question_id}.")

def vote(request, question_id):
    return HttpResponse(f"You're voting on question {question_id}.")
```

In our **`polls/templates/polls`** directory create a file called `detail.html`:

```html
<h1> Details about Question {{ question.id }} </h1>
<h2> {{ question.question_text }} </h2>
<ul>
  {% for choice in question.choices.all %}
    <li>{{ choice.choice_text }}</li>
  {% endfor %}
</ul>
```


**Forms in Django**

Let's create a form so that people can vote on a question. In `polls_app/templates/polls_app/detail.html`, put the following code:

```html
<h1> Details about Question {{ question.id }} </h1>
<h2> {{ question.question_text }} </h2>

{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

<form action="/polls/{{ question.id }}/vote" method="POST">
  {% csrf_token %}
  {% for choice in question.choice_set.all %}
    <input type="radio" name="choice" id="choice{{ forloop.counter }}" value="{{ choice.id }}">
    <label for="choice{{ forloop.counter }}">{{ choice.choice_text }}</label><br>
  {% endfor %}
  <input type="submit" value="Vote">
</form>
```
There are a few things to note with this form:
1. We are outputting error messages if they are present
2. We are explicitly declaring that the method for our form is `POST` because we are _sending_ information
3. We're creating a bunch of radio button options in one loop to account for each `choice` for our `question`. Each radio button has an unique `id` using `forloop.counter` (comes for free with Python)

If you refresh your page (`/polls/1`), you'll see your choices come on the screen. Submit it and you'll be directed to a page that simply says "You are voting on question 1". That's because we haven't accounted for the `POST` request in our code yet. If you look in your `urls.py`, you'll see that we defined the route but the action in `views.py` isn't really doing anything yet. We need to fix that up!

```python
## polls/views.py
from django.http import HttpResponse, HttpResponseRedirect
from django.shortcuts import render
from django.urls import reverse

from .models import Question, Choice

def get_question(question_id):
  # this is a helper method we've created since we need to find the question in detail(), results(), and vote()
  return Question.objects.get(id=question_id)

def index(request):
    latest_question_list = Question.objects.order_by('-pub_date')
    data = { 'latest_question_list': latest_question_list }
    return render(request, 'polls_app/index.html', data)

def detail(request, question_id):
    question = get_question(question_id)
    return render(request, 'polls_app/detail.html', {'question': question})

def results(request, question_id):
    return HttpResponse(f"You're looking at the results of question {question_id}.")

def vote(request, question_id):
    question = get_question(question_id)
    try:
        selected_choice = question.choices.get(pk=request.POST['choice'])
    except (KeyError, Choice.DoesNotExist):
        return render(request, 'polls_app/detail.html', {
            'question': question,
            'error_message': "You didn't select a choice.",
        })
    else:
        selected_choice.votes += 1
        selected_choice.save()
        return HttpResponseRedirect(f'/polls/{question_id}/results')
```

We've rewritten a lot of code. Let's break down the differences:

```python
from django.http import HttpResponse, HttpResponseRedirect # brings in the ability to redirect the user
from django.shortcuts import render
from django.urls import reverse # The reverse library gives us the ability to read the previous URL and just use reverse in our code so that we don't need to hard code the URL

from .models import Question, Choice # bring in the Choice model because we need it to talk to the DB

def vote(request, question_id):
    question = get_question(question_id)
    try: # try to do this
        selected_choice = question.choices.get(pk=request.POST['choice']) # find the choice that the user submitted in the form
    except (KeyError, Choice.DoesNotExist): # couldn't find the selected_choice above will raise an error. using "except" will catch that error from blowing up the app
        return render(request, 'polls_app/detail.html', { # re-display the question voting form
            'question': question,
            'error_message': "You didn't select a choice.", # these two are local variables that the view needs. this "error_message" is specifically for that
            # {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %} line of code
        })
    else:
        selected_choice.votes += 1 # add 1 to the number of votes for that selected choice
        selected_choice.save() # save it to the database
        return HttpResponseRedirect(f'/polls/{question_id}/results')
        # Always return an HttpResponseRedirect after successfully dealing
        # with POST data. This prevents data from being posted twice if a
        # user refreshes the page.
```

When we vote, we get redirected to the results page which just has some text in it. Let's alter that:
```python
## polls/views.py
def results(request, question_id):
    question = get_question(question_id)
    return render(request, 'polls_app/results.html', {'question': question})
```
`results` is telling us to create a `results.html` file in our `polls_app/templates/polls_app` directory:
```html
<h1> Details about Question {{ question.id }} </h1>
<h2> {{ question.question_text }} </h2>

<ul>
  {% for choice in question.choices.all %}
    <li>{{ choice.choice_text }} -- {{ choice.votes }} vote{{ choice.votes|pluralize }}</li>
  {% endfor %}
</ul>
<a href="/polls/{{ question.id }}/detail">Vote again?</a>
```


## External Resources
[the official django tutorial](https://docs.djangoproject.com/en/3.1/intro/tutorial01/)

## Assignments
- [Cars and Brands](https://github.com/romeoplatoon/django-cars-and-brands)



# Sessions and cookies

## Topics Covered / Goals
- use sessions so users don't have to authenticate every request
- server uses the `set-cookie` response header to start the session
- client automatically uses `cookie` request header to continue the session
- automated cookie behavior is convenient, but potentially creates security vulnerabilities (CSRF, XSS)
- Password Management
  - use one-way hashing to avoid storing plain text
  - use salt to ensure unique passwords
- Sign up, Log in
    - Authentication (logging in and out) is an important feature for any web app. It allows users to store data private to them and blocks anonymous users from viewing protected routes


## Lesson

> Up to this point, we haven't had the ability to log in or out of our application. We've been able to save data in the database, but we haven't been able to securely, reliably associate that data with its owner. Most modern web applications require users to log in and start a session, so that they can only modify their own data. Today, we'll be learning about related concepts and technologies that are used for logging in to a web application, such as cookies, sessions, and password hashing. Later this week, we'll be learning about some of the tools that django provides that make it easier for us to implement authentication in our applications. 

### Cookies

> We learned previously that HTTP is a stateless protocol, meaning that by default, we don't automatically know if multiple requests are coming from the same user. The way that modern applications are able to remember who you are across different pages is through `cookies`. There are two commonly used definition for cookie:
- a small piece of data that is stored in a user's browser, when it is instructed to do so by the server via the `set-cookie` HTTP response header. 
- any web technology that can be used to track users between pages, similarly to using the `set-cookie` header.

> We'll be working with the first definition, but you should be aware that this term is sometimes used vaguely to refer to other technologies. 

> The basic way that cookies work is: when a server responds to an HTTP request, it can include the header `set-cookie`, with any number of key-value pairs as its value. When that same user sends another HTTP request to that same server, the user's browser will automatically send all the cookies it was given in the `set-cookie` response header, by including them in a `cookie` request header. 

> Even though cookies are just set and read in an HTTP header, they have their own syntax, so it's more complicated than a simple string. Fortunately, django has some built-in functionality that will let us focus on the concepts of cookies, without worrying about the specific syntax too much. We can use `response.set_cookie` to set a new key value pair in a cookie, as well as set some options for the cookie, such as:
- max_age. The amount of time, in seconds, the cookie should be valid for. After this much time passes after the client receives the `set-cookie` header, the cookie becomes 'stale' and is no longer automatically included in future request headers. Setting this value to `None` makes the cookie last as long as the user's browser session. Your bank's website probably uses a relatively small value for max_age in its cookies, compared to a social network that wants you to never log out.
- httponly. Normally, cookies can be accessed with javascript via `document.cookie`, but this is generally not necessary since browsers handle cookies automatically. Setting a cookie as `httponly` makes it inaccessible from javascript, which can potentially prevent certain security vulnerabilities. 
- secure. Secure cookies will only be used over HTTPS. If the page was requested with plain HTTP (not HTTPS), the cookies are ignored.

> When the client sends the cookies back up to the server, we can read them in django on a dictionary at `request.COOKIES`.

```python
def index(request):
    print(request.COOKIES)
    print(request.COOKIES.get('foo'))
    response = render(request, 'blog/index.html')
    return response

def set_cookies(request):
    response = render(request, 'blog/index.html')
    response.set_cookie('foo', 'bar', httponly=False, secure=False, max_age=5)
    response.set_cookie('more_secure', 'not_for_js', httponly=True, secure=False, max_age=5)
    return response
```

> Even if we go to other pages that aren't setting cookies, our browser will still continue sending cookies until they expire, as long as we're in the same domain.

### Sessions

> Often when users interact with a website, they expect their actions and preferences to be remembered. For example, if you mute a video that auto-played in a news article, you might hope that the website remembers that preference and also mutes the videos for other articles you read afterwards, even if you're not logged in. Many shopping websites allow users to add items to their cart, which persists across pages, without logging in. These are both examples of sessions, in which we use cookies to create a consistent user experience across different pages of our site. 

> It's important to note that sessions are distinct from logins. Many sites will create a session for you as soon as you visit, before you log in. It's also possible to have logins without a session. For the front end of a website, this would create a bad user experience, since you'd have to log in again every time you load a new page. For an API, this is pretty normal, since you often need to use an API key to authenticate every request. 

> We could potentially try storing session data on the cookie itself, but cookies have a very limited size. Instead, let's just leave a session ID in the cookie, and store the rest of the user's data in the server. 

```python
sessions = {}
def increment_count(request):
    print(sessions)
    session_id_number = request.COOKIES.get('session_id_number')
    session = sessions.get(session_id_number)
    if not session:
        session_id_number = str(random.randint(100000,999999))
        
        sessions[session_id_number] = {
            'count': 1,
            'start_time': datetime.datetime.now()
        }
    else:
        sessions[session_id_number]['count'] += 1
    response = render(request, 'blog/count.html', sessions[session_id_number])
    response.set_cookie('session_id_number', session_id_number)
    return response
```

```html
    <p>Youve visited this page {{count}} times, since {{start_time}}. </p>
```

> This is a very simple implementation of sessions. However, this only works for a single route, and the whole point of sessions is to persist the state across different pages. We could repeat similar logic across all the routes of our site, but in order to keep our route handler DRY, we need to use something called middleware. In this context, middleware is a function that a server applies to all requests it receives, or at least all requests to some group of routes. It's good to know how to write custom middleware, but in this case we can rely on django's built-in session middleware. Django stores the session data in the database instead of in memory, so we need to run the initial migrations first.

```bash
`python manage.py migrate`
```

```python
def increment_count(request):
    if not request.session.get('count'):
        request.session['count'] = 1
        request.session['start_time'] = datetime.datetime.now().__str__()
    else:
        request.session['count'] += 1
    
    return render(request, 'blog/count.html', {
        'count': request.session.get('count'),
        'start_time': request.session.get('start_time'),
    })
```

### Cookie vulnerabilities (CSRF)

> It's very convenient that cookies are automatically stored on the client and sent to the server, but sometimes this automatic behavior can be exploited by hackers. If a hacker tricks a user into clicking on a link that does something destructive, like resetting their password, the request will be performed with the user's cookies. Depending on other factors, a hacker might be able to delete your data or take control of your account. This kind of vulnerability is called Cross-Site-Request-Forgery, or CSRF. It's pronounced "sea surf".

> To prevent CSRF exploits, django will not process certain types of 'unsafe' requests unless you also provide a CSRF token, a small piece of data that must be MANUALLY sent to the server, unlike cookies, just to prove that the request was a legitimate request from a user from within our application. In the near future, we'll learn how to properly include a CSRF token in ajax requests to satisfy django's security requirements. For today, however, we'll just be temporarily disabling this security feature.

```python
@csrf_exempt
```

### Signup 

> Now that we can use cookies to create sessions, the next thing we want to do is register a user, and log them in to start a session. However, before we create a user, we need to know how to properly handle user passwords. It's important that our users' passwords aren't stored in plain text, just in case a hacker gets access to our database. Django has a lot of built-in functionality that helps us manage users and their passwords, but today we're going to implement sign-up/login manually, so we can understand the process better. The general process of registering a user is:
- user sends a POST request to the server with their email/username and password
- server generates a random `salt`, which is appended to the user's password
- the salt+password are hashed
- a user object is created, and stored in the database. salt+hash are stored in the database in a single column
- (optional) start a session for the user if they don't have one, or associate their existing session with their new account. 

> We'll need to save users in our database, so let's create a model for them in `models.py`.

```python
from django.db import models

class AppUser(models.Model):
    user_name = models.CharField(max_length=30, unique=True)
    password = models.CharField(max_length=99)
```



### Hashing

> It's dangerous to store plain-text passwords in our database. We want to limit how much sensitive data we are responsible for, in case a hacker gets access to our database. It's important to `hash` a password first, and only store the hash in the database. Remember, hashing is different from encryption. Anything that can be ENcrypted can be DEcrypted, if you have the encryption keys, because encryption is a 2-way process. However, once a value is hashed, there is no straightforward way to reverse that hash, and recover the original value. 

> There are a couple features that are important in a hashing algorithm:
- a hashing algorithm should be fast enough that a user can register/log-in relatively quickly, but slow enough that a hacker can't hash a billion passwords in an hour.
- a hashing algorithm should produce hashes that look similar for all inputs, so a hacker can't get clues about the password based on the hash

> Today we'll be using the built-in python module `hashlib`, which contains a variety of hashing algorithms. The exact hashing algorith that we use today might not actually be the perfect choice for a web application, but it should be good enough to demonstrate the concepts we're learning about today. 


### Salting

> If we hash our passwords, a potential hacker would need to guess passwords by hashing them first, which is a little slow. However, a clever hacker might have a list of precomputed hashes for common passwords, called a rainbow table, which saves them the time of hashing on the fly. Also, they might notice that many users have identical hashes, which means they can crack multiple accounts at once, and those users are probably all using a very common, insecure password. 

> The solution to the above problems is to add a `salt` to the password. A salt is a random string that is added to the users' password before it is hashed. Then, the salt+hash is stored in a single column in the database. This guarantees that every user has a unique hash, and none of the hashes can be found in a rainbow table. Salting your passwords doesn't actually make it much harder for a determined hacker to crack a single, secure password. It mostly prevents opportunistic attacks, and increases the amount of time/effort required to crack many weaker passwords.  It just adds another roadblock to potential hackers. 

> Next, let's create a route and a view to handle sign-up requests.

```python
@csrf_exempt
def sign_up(request):
    # the body is a JSON formatted string. let's convert it to a dictionary
    body = json.loads(request.body)
    raw_password = body['password']

    # a simple helper function that generates a random string
    salt = generate_salt()

    # convert our string to bytes, hash the bytes, then display the hash as hexadecimal
    salted_hashed_password = hashlib.sha256((salt + raw_password).encode()).hexdigest()

    # the salted hash is saved in the database, NOT the plain-text password.
    new_user = AppUser(user_name=body['username'], password=f"{salt}${salted_hashed_password}")
    new_user.save()

    # tell the client their request was successful
    return JsonResponse({
        'success':True
    })
```

> We'll need to write some javascript code to send requests to this route.

```javascript
axios.post('/sign-up', {
    username: 'jeffbezos',
    password: 'dragons',
}).then((response)=>{
    console.log('response', response)
})
```

### Login

> Now that we've registered a user, we need to be able to log them in. The general process for this is:
- user sends a POST request with their username and password
- server looks up the user with that username from the database
- the server takes the salt from the user's `password` field, concatenates it to the password in the POST request body, and hashes them together
- the hash generated in the previous step is compared with the hash from the user's `password` field in the database.
- if the hashes match, then the password is correct, and we can log the user in. Set a cookie to start a session. 
- if the hashes don't match, send a 401 error to let the client know what went wrong. 

```python
@csrf_exempt
def log_in(request):
    # convert the body from a JSON string to a python dictionary
    body = json.loads(request.body)

    # look up the user from the database that this client is claiming to be
    user = AppUser.objects.get(user_name=body['username'])

    # split the 'password' field in the db into its components: the salt and the hash
    split_password = user.password.split('$')
    salt = split_password[0]
    hashed_password = split_password[1]

    # use the salt from the db to hash the password in the request body
    challenge_hash = hashlib.sha256((salt + body['password']).encode()).hexdigest()

    # if the hashes match, set a cookie to start a session
    if challenge_hash == hashed_password:
        response = JsonResponse({ 'success':True })
        response.set_cookie('user_id', user.id)
        return response
```


## External Resources
- [WS Vincent Authentication Tutorial](https://wsvincent.com/django-user-authentication-tutorial-login-and-logout/)
- [WS Vincent Password Reset Tutorial](https://wsvincent.com/django-user-authentication-tutorial-password-reset/)

## Assignments
- [Django view-counter](https://github.com/romeoplatoon/django-view-counter)



# Django Auth

## Topics Covered / Goals
- The user model
- sign up, log in, log out
- accessing the user from the request object

## Lesson
> Yesterday, we learned how to manually sign up and log in users. This was a good learning experience, but it took a lot of effort, and probably wasn't perfectly secure. Today, we'll be learning about some of the tools that django provides that will help us conveniently, securely manage our users. 

### Database setup
> We'll be using postgres for our app today. Let's declare our database in our `settings.py`, and then run the migrations.

```python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'django_auth',
    }
}
```

```bash
python manage.py migrate
```


### The User Model
> Yesterday, we manually created our own model for users, called `AppUser`. Fortunately, django provides a built-in `User` model that provides much of the functionality that we built yesterday. Unfortunately, the default fields on the user model are very generic, and probably don't meet all of our application's needs. We'll need to extend the built-in `User` model to accommodate custom attributes for our application. There are a few options for doing this:
- One option is to use the built-in user model with all of the default settings, and then create another model, called a 'profile model', that has a OneToOne relationship with the `User` model. 
    ```python
    from django.contrib.auth.models import User

    class Employee(models.Model):
        user = models.OneToOneField(User, on_delete=models.CASCADE)
        department = models.CharField(max_length=100)
    ```
- Another option is to create a subclass of django's built-in `AbstractBaseUser` class. This lets us use django's authentication features, but requires us to define all the fields our user needs.
- The third option is to create a subclass of django's built-in `AbstractUser` class. This is a full, functional user model, that we can also extend with custom properties. We'll use this option today to get a balance between convenience and flexibility.

    ```python
    from django.db import models
    from django.contrib.auth.models import (AbstractUser)

    # Inheriting from 'AbstractUser' lets us use all the fields of the default User,
    # and overwrite the fields we need to change
    # This is different from 'AbstractBaseUser', which only gets the password management features from the default User,
    # and needs the developer to define other relevant fields.
    class AppUser(AbstractUser):
        email = models.EmailField(
            verbose_name='email address',
            max_length=255,
            unique=True,
        )
        is_active = models.BooleanField(default=True)

        # notice the absence of a "Password field", that is built in.

        # django uses the 'username' to identify users by default, but many modern applications use 'email' instead
        USERNAME_FIELD = 'email'
        REQUIRED_FIELDS = [] # Email & Password are required by default.
    ```

> Since we're not using the default, built-in User model, we have to tell django which model we're using for our users in the settings.py file.

```python
AUTH_USER_MODEL = 'blog.AppUser'
```

### Sign up, Log in, Log out
> Now that we've defined our user model by extending `AbstractUser`, we can define views that leverage django's built-in authentication functionality. First, let's define some URLs for the views we'll create.

```python
from django.urls import path 
from . import views


urlpatterns = [
    path('signup', views.sign_up),
    path('login', views.log_in),
    path('logout', views.log_out),
    path('whoami', views.who_am_i),
]
```

> Now let's create a view for our sign-up route

```python
from django.views.decorators.csrf import csrf_exempt

from django.contrib.auth import authenticate, login, logout
from .models import AppUser as User


@csrf_exempt
def sign_up(request):
    try:
        body = json.loads(request.body)
        User.objects.create_user(username=body['username'], password=body['password'], email=body['username'])
    except Exception as e:
        print('oops!')
        print(str(e))
    return HttpResponse('hi')
```

> And we'll add a little javascript on the front-end to send the sign-up request.

```javascript
axios.post('/sign-up', {
    username: 'jeffbezos',
    password: 'dragons',
}).then((response)=>{
    console.log('response', response)
})
```

> Django handles all the password hashing in one line of code, which is very convenient. If we want to see what django just created for us, let's look in the database. Notice that their plain-text password is not included in their record. The password field contains their password hash, which also contains the hashing algorithm and the salt, separated by `$`. Some of the other fields are empty, because they exist by default, but we never set them. Some of the fields will be automatically set by django, however. The fields `date_joined` and `last_login` are updated automatically, like you'd expect. The field `is_active` defaults to True. If you need to delete a user, you should set this to False instead of actually deleting the user. Modern applications rarely permanently delete data, but instead mark items as 'deleted' so that they can be ignored by other queries. Especially for users, it's important to never delete their database record, in case they want to reactivate their account, or if they had connections to other users. 

```sql
full_stack_app=# select * from blog_appuser\gx
-[ RECORD 1 ]+-----------------------------------------------------------------------------------------
id           | 1
password     | pbkdf2_sha256$320000$vL9X7Gu4p2DMqgXkS02N55$ekvH4pqodQhbgbW55mCFHHLd1jr/p+mKqw3NOcO6bdQ=
last_login   | 
is_superuser | f
username     | jeffbezos
first_name   | 
last_name    | 
is_staff     | f
date_joined  | 2022-03-16 11:28:07.292569-05
email        | jeffbezos
is_active    | t
```

> If we need to log in an existing user, django provides some functions, `authenticate` and `login`, that help us do that. 

```python
@csrf_exempt
def log_in(request):
    body = json.loads(request.body)
    email = body['email']
    password = body['password']
    
    # remember, we told django that our email field is serving as the 'username' 
    # this doesn't start a login session, it just tells us which user from the db belongs to these credentials
    user = authenticate(username=email, password=password)
    if user is not None:
        if user.is_active:
            try:
                login(request, user)
            except Exception as e:
                print('oops!')
                print(str(e))
            return HttpResponse('success!')
            # Redirect to a success page.
        else:
            return HttpResponse('not active!')
            # Return a 'disabled account' error message
    else:
        return HttpResponse('no user!')
        # Return an 'invalid login' error message.
```

> Logging out is even simpler.

```python
@csrf_exempt
def log_out(request):
    logout(request)
    return HttpResponse('Logged you out!')
```

> If a logged in user sends a request to the server, you can access information about the user at `request.user`. This is much more convenient than manually looking them up from the database.

```python
@csrf_exempt
def who_am_i(request):
    print(dir(request.user))
    if request.user.is_authenticated:
        return JsonRespnse({
            'email': request.user.email
        })
    else:
        return JsonResponse({'user':None})
```

## External Resources
- [django auth docs](https://docs.djangoproject.com/en/4.0/topics/auth/default/)

## Assignments
- Add sign up, login, and log out functionality to these exercises:
  - [To-do List](https://github.com/romeoplatoon/django-to-do)
  - [Event Calendar](https://github.com/romeoplatoon/django-event-calendar)


# Intro to React

## Topics Covered / Goals
- Creating a React application
- Using JSX in React
- Creating React components
- Using state and prop values in components

## Lesson

- [Intro React Slides](https://docs.google.com/presentation/d/1vPNtA6cim4NO9hN0EhRS9Fk4JgGRsMdstUUpcWh9kE8/edit?usp=sharing)

### React Introduction
> React is a front-end framework that was developed by Facebook in 2012 and open-sourced in 2013. React is based on the idea of building reusable components -- this leads to mixing markup with functional logic. This is accomplished through React's hybrid syntax, JSX, which we will dive deeper into later. Up to this point, our views have been relatively simple, and most of the heavy lifting has been done on the back-end with django. With React, it'll be easier to do complex logic and state management on the front-end. 

> Before we just dive right into writing React code, let's get a quick overview of what react is, and how to work with it

#### React Slides
> React is the most popular front end framework in North America, but there are several popular options, such as Angular, Vue, and Svelte.

> Django helped us build MVC applications, where django templates served as the view. Now, we'll no longer be using django templates, and instead we'll use react for our views. 

> React.js by itself is not such a large and complicated library, but it is the center of a complex ecosystem, made up of many other scripts and tools, some of which will get bundled with react itself when we create our first react app today. The first one we'll see will probably be `react-dom`, which is used specifically for interacting with the DOM in browsers. This functionality would be included in React.js itself, but React can actually be used to render views in platforms that don't use the DOM, like mobile devices or 3D scenes, so it makes sense to put DOM manipulation in a separate package. 

##### Webpack
> Two more important tools we'll want to use with react are webpack and babel. As we build our react app, we'll want to organize it into many smaller files that import each other, similarly to how we built our back end with django. However, we can get better performance if our server sends only a few, large, minified files, instead of many smaller files. Webpack will allow us to write our app in an organized way, and then automatically bundle the files together.

##### Babel
> There are many advanced features of javascript that we might want to use in our application that are not yet supported in all browsers. There are also features we want to use in our application that are not natively supported by any browser, such as JSX. Babel is a tool that allows us to write javascript in whatever style we prefer, and then have it automatically converted into a style that all browsers can understand. 

##### create-react-app (CRA)
> Both webpack and babel are fairly complex to configure, but fortunately there are other tools that can abstract away this complexity for us. Create-react-app is a popular npm library that will help us scaffold a react project, similarly to using `django-admin startproject mysite`.

##### Vite
> For this class we will be using a tool called Vite (which means 'fast' in french). This tool will take care of building and managing our app in a quicker and more efficient manner. Similar to create-rect-app it will scaffold a react project for us and give us a dev server to use. 

##### Components
> A defining feature of react applications is the use of component-based architecture. We'll use JSX to write components, and we'll use our components to compose complex applications. The JSX in our components looks like snippets of HTML, but it's actually a syntax extension of javascript. 


### First React App

> Let's get started creating our first React app! Let's run the following commands in our terminal:
```sh
npm create vite
```
> You will then be prompted to enter a project name then select a framework. 
> We will be selecting react.
Once that's done, run:
```
cd vite-project
npm install
npm run dev
```
It's that simple! If everything was set up correctly, you should now have a React server running on port 5173 (default) and a browser should have popped open to a page (http://localhost:5173/) that should look something like this:

<img src="../../page-resources/react_welcome.png" width=640>

This is the default React application rendered view. Now let's go look at the file structure that was created when we created our React app.  

<img src="../../page-resources/react_files2.png" width=120>

There are a few folders and files we should know about:
- ```node_modules/``` = this folder contains all of the downloaded React libraries
- ```src/``` = this folder contains all of the files for our React logic
  - ```main.jsx``` = the main entry point into our application logic
  - ```index.css``` = the main styling for our app's general compnents (fonts, )
  - ```App.jsx``` = the root component in our React application
  - ```App.css``` = the main styling for our React application
- ```index.html``` = the main html file for our application
- ```package.json``` = the additional libraries that we're using for our React application (which is similiar to our Django project's "requirements.txt" file)

You should never have to modify anything in the ```node_modules/``` folder. 

### The "new" React/JSX way

JSX is essentially an intermediary language syntax that allows us to write JavaScript code inside of HTML syntax. This is the same sort of functionality that Django templating syntax offered us when we were working in Django, allowing us to insert Python code into HTML templates. JSX code boils down to become JavaScript code behind the scenes. To insert JS logic in JSX code blocks, we use curly braces `{` `}`, and write JS expressions inside of those blocks. There is some limitation to what JS code we can write with in these blocks, but we'll explore this more later on.


We generally start our modifications in ```src/App.js```. Let's modify our ```App.jsx``` to look like this:

```javascript
// App.jsx

import './App.css';

function App() {
  return (
    <div className="App">
      <h1>Hello World!</h1>
    </div>
  );
}

export default App;
```

The nice thing about the React server is that it'll automatically refresh when changes are detected. Our page should how display "Hello World!". 

**NOTE:** Windows users might have to enter this command to get hot reloading (updating as files change) to work: `export CHOKIDAR_USEPOLLING=true`. I'd uncomment/add this in your `.bashrc` so that you don't have to do it every time you start a container.

> JSX makes it MUCH easier to implement DOM changes dynamically, because we essentially will be writing the HTML that we want to create, inside of our JavaScript file. Let's take a look at creating a simple counter example:

```javascript
// App.jsx

// styling
import './App.css';

// react
import { useState } from "react"

function App() {
  // states
  const [counter, setCounter] = useState(0)

  // event handlers
  const incrementCounter = () => {
    setCounter(counter + 1)
  }

  // render
  return (
    <div className="App"> {/* important: we must always return ONE parent element */}
      <h2 id="my-header">My Button Click Counter App</h2>
      <button id="my-button" onClick={incrementCounter}>Click Me!</button>
      <p id="my-output">You've clicked the button {counter} times.</p>
    </div>
  )
}

export default App; 
```

**IMPORTANT:** A component must always return at most ONE parent element. If you try to return multiple top-level elements, you'll get an error! That's why we've wrapped our button and paragraph elements with a parent div element. 

We've introduced a lot of new items here, so let's unpack it all so that we understand React a little better...


### State Values

React has some magic going on behind the scenes to manage the rendering for our application. As we noted above, the React server will automatically refresh our view when it detects any relevant changes. However, we need to use the appropriate logic so that React will know when something changes. This is the purpose behind using state values. State values are values that are internal to a component, managed by React. In the code snippet above, we created a state value using the ```useState()``` hook. We need to import this hook (i.e. function that hooks into React logic) from the React library:

```javascript
  import { useState } from "react"
```

The ```useState()``` hook function takes in one value, and returns two values:
- INPUT: Initial value for your state value... ```0```
- OUTPUT: The state value, and a function to update the state value... variables: ```counter, setCounter```

```javascript
  const [counter, setCounter] = useState(0) // sets initial value of counter to 0, and returns an updating function for that value
```

**IMPORTANT:** DO NOT MANUALLY UPDATE STATE VALUES DIRECTLY!!!

For our example, we should **always** use the ```setCounter()``` function if we ever need to update the value of ```counter```. This is because React needs to know when our state value is updated, and the ```setCounter()``` function will accomplish this. If we were to update ```counter``` directly ourselves, the value would still change, however React would not know that it's changed, and therefore React will not update our rendered view automatically. If we want to see what problems can occur by updating state values directly, we can try the following modified example:

```javascript
  const incrementCounter = () => {
    counter = counter + 1 // updating a state value directly == BAD!!!
    console.log(counter) // prints out the correct updated value, but our rendered output never updates!
  }
```

While we *can* update values directly without getting an error, we should NEVER update state values directly, as highlighted by the example above. Instead of updating values directly, we should use the state updating function that is returned from ```useState()``` (e.g. ```setCounter``` from our example) 

> One last important thing to mention is that state updates in React are applied **asynchronously**. In other words, our React app will **eventually** apply the new state value that we specify via the state updating function. We can see this if we add in a ```console.log(counter)``` line in our ```incrementCounter()``` function:

```javascript
  const incrementCounter = () => {
    setCounter(counter + 1)
    console.log(counter) // this is still the previous value!
  }
```

Notice how the printed value lags the correct value of ```counter``` by one. Again, this is because the update doesn't take effect immediately! This is something you need to keep in mind, because it can often trip up developers. To answer the question of "When can I know once a state value has been updated (in case I need to respond to it)?", we'll need to learn about the React Component Lifecycle. We'll cover this in a future lecture. 


#### Multiple State Updates

The new code for `incrementCounter` above works for updating our rendering, but it can be improved. To highlight the "problem" that can arise, let's change our code to be this:

```javascript
  const incrementCounter = () => {
    setCounter(counter + 1)
    setCounter(counter + 1)
    setCounter(counter + 1)
    setCounter(counter + 1)
    setCounter(counter + 1)

    // counter will only increment once!
  }
```

What do you think the value of counter will be onces React updates our render? Again, keep in mind that state value updating is asynchronous in React, so this might not do what you expect. We're using the *old* value of `counter` for each update. This means that all 5 lines of code in our function will be setting the same state value... the current "old" value of `counter` plus one. If we want to do this correctly (short of just adding 5 to the counter) with multiple `setCounter` calls, the correct way would be to use a function that will accept the previous "new" value and use that to set the next "new" value for `counter`:

```javascript
  const incrementCounter = () => {
    setCounter(prevCounter => prevCounter + 1) // gets passed the previous NEW value from any previous update (or the current value), and returns the updated NEW value
    setCounter(prevCounter => prevCounter + 1) // ditto
    setCounter(prevCounter => prevCounter + 1) // ditto
    setCounter(prevCounter => prevCounter + 1) // ditto
    setCounter(prevCounter => prevCounter + 1) // ditto

    // counter will increment 5 times (once for each call)
  }
```

As we've seen, the `setCounter` updating function can take in a new state value, *or* a function that accepts a previous state value and returns a new state value! 

### Components

In the code snippet above, `App()` is a React *component*. A component essentially can be thought of as our own custom HTML element. A component must return JSX, which will be used by React to create/update elements for the DOM, a.k.a. rendering the DOM. This is the simplest component that we can create:

```javascript
function App() { // name of component
  return (
    // insert JSX for what you want to be rendered by React to the screen
  )
}

export default App;
```

A full React application will generally contain multiple nested components, each of which should be given their own individual files. To use a component in JSX, we simply use HTML syntax to have it be rendered. Suppose we've created a new component called `MyCustomComponent` in a .js file. We can render it in this manner:

- **components/MyCustomComponent.jsx**
```javascript
// MyCustomComponent.jsx

function MyCustomComponent() {
  return (
    <h2>Hello World!</h2>
  )
}

export default MyCustomComponent;
```

- **App.jsx**
```javascript
// App.jsx

// components
import MyCustomComponent from "./components/MyCustomComponent.jsx"

function App() {
  return (
    <MyCustomComponent /> // rendering our new component, inside of another component
  )
}

export default App;
```

Components allow for easy reusability of logic in React. To see this in action, let's say we want to have multiple button counter instances in our application. Let's create a new component called `ButtonCounter` and relocate some logic from our `App` component:

- components/ButtonCounter.js

```javascript
// ButtonCounter.jsx

// react
import { useState } from "react"

function ButtonCounter() {
  // states
  const [counter, setCounter] = useState(0)

  // event handlers
  const incrementCounter = () => {
    setCounter(counter + 1)
  }

  // render
  return (
    <div>
      <button id="my-button" onClick={incrementCounter}>Click Me!</button>
      <p id="my-output">You've clicked the button {counter} times.</p>
    </div>
  )
}

export default ButtonCounter;
```

- App.jsx

```javascript
// App.jsx

// styling
import './App.css';

// components
import ButtonCounter from "./components/ButtonCounter.jsx"

function App() {
  // render
  return (
    <div className="App">
      <h2 id="my-header">My Button Click Counter App</h2>
      <ButtonCounter />
      <ButtonCounter />
      <ButtonCounter />
    </div>
  )
}

export default App;
```


### Prop Values

Now that we've learned about component state values, let's learn about prop values. Prop ("property") values are values that are passed down to a component, from a parent component. They are akin to providing attribute values to an HTML element, or passing arguments to a function call. To see prop values at play, we'll have to modify our example and include a few more components: 

- **components/ButtonCounter.js**
```javascript
// ButtonCounter.jsx

// react
import { useState } from "react"

// components
import MyButton from "./MyButton.jsx"
import MyOutputLabel from "./MyOutputLabel.jsx"

function ButtonCounter() {
  // states
  const [counter, setCounter] = useState(0)

  // event handlers
  const incrementCounter = () => {
    setCounter(prevCounter => prevCounter + 1)
  }

  // render
  return (
    <div>
      <MyButton handleClick={incrementCounter} /> {/* new component, taking in a prop value of handleClick */}
      <MyOutputLabel myValue={counter} /> {/* new component, taking in a prop value of myValue */}
    </div>
  )
}

export default ButtonCounter;
```

- **components/MyButton.jsx**
```javascript
// components/MyButton.jsx

function MyButton(props) { // notice that we take in a parameter for our functional component, which is an object that captures ALL props that are passed down
  // render
  return (
    <div>
      <button id="my-button" onClick={props.handleClick}>Click Me!</button> {/* access items from props */}
    </div>
  )
}

export default MyButton;
```

- **components/MyOutputLabel.jsx**
```javascript
// components/MyOutputLabel.jsx

function MyOutputLabel(props) { // accept "props" object as the first parameter
  // render
  return (
    <div>
      <p id="my-output">You've clicked the button {props.counter} times.</p> {/* access items from props */}
    </div>
  )
}

export default MyOutputLabel;
```

We've split up our functionality into different components. Our new `MyButton` component handles the input mechanism, and our new `MyOutputLabel` component handles the output mechanism. Our parent component `ButtonCounter` manages the shared data, in this case the value of `counter`. We pass down a prop value down to `MyButton`, that allows `MyButton` to notify that parent of when the button was clicked. We pass down a prop value to `MyOutputLabel` to give it information for the output display. When either a prop value or state values changes, React will automatically trigger a re-render.

**IMPORTANT:** DO NOT MANUALLY UPDATE PROP VALUES DIRECTLY!!!

Much like state values, we should never updated prop values directly or bad things will happen! React is managing our state and prop values, so that whenever they change, React will know to trigger a re-render. But we must tell React when they change:
- state values should only be updated by the updating function returned from `useState()`
- prop values should not be updated by child components

### More Complex Rendering

Our component JSX code can get quite complicated sometimes. We should often opt to create new functions that are called from our component's render logic, to keep things organized. Take a look at the example below:

- **components/MyOutputLabel.jsx**
```javascript
// components/MyOutputLabel.jsx

function MyOutputLabel(props) { // accept "props" object as the first parameter
  // render
  const renderOutput = () => {
    console.log(">> internal counter value: ", props.counter)

    if (counter == 0) {
      return "You haven't clicked the button yet!"
    }
    
    const maxCount = 10
    if (counter > maxCount) {
      return `You've clicked the counter more than ${maxCount} times. I'm not counting anymore.`
    }

    return `You've clicked the button ${props.counter} times.`
  }
  
  return (
    <div>
      <p id="my-output">{ renderOutput() }</p> {/* calling a function here */}
    </div>
  )
}

export default MyOutputLabel;
```

### More Complex State Updating

**IMPORTANT:** DO NOT MANUALLY UPDATE STATE AND PROP VALUES DIRECTLY!!!

It gets slightly more tricky to update non-primitive data types, but nothing that we can't handle. Just remember that we should never be updating state (and prop) values directly. So what do we do if we have an array as a state value?

```javascript

import { useState } from "react"

function App() {
  // states
  const [myData, setMyData] = useState([5, 3, 2])

  // event handlers
  const appendData = () => {
    let newNum = Math.floor(Math.random() * 20)
    let newData = myData
    newData.push(newNum)

    setMyData(newData) // why won't this work? (render doesn't update properly)
  }

  // render
  const renderData = () => {
    let elements = []
    for (let i = 0; i < myData.length; i++) {
      elements.push(<li key={`${i}`}>myData[i]</li>)
    }

    return elements
  }

  return (
    <ul>
      { renderData() }
    </ul>
  )
}
```

The code above won't behave the way we intend. Can you guess why?

Answer: We're modifying our state value (`myData`) when we push our new number into `newData`. Note that `newData = myData` doesn't actually create a brand new copy of our original value!! We need to create an actually brand new copy of our data locally, modify it, and then pass it along to our state updating function, like this:

```javascript
  const appendData = () => {
    let newNum = Math.floor(Math.random() * 20)
    let newData = [...myData, newNum] // use the magic spread operator!

    setMyData(newData) // this works! (render updates properly)
  }
```

## Student Challenge

Let's get some practice with creating a simple React app that uses state (and maybe prop) values. Your challenge will be to create a React application that counts the number of vowels in a word and highlights each vowel in the output: [Vowels Challenge](https://github.com/quebecplatoon/react-vowels)

## External Resources
- [React Docs and Tutorials](https://reactjs.org/docs/getting-started.html)

## Assignments
- [Vowels](https://github.com/romeoplatoon/react-vowels) ...from lecture
- [Detention](https://github.com/romeoplatoon/react-detention)
- [State Abbreviator](https://github.com/romeoplatoon/react-state-abbreviator)



# React Workshop

As a class we will work through Facebook's excellent [official React intro and tutorial](https://reactjs.org/docs/hello-world.html), 
and their ["Thinking In React"](https://reactjs.org/docs/thinking-in-react.html) guide.

However we will be building the learning projects in those guides using [functional components](https://reactjs.org/docs/components-and-props.html) instead of class-based components, as the community is shiftting to functional components as the the norm.

## Assignments
- [Mute Button](https://github.com/romeoplatoon/react-mute-button)
- [Whack-A-Mole](https://github.com/romeoplatoon/react-whack-a-mole)
- [Palindrome](https://github.com/romeoplatoon/react-palindrome)
- [Doors Game](https://github.com/romeoplatoon/react-doors-game)

# News Site I

## Topics Covered / Goals
- Planning and creating a React application
- Functional vs class-based components
- Passing down data and functions as props
- React Bootstrap


## Lesson
Today begins a string of lessons involing the 'News Site' project. This is something that we'll be going over together during the lectures for the next few days, as well leave it for you to complete on your own as your daily assignment. The goal of this project is just to understand and get comfortable with using React to develop the front end of a website. 


### Project Setup

- start a basic react project with `npm create vite`
    - `npm` will install and run an npm module if you don't have it, or just run it if you've already installed it
    - `npx` seems to not recognize `npx create vite` if the package is not installed already but `npx vite` seems to trigger the install.
    - or you could just install it manually first `npx install vite`
- delete unnecessary boilerplate
- copy data over
    - eventually, we'll use the hackernews API to provide news articles for our app. For now, we'll use some hard-coded sample data in `news.json`. 
- create folder/files for components

### Components
- App: top level component that contains all other components
    - The App tracks all the state for the other components (in this demo).
- ArticleTeaser: a preview of an article, with a headline and a date
    - accepts `id`, `title`, `createdDate`, and `handleTitleClick`
    - accepts a function as a prop. remember the difference between a function call and function reference
- Article: the actual article, with content and images
    - has many props. use spread syntax.
    - conditional rendering. There are a few different ways to do this in react
- AppNav: the navigation bar with links
    - list rendering. create a nav link for each item in the navItems array. 

## Component I: AppNav
The `AppNav` component should accept the following `props`:
1. `navItems` - an array of navItem objects.
2. `handleNavClick` - a function.

The `AppNav` component should return a `<nav>` component that contains `<a>`'s as children - one for every item in the `props.navItems` array.

The AppNav component should:
1) Map through `props.navItems` to create an array of `<a>` elements. The objects within `props.navItems` look something like this:
```
{
  label: "NYREGION",
  value: "nyregion"
}
```
When transforming/mapping the `nav` item objects in `props.navItems` into an array of `<a>` tags, you'll want to use the `label` property (displayed in the example above) as the text that appears on screen. At the same time, you will want to attach an event handler to each `<a>`'s `onClick` event. `onClick` should call `props.handleNavClick`, and pass the 'value' property from the `nav` item object.

**You are done when all of your data is displayed and your `onClick` events are firing for your AppNav links and your ArticleTeaser links (i.e. you should see the `console.log`s)**

## Component II: ArticleTeaser
The `ArticleTeaser` component should accept the following `props` from `App.js`:
1. `id` - a number
2. `title` - a string
3. `created_date` - a string
4. `handleTitleClick` - a event handling function

All of these `props` will always be passed in.

The `ArticleTeaser` component should:
1. Display the `title` inside of an `<a>` tag.
2. When the `title` `<a>` tag is clicked, it should call `props.handleTitleClick(props.id);`. Will arrow functions be useful here?
3. Display the `created_date` in a `<p>` tag.


## Component II: Article
In `App.jsx`, you'll notice that when the `Article` component is rendered, we pass `{...article}` to the component. This is known as the spread syntax. You can read more about it [here](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax). Rather than passing the entire `article` object, we are spreading its properties to be passed down via `props`.
Therefore, the `Article` component should accept the following `props`:
1. `title` - a string
2. `created_date` - a string
3. `abstract` - a string
4. `byline` - a string (optional)
5. `image` - a url string (optional)

The `title`, `abstract`, and `created_date` `props` will always contain values. `image` and `byline` may be set, but they may also be null. Be sure to account for this.

The `Article` component should:
1. Display the `title` inside of an `<h1>` tag.
2. Display the `created_date` in a `<p>` tag.
3. Display the `byline` (if it exists) in an `<h2>` tag.
4. Display the `image` (if it exists) in an `<img>` tag (the value of `image` should be set to the `src` attribute of the `<img>` tag).
5. Display the `abstract` inside of a `<p>` tag.

#### Sidenote: Conditional rendering in React
How do I only render something if the data exists? There are several ways we can handle this in React. Here we will explore three common options:

**Option 1: `&&`**

```javascript
// in the render
<ParentComponent>
  {dataExists && <ChildComponent>}
</ParentComponent>
```
Explanation: If there is just one piece of data we're checking for, we can do a quick existence check which will coerce the data to a boolean value `true` if the data does exist and then render the component/element that follows `&&`. If the data doesn't exist, it will be coerced to a boolean value `false` and will not render the child component/element.

**Option 2: Create a helper render function**

```javascript
const renderIfDataExists = () => {
  if (dataExists) {
    return <ChildComponent />
  }
};

// in the render
<ParentComponent>
  { renderIfDataExists() }
</ParentComponent>
```
Explanation: This is a common pattern for rendering that involves more complex logic. For example, if our `dataExists` check was looking for multiple pieces of data, we might want to extract it out into this helper function.

**Option 3: Use a ternary operator**
```javascript
<ParentComponent>
  { dataExists ? <ChildComponent /> : '' }
</ParentComponent>
```
Explanation: This is a good option to use if you are choosing between two different components/elements to render, but you can technically just render an empty string or `null` as seen above.



### React-bootstrap
> It's easy to use bootstrap in our react app the same way we have been using it already. We could load bootstrap's CSS and JS in our index.html, and define a react component that uses those bootstrap classes. 

```javascript
function MyButton(props) {
  return (
    <button type="button" class="btn btn-primary">{props.buttonText}</button>
  );
}
```

> There's nothing wrong with this approach, but it turns out that other people have already done this work for us. We can use react-bootstrap to import bootstrap components as pre-built react components, instead of constructing them with HTML. Let's install react-bootstrap (and regular bootstrap) with `npm install react-bootstrap bootstrap`, then let's [read the docs](https://react-bootstrap.github.io/getting-started/introduction) to figure out how to use it. 

## External Resources
- [React Bootstrap](https://react-bootstrap.github.io/getting-started/introduction)


## Assignments
- [News Site I](https://github.com/romeoplatoon/react-news-site-i)
- [MadLibs](https://github.com/romeoplatoon/react-mad-libs)



# News Site II

## Topics Covered / Goals
- Use client side routing / React router
- Use Bootsrap components


## Lesson
- News Site II (see assignment list)

### Article list component
> Instead of just viewing one random article, a user should be able to view a list of article teasers, and then click one of them that they want to read. 

> Let's create a component for the home page that will list our articles

```javascript
import "./articleList.css"
import ArticleTeaser from '../ArticleTeaser/ArticleTeaser.js';


function ArticleList(props) {
  return (
    <ul id="articles">
      { 
        props.articles.map((article, index) => (
          <li key={index} className={index % 2 ? "odd-item" : "even-item"}>
            <ArticleTeaser { ...article } id={ index + 1 } />
          </li>
        ))
      }
    </ul>
  )
}

export default ArticleList;
```

### React-router
> When we click a link in our list, we want the page to refresh and show the article. We need to use react-router so that we can 'change the page' without losing application state. From the server's perspective, we're still on the same page, but to the user, they are moving to different pages on your site. 

> For now, we'll need at least two pages. The home page will have a list of articles, and then we'll have another page for viewing an individual article.


[React Router](https://reactrouter.com/docs/en/v6) is a popular open source library that's used to control routing in a single page app. Using this library, you can load `component`s based on URL paths. For example, you can configure React Router to load ComponentX when the URL `http://localhost:3000/#/componentx` is requested.

To utilize React Router, let's install:
```sh
$ npm install react-router-dom --save
```

In `App.js`, bring in the necessary libraries from the package you just installed:

```javascript
import { HashRouter as Router, Routes, Route } from 'react-router-dom';
```

Let's rewrite our `render`:
```javascript
return (
  <div>
    <h1>AppNav Component</h1>
    <hr />
    <AppNav navItems={navItems} handleNavClick={(clickedItem) => console.log(clickedItem)} />
    <Router>
      <div>
        <Routes>
            <Route path="/" element={<HomePage />} />
            <Route path="/articles/:articleID" element={<ArticlePage />} />
        </Routes>      
      </div>
    </Router>
  </div>
);
```


## ArticlePage Component
The `ArticlePage` component should render the `Article` component, and provide the necessary props to the child component. If you remember, `Article` accepts a variety of props from a single article object in `src/data/news.json` array. In order to determine the array object to use, we need to obtain the params from the router logic. To do this, we can employ the `useParams()` hook. The index you'll want to target within the articles array will be contained within `params.articleID`, which corresponds to `[articleID]` portion in this URL: `http://localhost:3000/#/article/[articleID]`

__useParams()__

You can use the `useParams` hook to retrieve dynamic params from the current URL (ex: `articleID`) that were matched by the Route Path.

Example for url: http://localhost:3000/#/articles/:articleID
```js
import { useParams } from 'react-router-dom';

const ArticlePage = () => {
  let { articleID } = useParams();

  return (
    <div>
      <div>Article Page</div>
      <div>Article ID: { articleID }</div>
    </div>
  )
}
```

## HomePage Component

The one piece of functionality left to complete is the `handleTitleClick` function being passed into the `ArticleList` `component`. Ultimately, this function should trigger a page change. React Router automatically passes a series of routing-related props to the `HomePage` `component`. 
We can use the `Link` component from `react-router-dom` to manually navigate to a route path. Ultimately, this should look something like 

```js
import {Link} from "react-router-dom";

  <Link to=`/articles/${articleID}` > title </Link>

```

`articleID` corresponds to the index of an item in the articles array, and is a parameter already being passed into this function. You should be able to click links in your homepage and be able to hit different urls that correspond with the article that you clicked.



### hash-router vs browser-router
> Normally, whenever the URL changes, your browser sends a GET request to that new URL. However, by default, if the URL contains a `#`, then anything that changes after the `#` is not considered a new server-side route, and so no data is sent to the server. This is used for client-side routing to elements with a specific id. You can access this information from javascript with `window.location.hash`. hash-router extends this concept, and uses the value of `window.location.hash` to load different components, which will serve as the pages of our website.

> Another option for client-side routing is the browser-router. This approach doesn't leave a `#` in the URL, and instead uses extra javascript to avoid making requests to the server when the URL changes. Using the browser router can cause a variety of bugs to occur in your application, because there will be some situations where client-side URLs will accidentally get sent to the server. When a user refreshes the page or just types a URL directly into the URL bar, that request will go to the server, and your server needs to be prepared to handle that request gracefully. Also, many modern browsers don't even show the full URL by default, so the sole benefit of the browser router is often irrelevant. 



## Assignments
- [News Site II](https://github.com/romeoplatoon/react-news-site-ii)
- [Hangman](https://github.com/romeoplatoon/react-hangman)



## Django ORM Review
We are good to build a library program! It will allow patrons to check books out of the library, and librarians to add new books.

We will use Django, and possibly a little Javascript (just axios) on the frontend. 

We will not worry about the prettiness of the user interface and focus on functionality.

### Features

- View a list of books: 
	- View all books written by a particular author
	- View all books belonging to a particular genre

- A patron can check and return a book.
	- Ability to check out a copy of a book, if it is available
	- Ability to return the copy of a book they checked out
	- A "book" could be:
		- A paperback
		- A hardcover
		- An ebook
		- An audio book
	- The system will track when a book is checked out
	, and when a book is returned

- A patron can view all the books they've checked out

- A patron can view their history - what books they've previously checked out & returned

- Librarians can add new copies of books & book-related data to the system. NOTE: Our library is very liberal -- anyone can be a librarian! No authentication necessary.
	- Create/Delete a genre
	- Create/Delete an author
	- Create/Delete information about a book
	- Add another copy of a book (paperback, hardcover, ebook, or audiobook) to the system
	

### Implementation Plan

1. First we will talk through the program as a group. We will discuss our data model and create a diagram to document it.

2. We will develop a list of tasks to build our site. We will develop *iteratively*. We will pick the smallest possible feature we can build end-to-end (both the user interface). *We may even break a feature down into smaller pieces to implement*. 

3. We will work through our list of tasks, group-coding style. The instructor will "drive", and the class will do most of the navigation.

# News Site III

## Topics Covered / Goals
- Continue to build upon News Site project
- Component Lifecycle
  - Each React component has a lifecycle and understanding the component lifecycle will help you understand the data flow in your app.
  - Lifecycle methods determine what is executed at what time in the component's lifecycle.
  - React hooks (useEffect) are the new way to implement lifecycle methods into functional components.



## Lesson

Today, we're going to be learning the React Component Lifecycle, and to understand this better, we'll first be using class-based components (and then later moving back to functional components) 

**Component Lifecycle**
Let's talk through a concept called the "Component Lifecycle" for React. Below we are start with a component in its natural state:

`App.js`
```javascript
import './App.css';
import { Component } from "react"

class App extends Component {
  // render
  render() {
    return (
      <div className="App">
        <h2>Lifecyle App</h2>
      </div>
    );
  }
}

export default App;
```

Let's add some functionality, and add in a `Something` component that will be created/updated/destroyed inside of our application:

### Component Creation (componenetDidMount())

`App.jsx`
```javascript
import './App.css';
import { Component } from "react"
import Something from './components/Something';

class App extends Component {

  // render
  render() {
    return (
      <div className="App">
        <h2>Lifecycle App</h2>
        <hr />
        <Something />
      </div>
    );
  }
}

export default App;
```

`components/Something.jsx`
```javascript
import { Component } from "react"

class Something extends Component {
  
  // effects
  componentDidMount() {
    console.log("componentDidMount: I AM ALIVE NOW!")
  }

  // render
  render() {
    return (
      <div>
        This is something
      </div>
    )
  }
}

export default Something;
```

> If we check our console in the browser we might notice that the our app logs twice. Our component will only mount once but the `<React.StrictMode />` component in `main.jsx` causes this behavior. `StrictMode` puts additional checks on our application while developing to detect unexpected side effects 
[StrictMode docs](https://reactjs.org/docs/strict-mode.html#detecting-unexpected-side-effects)


### Component Destruction (componentWillUnmount())


`components/Something.jsx`
```javascript
class Something extends Component {
  
  // effects
  componentDidMount() {
    console.log("componentDidMount: I AM ALIVE NOW!")
  }

  componentWillUnmount() {
    console.log("componentWillUnount: I AM DYING NOW!")
  }

  // render
  render() {
    return (
      <div>
        This is something
      </div>
    )
  }
}
```


`App.jsx`
```javascript
class App extends Component {

  state= {
    exists:false,

  }

  // render
  render() {
    return (
      <div className="App">
        <h2>Lifecycle App</h2>
        <hr />
        <button onClick={() => this.setState({exists: true})}>Create</button>
        <button onClick={() => this.setState({exists: false})}>Delete</button>
        
        
        <Something />
      </div>
    );
  }
}

export default App;
```


### Component Update (componentDidUpdate())

`App.js`
```javascript
import './App.css';
import { Component } from "react"
import Something from './components/Something';

class App extends Component {
  // states
  state = {
    exists: false,
    someValue: 0
  }

  // render
  render() {
    return (
      <div className="App">
        <h2>Lifecycle App</h2>
        <hr />
        <button onClick={() => this.setState({exists: true})}>Create</button>
        <button onClick={() => this.setState({exists: false})}>Delete</button>
        <button onClick={() => this.setState({someValue: Math.random() * 100})}>Update</button>

        <hr />
        { this.state.exists && <Something value={this.state.someValue} /> }
      </div>
    );
  }
}

export default App;
```

`components/Something.js`
```javascript
import { Component } from "react"

class Something extends Component {
  
  // effects
  componentDidMount() {
    console.log("componentDidMount: I AM ALIVE NOW!")
  }

  componentWillUnmount() {
    console.log("componentWillUnount: I AM DYING NOW!")
  }

   componentDidUpdate(prevProps, prevState) {
    if (prevProps.value !== this.props.value)
      console.log("componentDidUpdate: I AM UPDATING NOW!")
  }

  // render
  render() {
    return (
      <div>
        The value is { this.props.value }
      </div>
    )
  }
}

export default Something;
```

We've added in a few common [lifecycle methods](https://reactjs.org/docs/react-component.html#the-component-lifecycle) that comes built into React Components. These lifecycle methods basically allow you to hook into a component at that specific point in their "life" to achieve various things. Keep in mind that these methods are only available for class-based components!

Here's a visual diagram of many of the lifecycles methods that can exist in a class-based component:
<img src="../../page-resources/react_lifecycle.png" width=640>

[Lifecycle method diagram](http://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/).

The three main lifecycle methods to focus on are:
- `componentDidMount` ...which is called right after a component has been initially rendered to the screen. This method is most commonly used when you want to make an initial call out to your API. 
- `componentDidUpdate` ...which is called right after the component re-renders due to a state or prop value being updated. 
- `componentWillUnmount` ...which is called right before the component is being taken off the screen.

These methods allow us to access the component at various points in its lifecycle. But our focus going forward is going to be functional components, which don't have these lifecycle methods... so how do we accomplish the same capabilities in functional components? The answer: [`useEffect()`](https://reactjs.org/docs/hooks-effect.html). You can think of the `useEffect` Hook as `componentDidMount`, `componentDidUpdate`, and `componentWillUnmount` all combined into one function! Let's take a look at how our previous example would look converted to a functional component:

`components/Something.js`
```javascript
import { useEffect, useRef } from "react"

function Something(props) {
  // refs
  let firstRender = useRef(true)

  // effects
  useEffect(() => { // the ordering of the useEffect matters here, because firstRender.current is set to false in the second useEffect
    if (!firstRender.current) {
      // componentDidUpdate()
      console.log("componentDidUpdate: I AM UPDATING NOW!")
    }
  }, [props.value])
  
  useEffect(() => {
    // componentDidMount
    console.log("componentDidMount: I AM ALIVE NOW!")
    firstRender.current = false
    
    // componentWillUnmount
    return () => console.log("componentWillUnmount: I AM DYING NOW!")
  }, [])

    
  // render
  return (
    <div>
      The value is { props.value }
    </div>
  )
}

export default Something;
```

Another example of `useEffect`:

```javascript
import React, {useState, useEffect} from 'react';
import './App.css';

function App() {
  const [titles, setTitles] = useState(null)
  const [makeAPI, setMakeAPI] = useState(false)

// useEffect is called when the functional component has mounted and when certain state data is updated
  useEffect(() => {
    if (makeAPI) { // the makeAPI state variable is initially FALSE
      getPhotosAPI()
    }
  }, [makeAPI]) // useEffect will only execute again if the makeAPI variable changes

  // getTitles functions sets the makeAPI state variable to TRUE
  const getTitles = () => {
    setMakeAPI(true)
  }

  // Makes a Fetch request to the API and then sets the returned data to state 'titles'
  const getPhotosAPI = async () => {
    let response = await fetch('https://jsonplaceholder.typicode.com/photos')
    let data = await response.json()
    setTitles(data)
  }

  // showTitle function accepts the titles state as an argument and maps through
  const showTitles = (titles) => {
    console.log(titles)
    let articleTitles = []
    titles.map((title, index) => {
      return articleTitles.push(
        <div key={index}>
        <img src={title.thumbnailUrl} alt={`color-${index}`}/>
        <p >{title.title}</p>
        </div>
        )
    })
    return articleTitles
  }

  return (
    <div className="App">
      <h1>Using the useEffect Hook</h1>
      {
        titles
        ?
        <h2>Finished Loading</h2>
        :
        <div>No Titles</div>
      }
      {
        titles && <div>{showTitles(titles)}</div>
      }
      <div>
        <button onClick={getTitles}>Get Titles</button>
      </div>
    </div>
  );
}

export default App;
```

---

# News Site III

## Change NavBar

`AppNav`
```js
import { useState } from 'react';
import { Navbar, Nav } from 'react-bootstrap';
import sections from '../../data/sections.json'
import "./appNav.css"

function AppNav(props) {
  const [navItems, setNavItems] = useState(sections)

  return (
    <Navbar className="bar">
      <Navbar.Brand>
        <img src="https://www.codeplatoon.org/wp-content/uploads/2018/10/CP-logo-2018-abbrev-1.png" width="60" />
        Code Platoon News
      </Navbar.Brand>
      <Nav>
      {
        navItems.map((navItem, index) => {
          return (
            <Nav.Link key={index} onClick={() => console.log(navItem.value)}>
                { navItem.label }
            </Nav.Link>
          )
        })
      }
      </Nav>
    </Navbar>
  )
}

export default AppNav;
```
> from news site III exercise
## The Section Page
The Section Page will be used to display articles that belong to a specific section (specifically, "World", "Science",  or "Books").  The Section Page should be loaded when a user clicks on one of these options in the top navigation.

The route that should display a section page should be `/sections/:sectionName`, where the `:sectionName` parameter would be one of the supported sections (listed above). For example, Clicking on the "World" link in the top navigation would redirect to http://localhost:5173/sections/world - this page would only display articles whose "section" property is set to "world".

To accomplish this, you will need to:

1. Create `SectionPage.js` inside of `src/pages`
2. Create a new route (`/sections/:sectionName`) in App.js which points to the `SectionPage` component
3. Obtain the `sectionName` from the url using `useParams()`
4. Within `SectionPage.js`, utilize the `filter()` function to retrieve articles by a specific section, and store them in a state value (`articles`). Remember, we'll be using `useEffect` here, just like we did for our HomePage component. 
5. Pass `articles` into the `<ArticleList>` component, thereby rendering the `ArticleList` with articles for the desired section. 

Attempt to navigate to **http://localhost:5173/#/sections/world**, and confirm that this is showing you the appropriate content. We should only see news articles that have a section value of "world".

## Section Links in `AppNav.js`
Now we need to update our AppNav component to use the new route that we added. We'll be using the Link component from the React Router, just like before, to facilitate internal navigation within our application. 

Attempt to navigate from the home page to a section page, using the AppNav links. Verify that we are taken to the correct page and showing the appropriate content.

Attempt to navigate from one section page to another section page, using the AppNav links. Uh-oh, there seems to be some issue here! While our url changes to the correct location, our content remained the same! Why would this be?? 

As we've mentioned before, React smartly only update the page contents when it knows something has changed. In this case, we're going from one section page to another, so the SectionPage component doesn't need to be removed from the view, and thus React keeps the previous one that was in use. However, React doesn't know anything need to change, because the render is only relying on the internal state values (in this case, `articles`). 

We need to get a new set of articles for the new section. How can we do this? This is where the component lifecycle concepts come into play. Our component need to react to an update, in this case, from the url. We will need to use `useParams` to figure out the new section value, and use that to get a new collection of articles. 



## Article Search

Let's add the ability to search for articles on the Home Page.  In order to accomplish this, the high-level things we need to build are:

1. Add a new function that accepts a search term, and returns a list of articles with that term in their title.
2. Add an input box to the `src/pages/HomePage` component that calls the function above, and updates state.
3. Add a new state value to track the search text. 


**HomePage.js**

As mentioned above, you will want to add a text input to the `HomePage`.  Why not use React Bootstraps's nicely styled text input? (Remember that you'll need to import all of these new libraries from `react-bootstrap` at the top of your file!) Go ahead and put this above your `<ArticleList>` component:

```javascript
<InputGroup>
  <InputGroup.Text>Search</InputGroup.Text>
  <FormControl placeholder="by Title" onChange={handleSearch} />
</InputGroup>
```

Note that we've provided the method that should be called from the `onChange` event - it's a class method called `handleSearch()`. 
Create the `handleSearch()` class method on the `HomePage.js` component. Within this event handler, you should:
1. Extract the value of the text input and set it to a new state value (`searchTitle`)
2. Update our useEffect() dependency array to include `searchTitle`

If these steps are completed successfully, the list of articles displayed on the home page should change as you interact with the text box.




## External Resources
- [State & Lifecycle](https://reactjs.org/docs/state-and-lifecycle.html)
- [Conditional Rendering](https://reactjs.org/docs/conditional-rendering.html)

## Assignments
- [News Site III](https://github.com/romeoplatoon/react-news-site-iii)
- [Temperature Conversion](https://github.com/romeoplatoon/react-temperature-conversion)



# News Site IV

## Topics Covered / Goals
- Asynchronous JavaScript review
- Working with Promises review
- Using axios

## Lesson
Today, we are going to add an API integration to our news website. 

## Getting Data from an API
Up to this point, we've been building our website using static data that exists within our app. Let's first grab our completed `news-site-iii` and keep it nearby. We'll need it soon. We have been importing our News from `/data/news.json` and passing it into our ArticleList component. That's okay for right now, but we want to have dynamic data being fetched from an API. 

Today's challenge isn't going to be a ton of React. Instead it's mostly using JavaScript to connect with an API and use the returned data in our app, presenting in a React Component. Once we get our news data from the external data source (our API), we will put it in our HomePage and ArticleList components.

## Asynchronous Code
When you are writing pieces code that are independent from one another, writing them asynchronously allows them to run in parallel which could make your code run much faster.

Some examples of asynchronous functions:
- setTimeout(()=>{}, 10000)  <=== call function after 10 seconds have passed
- setInterval(()=>{}, 10000) <=== call function every 10 seconds

## Promises
Now, let's talk about Promises. A [Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) in JavaScript is a construct that specifies a future returned value. 

Let's consider a program that simulates some real world action. I think it's a great time to grab some cereal, so let's do it:

```javascript
let washDishes = () => { 
    return new Promise((onSuccess, onFailure) => {
        setTimeout(() => onSuccess("We washed a bowl and spoon!"),15000)
    }); 
}

let pourCereal = (result) => { 
    console.log(result);
    return new Promise((onSuccess, onFailure) => {
        setTimeout(() => onSuccess("We poured some cereal!"), 3000)
    }); 
}

let pourMilk = (result) => {
    console.log(result);
    return new Promise((onSuccess, onFailure) => {
        setTimeout(() => onSuccess("We poured some milk!"), 3000)
    });  
}

let eatBreakfast = (result) => { 
    console.log(result);
    console.log("Now we can eat!");
}

let goHungry = (error) => {
    console.log(error)
    console.log("I’m still hungry!!!");
}

washDishes()
    .then(pourCereal, goHungry) 
    .then(pourMilk, goHungry)
    .then(eatBreakfast, goHungry);
```

Notice how we are able to chain Promises together, via the then() method. The then() method gets called once a Promise is resolved (either fulfilled or rejected). The then() method can create another Promise and continue the chain.

You can also write the chain to handle any error with the same handler function, via a catch():

```javascript
// ...from above

washDishes()
    .then(pourCereal) 
    .then(pourMilk)
    .then(eatBreakfast)
    .catch(goHungry); // this catch will handle any onFailure's
```

### Using async-await instead of .then() construct

Instead of using chained then()s, there's an alternative design that you can employ, using the `async` and `await` keywords in JavaScript. The one caveat is that you need to create a parent async function. 
The keyword async before a function makes the function return a promise
Let's take a look:

```javascript
async function prepBreakfast() {
    let washDishes = () => { 
        return new Promise((onSuccess, onFailure) => {
            setTimeout(() => onSuccess("We washed a bowl and spoon!"), 15000)
        }); 
    }

    let pourCereal = (result) => { 
        console.log(result);
        return new Promise((onSuccess, onFailure) => {
            setTimeout(() => onSuccess("We poured some cereal!"), 3000)
        }); 
    }

    let pourMilk = (result) => {
        console.log(result);
        return new Promise((onSuccess, onFailure) => {
            setTimeout(() => onSuccess("We poured some milk!"), 3000)
        });  
    }

    let eatBreakfast = (result) => { 
        console.log(result);
        console.log("Now we can eat!");
    }

    let goHungry = (error) => {
        console.log(error)
        console.log("I’m still hungry!!!");
    }

    try { 
        let result = await washDishes();
        result = await pourCereal(result);
        result = await pourMilk(result);
        return eatBreakfast(result);
    }
    catch(error) {
        return goHungry(error);
    }
}

prepBreakfast();
```

The `await` keyword will make the excution wait for completion before proceeding to the next line. In the case of Promises, `await` will wait until the Promise is resolved and then will proceed. <ins>**Remember: You can only use the `await` keyword in functions that are marked with `async`**</ins> (otherwise you'll get an error). As we've discussed before, JavaScript is a single-threaded programming language so `await` doesn't actually halt (or "block") your entire application's execution. `async` functions behave differently than normal functions, because we are simulating asynchronous execution via `await`. Also, one key thing to remember is that `async` functions actually always return Promises (return values will automatically be converted to Promises!). And to be safe, we should always wrap our awaits in a try-catch in case something goes wrong.

## Axios
Now let's talk about axios, which can be used to retrieve things from web resources. A call to `axios.get` returns a Promise that will resolve to a Response object. We process this [Response](https://developer.mozilla.org/en-US/docs/Web/API/Response) object to get the data that we expect back from our fetch request.  


```
npm install axios
```

Next, let's create 3 functions:
- `fetchArticleByID(id)` - given an article ID, returns an Article object with the given ID.
- `fetchArticlesBySection(section)` - returns a list of articles whose `section` attribute matches the section argument.
- `fetchArticles(filters)` - returns a list of articles. The filters argument is optional - if no filters are provided, an array of all the articles are returned. If filters are provided, an array of Articles that meet the criteria are returned.




> create `src/api/ArticlesAPI.js`

`ArticlesAPI.js`
```js
const fetchArticleByID = (articleID) => {
};

const fetchArticlesBySection = (section) => {
};

const fetchArticles = (filters = null) => {
};

export default {
  fetchArticleByID,
  fetchArticles,
  fetchArticlesBySection
};
```

## Integrating ArticlesAPI.js into your App
At the moment, there is one component that is importing the json data and that is App.jsx
We might want to have each page consume its own data instead of keeping it in the `App.jsx` component but we can do that later. We can start in our main app file first.

For this, we want you to use async/await.
- To make API calls to outside resources within your React app, you have to use axios to make `get` requests
- axios is asynchronous (i.e., not synchronous / happening out of order)
- `axios.get` returns a Javascript `Promise` object. These `Promise` objects are basically Javascript's immediate response to you, saying "Hey I have received your request. I `Promise` to respond when I can."
- `Promise` objects must be resolved in order to get to the data using the`async/await` functionality built into Javascript
- Error-handling: whenever calling out to an API, there is always a possibility of an error occuring. To handle this error on the client-side and give our user proper feedback, we'll tack on a [.catch()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/catch) at the end of our promise chain or you can put the api call in a `try{}` and catch errors with `catch(error){}`

[HackerNews API docs](https://hn.algolia.com/api)

> Example of calling the api

```js
const [someDataFromAnAPI, setSomeDataFromAnAPI] = useState(null)

  const CallAPI = () => {
    return axios.get('http://hn.algolia.com/api/v1/search_by_date?tags=story') //gets latest stories
  }
  async function getData() {
      try {
        const jsonResponse = await CallAPI()
        setSomeDataFromAnAPI(jsonResponse)
        console.log(jsonResponse)
      } catch (error) {
        console.error('Error occurred fetching data: ', error);
      }
    }
    
  useEffect(() => {
    getData()
  }, [])
  ```

  > The call could also be written like 
  ```js
  const CallAPI = () => {
    return axios.get('http://hn.algolia.com/api/v1/search_by_date', {
          params:{
            tags: ('story'),
            hitsPerPage:50
          }
    } )
  }
  
```
> get stories before a certain date
```js

let date = Math.floor(Date.now() / 1000) - 86400 //24hrs ago
axios.get('http://hn.algolia.com/api/v1/search_by_date?', {
          params:{
            tags: ('story'),
            hitsPerPage:50,
            numericFilters: `created_at_i<${date}` //news before 24hs ago
          }
    } )
```
#### API Calls

- fetchArticleByID: 
```js 
axios.get('http://hn.algolia.com/api/v1/search_by_date?', {
          params:{
            tags: (`story_$storyID`),
            hitsPerPage:50,
          }
    } )
```
    
- fetchArticles(filters):
```js
axios.get('http://hn.algolia.com/api/v1/search_by_date?', {
          params:{
            tags: ('story'),
            hitsPerPage:50,
            query: ('power', 'phone')
          }
    } )
```

- fetchArticlesBySection: 
```js
axios.get('http://hn.algolia.com/api/v1/search_by_date?', {
          params:{
            tags: (`${section}`),
            hitsPerPage:50,
            query: ('power', 'phone')
          }
    } )
```

The final goal is to recreate the [hackernews website](https://news.ycombinator.com/)

- Complete the three api functions: `fetchArticleByID`,`fetchArticles`, and `fetchArticlesBySection`
- Update the `data/sections.json` file to have sections that match the HN site
- Integrate the above api consumption pattern fully into your page files `src/pages/HomePage.js` , `src/pages/ArticlePage.js` and `src/pages/SectionPage.js` so that they are functional and each fetch the data related to them
   - this will probably mean refactoring the child components as well to work with our new pattern

- Styling


## Assignments
- [News Site IV](https://github.com/romeoplatoon/react-news-site-iv)


## News Site VI

## Topics Covered / Goals
- review of hooks
    - useState()
    - useEffect()
    - 
- review of apis
    - axios defaults
    - making api calls
- continue working on the news site

## Lesson
- Today we will be doing some review and working further on our site



# Full-stack App

## Lesson
> Today, we'll be building a full-stack application, using React and Django. This is mostly the same as using React or Django separately, but there are a few main things we'll need to do differently.

> First, we'll need to `build` our react application, so that our django application can serve it from the static folder. We'll learn how to watch our jsx files for changes, so that they rebuild automatically when you make changes. We're not going to use the dev server any more!

> Next, we'll add Django REST Framework to our project to use the `@api_view` decorator. DRF has many features, and today, we'll only be using one of them. This decorator changes some default settings for CSRF protection, and replaces the `request` object with one that is more useful. 

> Lastly, we'll learn how to include CSRF tokens in AJAX requests, so that our application can be protected against CSRF vulnerabilities. 


### create django project

> Here's a rough outline of what we'll need to do today, to build a minimal full-stack application. 

- create a django project as usual:
    - `python -m django startproject <project_name>`
    - set up custom user model
    - set `AUTH_USER_MODEL` in `settings.py`
    - create/run migrations
    - declare `STATICFILES_DIRS` in `settings.py`
- create a react project: `npm create vite`
- edit `config.json` and build the react project
    - vite needs to place static assets in a folder that django will serve them from, and vite needs to write URLs in our `index.html` that our django server will recognize. 
    - your index.html will be copied from `./index.html` to `<outDir>/index.html`
    - your compiled static assets (js, css) will minified, concatenated, and copied from `./src/*` to `<outDir>/assets/*`
    - your uncompiled static assets (images, sounds, videos) will be copied, unmodified, from  `./public/*` to  `./dist/*`
- rebuild the project
	- we're no longer using the vite dev-server, we must rebuild the project to see changes to js files
	- watch the project for changes using a watch script in package.json: `"watch": "vite build --watch",`
- add Django Rest Framework and use `@api_view()` decorators
	- changes default CSRF protections to be more reasonable. Only logged-in users should need tokens
	- lets us declare which request methods a given URL can respond to
	- automatically parses the body as JSON
- store the authenticated user in react state
	- first, we'll need the usual signup, login, logout, whoami routes. 
	- request the logged in user from `/whoami` in a `useEffect` callback.
- use the CSRF token to make requests to the backend.
	- When using DRF, authenticated users must include a CSRF token to make requests other than GET requests
	- axios can be configured to automatically include this token in all requests


> Your `config.json` for vite might look a little like this:

```javascript
export default defineConfig({

  // vite uses this as a prefix for href and src URLs
  base: '/static/',
  build: {
    // this is the folder where vite will generate its output. Make sure django can serve files from here!
    outDir: '../shoe_proj/static',

    // delete the old build when creating the new build. 
    // this is the default behavior, unless outDir is outside of the current directory
    emptyOutDir: true,
	
	// vite will generate sourcemaps, which let you see logs and error messages with line numbers from our jsx files, not from the minified js
	sourcemap: true,

  },
  plugins: [react()]
})
```


> You can configure Axios to automatically send CSRF tokens by setting default headers:

```javascript
const getCSRFToken = ()=>{
    let csrfToken

    // the browser's cookies for this page are all in one string, separated by semi-colons
    const cookies = document.cookie.split(';')
    for ( let cookie of cookies ) {
        // individual cookies have their key and value separated by an equal sign
        const crumbs = cookie.split('=')
        if ( crumbs[0].trim() === 'csrftoken') {
            csrfToken = crumbs[1]
        }
    }
    return csrfToken
}
axios.defaults.headers.common['X-CSRFToken'] = getCSRFToken()

```


> We can make our front end aware of the logged in user by calling `whoAmI()` in a `useEffect`, and on `logOut`.

```javascript
  const logOut = function(event){
    event.preventDefault()
    axios.post('/logout').then((response)=>{
        console.log('response from server: ', response)
        whoAmI()
    })
    
  }
  
  const whoAmI = async ()=>{
    const response = await axios.get('/whoami')
    const user = response.data && response.data[0] && response.data[0].fields
    console.log('user? ', user)
    setUser(user)
  }

  useEffect(()=>{
		whoAmI()
  }, [])
  ```
# Deployment

## Topics Covered / Goals
- Deployment
  - run your app from a real server on the actual internet (AWS)
  - learn differences between localhost and a live site (gunicorn+nginx vs `python manage.py runserver`)
- DNS
  - understand that DNS is a network of databases, used to translate IP addresses into domain names
  - understand basic record types (A, CNAME)
- HTTPS
  - get a green lock in the url bar so your website looks trustworthy
  - understand what SSL/TLS and HTTPS are, and the types of attacks it prevents against
  - access 'powerful features' for the front-end that are only available in secure contexts, such as Geolocation, DeviceOrientation/DeviceMotion, getUserMedia, and WebMIDI

## Lesson

> We'll need to make a few changes to our django app to prepare it for deployment. 
- Set debug=False in settings.py.
- Set ALLOWED_HOSTS = ['*'] in settings.py
- Set CSRF_TRUSTED_ORIGINS = [' https://regularsizewebsite.com ']

- install gunicorn: `pip install gunicorn; pip freeze > requirements.txt`


### AWS EC2
> Amazon Web Services (AWS) has many services that can be used to build a web application, or other forms of digital infrastructure. We'll be deploying our applications using AWS EC2 (elastic compute cloud), which is the most basic AWS service, upon which many others are based. It's just a basic linux server that we can connect to with SSH and install our application.
> When you sign up initially, you get free access to many services for your first year. After that, you pay normal AWS rates, which are very competitive compared to other cloud computing providers. 
> After logging in, click on the search bar at the top and type in "ec2". Click through to the EC2 dashboard and click "Launch Instance". Next we'll choose an operating system. There are many options, but we'll be using Ubuntu because it's a very popular choice, and it's probably more similar to our dev environment than the other options. 
> After choosing the operating system, we have to choose the "Instance Type", which refers to the number of CPUs, amount of memory, and network speed for this instance. If we're sticking to the free tier, `t2.micro` is the only option, so this is an easy choice. 
> When we review our instance launch, we must choose an SSH key pair to use for logging in to this instance. We can also create them right here, since we haven't done this before. Download the private key to your local machine, and MAKE SURE YOU DON'T LOSE IT.
> We need to create a security group for our instance, which is a set of firewall rules. By default, no web traffic is allowed in or out of our instance! Check the boxes to enable traffic on port 22 (SSH), 80 (HTTP), and 443 (HTTPS).
> The last thing we need to do before we log into our instance is find its IP address. You can find this from the list of instances in your EC2 dashboard. 

> Now, we can log in to our server with SSH. 
```bash
ssh -i ~/.ssh/my_private_key.pem ubuntu@<ip_address>
```
> You might have gotten an error about the permissions on your private SSH key. If so, we might need to change the permissions on our private key to make it more secure.

```bash
sudo chmod 600 ~/code/keys/demo.pem
```

> After we successfully log into the server, we'll need to clone our project repository. Conveniently, git is preinstalled on the server.
```bash
git clone <repo_url>
```

Unfortunately, many other tools that we need are not installed yet. 

```bash
sudo apt update
sudo apt install python3-pip
sudo apt install postgresql
sudo -u postgres createuser --superuser $USER
sudo apt install libpq-dev
sudo apt install nginx-core
pip install -r requirements.txt
createdb <database_name>
python3 manage.py migrate

sudo apt install npm
sudo npm install -g n
sudo n stable

npm install
npm run build
```


> Django's built-in webserver is not fit to be a production web server on the public internet. We'll put another web server in front of it, called `nginx` (pronounced engine ex). After installing nginx, we'll need to modify a couple of config files.

> The main, global config file for nginx is located at `/etc/nginx/nginx.conf`. The first line of this file specifies the user that nginx runs as. By default, it's `www-data`, but we need to change it to the owner of the application files, `ubuntu`. You could instead change the owner of the application files to `www-data` using the command `chown`, if you prefer that. What matters is that they match. 

> There is a second config file, located in `/etc/nginx/sites-enabled/default`, which contains information specific to the application we want to run. In the config below, nginx will listen on port 80, and then pass those requests to port 9000. Also, any requests that start with `/static/` will be given files from `/build/static` in response. 

```
server {
  listen 80 default_server;
  listen [::]:80 default_server;
  # listen 443 ssl default_server;
  # listen [::]:443 ssl default_server;
  index index.html index.htm index.nginx-debian.html;
  server_name _;

  location / {
    proxy_pass http://0.0.0.0:9000;
  }
  location /static/ {
    alias /home/ubuntu/deployment-demo-app/news_project/build/static/;
  }
}
```
> nginx can listen for requests from the actual public internet, but it doesn't know specifically how to talk with a python application. We're going to use another tool called gunicorn that can receive requests from nginx at port 9000, and then pass them off to django.  We installed it earlier, so now let's try running the application with gunicorn: `gunicorn news_project.wsgi --bind 0.0.0.0:9000 --daemon`

### AWS Route53
> To get a domain name for our website, we'll need to use another AWS service, Route53, which is used for DNS and routing settings. After registering a domain name, click 'Manage DNS settings' for this domain. DNS is the Domain Name System, a network of servers that are used to convert domain names into IP addresses, so that clients can find the location of servers that they're looking for. We need to create an A Record, which simply maps a domain name to an IP address. The value for the record should be the IP address of our EC2 instance. All other fields can be left at their default settings. 

### SSL/TLS
> The last thing we need when we deploy our website is an SSL certificate, so we can serve traffic over HTTPS. Using HTTPS encrypts your HTTP traffic, which prevents hackers from viewing or modifying the pages your users visit or the forms they submit using a Man-in-the-middle attack (MitM). Using HTTPS also enables certain "powerful features" in the browser, such as hardware access (microphone, camera, accelerometer, GPS, MIDI devices) or notifications. 
> Thankfully, we can get these for free using [certbot](https://certbot.eff.org/instructions). Just select your server and OS (nginx on Ubuntu) and follow the instructions. Certbot will generate an SSL certificate for you, and then automatically change your nginx config file so that your app serves HTTPS traffic on port 443 using that certificate.

```bash
sudo snap install --classic certbot
sudo ln -s /snap/bin/certbot /usr/bin/certbot
sudo certbot --nginx
```

> After you restart the nginx server with `sudo service nginx restart`, your full stack news site should be publicly accessible over HTTPS.

## External Resources
- [certbot](https://certbot.eff.org/instructions)

## Assignments
- [Rock, Paper, Scissors](https://github.com/romeoplatoon/app-rock-paper-scissors)

- Start your [Personal Projects](https://github.com/romeoplatoon/assessment-5)!
- Personal Project ideas are DUE! You must have your personal project ideas approved by the end of today, and hopefully started later this afternoon. 



# Restful API design


## Topics Covered / Goals
- brief history of REST
- modern practices in RESTful design
- a case study with dropbox


## Lesson


### What is REST?
> REST (an acronym for REpresentational State Transfer), is a poorly understood concept that means different things to different people. Many newer developers understand REST as a system for mapping CRUD operations (create, read, update, delete) onto HTTP methods (POST, GET, PUT, DELETE). This is wrong, but it's a pretty useful way to understand REST if you just want to build an application that uses an API. 

> Other more experienced developers would say that you can't fully understand REST unless you read Roy T. Fielding's [doctoral dissertation](https://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm), published in the year 2000. This is correct, but not incredibly useful advice more than 20 years later. The internet as we use it today is very different from how it was in the year 2000, and very different from how Roy Fielding imagined it would be. For example, consider this gem of wisdom from his thesis: "cookie-based applications on the Web will never be reliable". In hindsight, this statement might seem silly, because today we know that cookies are a common and essential part of the modern web. 

> In modern practice, REST is a software architecture style for creating scalable web services that make resources available to clients. You do not need to implement every aspect of this style in your own API for it to be considered a REST API. However, the more of these aspects you implement, the more 'RESTful' the API is. Try to find a balance between conforming to well known standards, and building an API that fits the specific quirks of your application. 
- **REST** is NOT a specific technology/tool/library, or a standardized protocol. However, there are tools like djanjo-rest-framework that help you build APIs that conform to this style. 
- Most basic concept in **REST** is a resource.
- Any information that can be named can be a resource: a document or image, a temporal service (e.g. "today's weather in Los Angeles"), a collection of other resources, a non-virtual object (e.g. a person), etc.
- Resources can be collections (e.g. `/api/v2/users`) or singletons (e.g. `/api/v2/users/:userId`).
- a collection might contain collections (e.g. `/api/v2/user/123/comments/321`)
- Resources can be queried or modified using **HTTP** verbs.
- **REST** APIs usually represent resources as **JSON** data.

### Statelessness
- Server does not keep track of clients from one request to the next.
- Clients must supply all relevant information that the server needs to respond to the request. This state information is typically stored as session or cookie data.
- In a public RESTful API, accessing sensitive resources requires the client to send authentication credentials with every request.
- The APIs we build for our applications may leverage user's sessions, so that users can easily access their own data without authenticating every request. This is not perfectly RESTful, but it's very convenient.

### Methods (Verbs) & CRUD
> Requests can be sent using different HTTP verbs (METHODS) to perform different actions. Often these actions map to one of the four basic functions of persistent storage (CRUD), although REST and CRUD are not exactly the same thing.

> The most important aspect of these HTTP verbs is **idempotence**. This is described in [RFC 2616](https://datatracker.ietf.org/doc/html/rfc2616), which defines the HTTP standard. An RFC (request for comments) is a publication in a series, from the standards-setting bodies for the Internet, most prominently the Internet Engineering Task Force (IETF), an international volunteer organization that sets standards for the internet, such as TCP/IP.

### Safe/Idempotent
A **safe** request will have the same effect if run zero times (ie. GET)
An **idempotent** request will have the same effect if run one or more times (ie. PUT, DELETE)

Background: If you refresh a page with a GET/PUT/DELETE request, it will resubmit itself.
This is based on the assumption that those requests are safe/idempotent.
If a page with a POST request is refreshed, it will not resubmit without first confirming with the user (ie. "Do you wish to resubmit this form data?")
This is based on the assumption that those requests are not idempotent.

#### POST (Create)
- `POST` routes are not idempotent; each POST request may modify the server state.
- typically used for creating a new resource.

#### GET (Read)
- `GET` routes should be safe; they do not affect the server's state.
- typically used for retrieving a resource.

#### PUT (Update)
- `PUT` routes should be idempotent; sending duplicate requests affects the server once.
- typically used for creating a unique resource, or modifying a specific resource.

#### DELETE (Delete)
- `DELETE` routes should be idempotent; sending duplicate requests affects the server once.
- typically used for deleting a specific resource.

### Responses
> An API is considered RESTful when using meaningful HTTP response status codes

- `200`: successful
- `201`: created
- `204`: no content
- `304`: not modified
- `400`: malformed request
- `403`: forbidden
- `404`: not found
- `500`: Server error

## Example API

| VERB       | NOUN                         |
|------------|------------------------------|
| `POST`     | `/api/v2/users`              |
| `GET`      | `/api/v2/users/345`          |
| `GET`      | `/api/v2/users?city=Chicago` |
| `PUT`      | `/api/v2/users/345`          |
| `DELETE`   | `/api/v2/users/345`          |

> The URL should contain the resource we want to act upon. The URL should have NOUNS, not VERBS. The HTTP method (aka HTTP verb) describes what we want to do with that resource. However, there can be exceptions to this rule. Sometimes, you need to perform more than four different actions on the same resource, or maybe none of the existing HTTP methods accurately describe the action you want to perform. In REST, you can have an `action` as a nested resource. With django-rest-framework, you can declare [custom actions](https://www.django-rest-framework.org/api-guide/viewsets/#marking-extra-actions-for-routing).

| VERB       | NOUN                               |
|------------|------------------------------------|
| `POST`     | `/api/v2/users/345/set-password`   |

```python
class UserViewSet(viewsets.ModelViewSet):
    queryset = User.objects.all()
    serializer_class = UserSerializer

    @action(detail=True, methods=['post'])
    def set_password(self, request, pk=None):
        user = self.get_object()
        serializer = PasswordSerializer(data=request.data)
        if serializer.is_valid():
            user.set_password(serializer.validated_data['password'])
            user.save()
            return Response({'status': 'password set'})
        else:
            return Response(serializer.errors,
                            status=status.HTTP_400_BAD_REQUEST)

```

## Caching.
> A RESTful api should use cache control headers to instruct the client what to cache, and for how long.
> If a client requests current weather data, the API should instruct them not to cache it at all, since it will likely be different the next time they check the weather. If a client requests data about a historical event, the API should instruct them to cache that data indefinitely, since it will never change. These instructions are sent with cache-control headers on the response from the server.
> Setting cache-control headers is not hard, but since it's such a common need, [django](https://docs.djangoproject.com/en/4.0/topics/cache/#controlling-cache-using-other-headers) and [DRF](https://www.django-rest-framework.org/api-guide/caching/) both include decorators that make it a little easier to set these headers.

```python
from django.views.decorators.cache import cache_control

@cache_control(max_age=3600)
def my_view(request):
    ...
```


## HATEOAS (Hypermedia as the engine of application state)
> Every response from the server should contain links to related actions or resources so that the client can continue exploring the api.
> As much as possible, developers should not need to read our documentation to know how to use our api. the api responses themselves should serve as documentation.
> HATEOAS makes more sense if you're talking about an HTML API, where each resource is represented by an HTML page, with `<a>` links to other resources, and a user can interactively navigate from one resource to the next, ie 'the web'. More commonly, you need to know the API structure up front so you can programmatically use it from your own application. 
> Implementing HATEOAS in your API manually is probably not worth the effort. However, some REST API frameworks can generate these links for you automatically. 

> A good example of HATEOAS can be seen in the github API. For example, go to `https://api.github.com/repos/rserota/wad` in your browser, and you'll see how the github API represents a repository. Much of the information here is about the repo itself, such as the name, description, topics, and license. However, about half of the response is just other links, related to the response, such as forks, issues, and tags for this repository. 
> Another good example of an API that implements HATEOAS is the [pokemon API](https://pokeapi.co/), which we used earlier in this course. 




### Scenarios
> Imagine we're building an API for a bank. Let's think of some Restful routes we might write to handle common actions with accounts, transactions, or credit cards. 

- view current account balance
    * `GET    :: /api/accounts/123?fields=balance`
- view all transactions
    * `GET    :: /api/accounts/123/transactions`
- view a specific transaction
    * `GET    :: /api/accounts/transactions/55421`
- add a new credit card
    * `POST   :: /api/accounts/123/card`
- change your home address
    * `PUT    :: /api/accounts/123`
- make a deposit
    * `POST   :: /api/accounts/123/deposit`
- delete an expired credit card
    * `DELETE :: /api/accounts/123/card/456`

## When to use/not use REST
- Use REST to make resources on your server available to clients.
- Not all **HTTP** verbs make sense for every resource. Only use the ones you need.

### Case Study: Dropbox
- `/delta` route returns data, is idempotent, used to be a `GET` route.
- Querying `/delta` became too complex, exceeding limitations of `GET`, so Dropbox switched to `POST`.
- `REPORT` **HTTP** verb would be more **RESTful** (idempotent, can have a body), but it’s very obscure.
- `POST` is less **RESTful** in this context, but is easier for developers to understand and work with (not all **REST** clients support all methods).


## Assignments
- [RESTful API design](https://github.com/romeoplatoon/restful-api-design)
- [To Do List](https://github.com/romeoplatoon/app-to-do-lists)

# Regex

## Topics Covered / Goals

- Implement Regex methods in Python

## Lesson

### Regular Expressions (Regex)
- Regular Expressions, or regex, is the ability to use patterns to match character combinations. While every language has slightly different patterns to match these combinations, they fundamentally work the same
- It basically works like this:
  - A user inputs some text
  - Your compiler, using whatever language you decide, reads that input and pattern-matches it.
  - If it passes, do one thing. If it does not, do something else
- This is useful for something like phone number inputs or social security methods because people are terrible at putting their information into a form
  - For phone numbers, some people use parenthesis, others use periods, others use dashes, and others don't have any delimeters
  - Regex helps with this because they look for consistent patterns. In our case, we just want the numbers associated with a phone number input and to ignore the rest of the characters
- It's recommended for you to use `raw strings` instead of regular Python strings by prepending your string with `r` (e.g., `r("Hello\n\n")`). These raw strings will interpret the escaped characters as literally escaped characters, rather than Python's usual treatment of them as new line characters. **Let's get started on this**:

### Common usecases
- match a literal string
- require at least a certain number of characters (password length)
- validate SSN is valid (may or may not have dashes)
- validate a date is in the correct format

```python
import re # stands for Regular Expressions and brings in the Python re library into this file
## re.search() will search a string you pass in to see if it matches the regex pattern you have
string = 'June 24'
regex_pattern = r"([a-zA-Z]+) (\d+)" # any combination of letters, capital or not, followed by a space, followed by a digit of any length
print(re.search(regex_pattern, string)) # returns a `match` object with the thing that's matched up. This matches anywhere in the string
print(re.match(regex_pattern, string)) # same as above, but this matches the string starting from the beginning. only returns the first match
print(re.findall(regex_pattern, 'June 24 August 1 December 22')) # this returns a list of all matches
```
- Another example:
```python
import re
regex = r"[a-zA-Z]+ \d+"
matches = re.findall(regex, "June 24, August 9, Dec 12")
for match in matches:
    print(f"Full match: {match}")

## Find and replace
## replaced_string = re.sub(pattern, replacement_pattern, input_str, count, flags=0)
regex = r"([a-zA-Z]+) (\d+)"

print(re.sub(regex, r"\2 of \1", "June 24, August 9, Dec 12")) # 24 of June, 9 of August, 12 of Dec
```

## External Resources
- [Great Tutorial](https://www.datacamp.com/community/tutorials/python-regular-expression-tutorial)
- [Pythex](https://pythex.org/) Test your Python regex with this online tool.
- [Regex101](https://regex101.com)
- [Oldie but a goodie](https://blog.codinghorror.com/regular-expressions-now-you-have-two-problems/)
- [JS Regex](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions)
- [Data Camp Python Regex](https://www.datacamp.com/community/tutorials/python-regular-expression-tutorial) and [Learn Python](https://www.learnpython.org/en/Regular_Expressions)
- [Machine Learning Plus Python Regex](https://www.machinelearningplus.com/python/python-regex-tutorial-examples/)
- [Google's writeup on Python Regex](https://developers.google.com/edu/python/regular-expressions)

## Assignments
- [RegexOne](https://regexone.com/python) - highly recommended
- [Phone Numbers](https://github.com/romeoplatoon/algo-validate-phone) in Python Regular Expressions


# Web Security Workshop w/Ronnie Flathers

## Topics Covered / Goals
- learn about common web app vulnerabilities
- learn techniques for building secure applications
- capture flags

## Assignments

# Intermediate Git

This lecture will quickly review the git skills from the previous lecture, and also explain more advanced concepts that will be useful during group projects, such as remotes, branching, and merging. 


## Objectives
The student should understand repositories and repository management including:
- basic git commands: init, add, commit, checkout, status, log, push, pull
- commit references (head, absolute, relative)
- branching, merging
- advanced git commands: diff, merge, reset, revert
- branching strategy


### What is a Git repository?
A branching, historical timeline of commits

### Working on one local branch
- Where are we now?             `git status`
- Where have we been?           `git log`
    - shows all commits before head, which MAY be all commits in the repo
    - Note: Use `git log --all --graph --decorate` to show commit history with commit labels.
- What has changed?             `git diff`
    - compares any two commits or working files - defaults to head vs working files
- Going back in time            `git checkout [commit]`, detached head
    - absolute commit references
        - head - your current checked-out commit
        - commit id e.g. c32e68b8830d... etc etc etc
        - branch name, e.g. 'master'
        - head and branches are moving labels. commit id's never move
    - relative commit references
        - `head^`, `head^^`
        - `head~1`, `head~2`
    - destroy recent commits    `git reset --hard head`
    - commit to undo a commit   `git revert`
    - recreate the past         `git checkout [commit] [file]`


```bash
# where are we now?
mkdir git-demo
cd git-demo
git init
git status
touch first-file.txt
echo 'first line of text' >> first-file.txt # or just use your editor
git status
git add .
git commit -m 'added the first line of text'
git status

# what has changed?
echo 'second line of text' >> first-file.txt #or just use your editor
git diff # no arguments, compares work dir to current checked out commit
git add .
git commit -m 'added the second line of text'
git log # each commit has a permanent label, the commit ID. There are also movable labels, such as 'master' and 'head'

git diff <commit id> # one argument, compares current checked out commit to the commit passed as an argument
git diff HEAD~1 #tilde is a relative commit label, goes back n generations. different from ^, which grabs the nth parent, used for of merge commits

# going back in time
git checkout HEAD~1 # detached head state. dont make changes while head is detached, like a time traveler who doesn't want to alter the past
git checkout master # return to the present
echo 'third line of text' >> first-file.txt
git status
git diff
git reset --hard # deletes changes in work dir since last commit
git status
git reset --hard head~1 # permanently deletes the most recent commit. you should almost never do this, especially with code that is shared with others
touch second-file.txt
git add .
git commit -m 'second file'
git touch third-file.txt
git add .
git commit -m 'third file'
git log
git revert head~1 # doesn't exactly go back in time, but it creates a new commit that undoes a previous one
git log
ls # we reverted the commit that added the second file, so it should no longer be present in our work dir
git checkout head~1 . # when checkout is used with two arguments like this, it doesn't change the current checked out commit. instead, it changes your work dir to look as it did in this commit. You can test the code, and if you like, you can commit those changes. 
git status
git add .
git commit -m 'went back to a previous state'

```
           
### Working on multiple local branches
- view branches         `git branch`
- create branches       `git branch [branch]`
- delete branches       `git branch -d [branch]`
- switch branches       `git checkout [branch]`
- merge branches        `git merge [branch]`
    - what's changed?   `git diff [branch]`
    - trivial merge - fast-forward does not create a commit
    - automatic merge - recursive strategy creates a new commit
    - manual merge - merge conflicts require YOU to create a commit

```bash
git branch # shows our current branches. by default, we only have 'master'
git branch devlope # oops, mispelled our branch name
git branch -d devlope # I haven't pushed this branch yet, so i'll fix this before anyone notices
git branch develop # commonly, a project will have two permanent branches, master and develop
git log --graph --all --decorate=full # we created a new branch, but not a new commit. both 'master' and 'develop' point to the same commit
git checkout develop # switch to our new branch, develop
git log --graph --all --decorate=full # 'head' now points to develop, not master. develop and master both point to the same commit though
touch dev-file.txt
git add .
git commit -m 'added a file in the dev branch'
git diff master
git merge master # nothing happens, because there are no new changes in master that are missing from develop
git checkout master
git merge develop # fast-forward merge, because develop has new changes that are missing from master
git log --graph --all --decorate=full # no new commits were created, we just moved the label for master
touch master-file.txt
git add .
git commit -m 'added master file'
git checkout develop
echo 'text in the dev file' >> dev-file.txt
git add .
git commit -m 'added text in dev file'
git log --graph --all --decorate=full # we can now see a split in our git graph, because our branches have diverged
git diff master
git merge master # each branch has different changes, but git can automatically create a merge commit. This is the only time when a commit can have two parents!
git checkout master
git merge develop # after successfully merging master into develop, merging the other way will always be a fast-forward merge
echo 'master says no' >> first-file.txt
git add .
git commit -m 'master added text to first file'
git checkout develop
echo 'develop says yes' >> first-file.txt
git add .
git commit -m 'develop added text to first file'
git diff master # both branches changed the same line of the same file! git cannot merge these changes automatically
git merge master # this creates a merge conflict. manually fix your files in the places where git says it's confused
git add .
git commit -m 'resolved merge conflict'
git checkout master
git merge develop # this is a fast-forward merge, since we already resolved the conflict from merging master into develop. avoid resolving merge conflicts in master, if you can.
git log --graph --all --decorate=full # our branches have converged

```


### Working on remote branches
- pushing/updating remote branches      `git push [remote] [local branch]:[remote branch]`
- deleting remote branches              `git push [remote] :[remote branch]`
- viewing remotes branches
    - view remote-tracking branches     `git branch -a`
    - list git remotes                  `git remote`
- pulling/merging from remote branches  `git pull = git fetch + git merge

```bash
# first, let's create a repo in github so we have somewhere to push our local repo
git remote # nothing to see here
git remote add origin https://github.com/raphael-codeplatoon/git-demo.git # it is VERY customary to name the first remote 'origin'
git remote -v # view your remote branches
git push origin master:master # push our local master branch onto origin's master branch
git push origin master # commonly, the source branch and target branch have the same name, so you can use the shortcut

git branch oops # another mistakenly created branch
git push origin oops # even worse, I pushed my mistake to github
git push origin :oops # deleting branches uses the same syntax! we push _nothing_ from our local repo onto the 'oops' branch in the remote repo.

# how would we update our local repo with code from other developers on our team?
# let's edit a file in github, to simulate another developer changing the code.

git fetch # this downloads the changes from github, but it doesn't affect our local branches. so where did it go?
git branch -a # this shows all branches, including remote-tracking branches, which are automatically updated to mirror the remote when you use 'git fetch' or 'git push'
git diff remotes/origin/master
git merge remotes/origin/master # merge the code we fetched from origin into our local master branch

# it's not usually necessary to manually fetch and then merge code from a remote. a common shortcut is using 'git pull origin master', which is just 'git fetch origin' followed by 'git merge remotes/origin/master'
git pull origin master

```

## Branching strategy and Git Flow
- Long-term branches
    - Master - live production code, **MUST** not break
    - Develop - merges into master, **SHOULD** not break
- Short-term branches
    - feature/ - branch off develop, merge into develop
    - bugfix/ - branch off develop, merge into develop
    - hotfix/ - branch off master, merge into master


## Assignments
- [Learn Git Branching](https://learngitbranching.js.org/)

# Application Testing

## Topics Covered

## Goals
- Learn how to test a web application

## Lesson

### WHO writes tests?
- Developers test their own code
  - developers are more responsible for making sure their code actually works
  - developers understand the requirements better
- Dedicated testing team
  - allows efficient division of labor

> There are merits to both styles of testing, but for the rest of this lecture, we'll assume that we will be testing our own code. 

### WHY write tests?
> Testing code is one of the most important things you can learn to do in your software development career. Many employers will not hire you if you do not have at least `SOME` understanding of what testing is and how to begin doing it.

Testing your code helps you build confidence in your logic, assuring you that your code will work as expected in production and will `CONTINUE` to work in production over time as you add features to the application and expand your test suite (group of tests). 

- Catching bugs in development is cheaper/faster than catching them in production
- Gives confidence that you can refactor old code without breaking critical components
- Helps enable continuous delivery, so you can ship code more frequently
  - some dev shops with poor tests rely on manual testing to have confidence that a new app version is stable
- Prevents bugs from reoccurring
- serves as verifiable documentation of the code

### Types of Testing
> There are several types of testing, tons of testing frameworks, and tons of different opinions on what testing even is, how to do it, and what to call things. We could give an entire boot camp on testing! But for now, instead, we will just cover the basics.

#### Unit testing
> A software development process in which the smallest testable parts of an application, called units, are individually and independently scrutinized for proper operation.

- is often automated but it can also be done manually.
- usually testing the inputs and outputs of a single function in a application
- should be very fast
- for **JavaScript**, you will likely use
    - `jasmine` (front-end/back-end assertion library)
    - `mocha` (opinionated testing framework oriented toward express)
    - `chai` (front-end/back-end assertion library)
    - `jest` (a library from facebook that is commonly used with react)

##### Steps
1. Determine the inputs of each function of an application
    - define the inputs in `optimistic` cases (good user input, expected API inputs, etc.)
    - define the inputs in `pessimistic` cases (bad user input, `undefined`, etc.)
2. Create assertions (expectations) for your test cases
3. Execute units tests
4. Verify assertions satisfy expectations



> Let's write a couple unit tests using vitest. First, we'll need to install it with `npm install vitest`. Then, we'll want to add a script to our `package.json` that invokes vitest: `"test": "vitest run"`. This will cause vitest to search through our project for any file that ends with `.test.js`, and test that file.


> Let's create a basic test suite, containing a single test. We'll make a folder called `tests`, and create a file inside called `random.test.js`. 
```javascript
import { expect, it, describe} from 'vitest'

describe('Math.max', ()=>{
	it('should return the largest number', ()=>{
		const biggerNumber = Math.max(1,5)
    	expect(biggerNumber).toBe(5) 
	})
})
```
> Even though this test is about as simple can be, there are probably a few unfamiliar concepts here. First, notice that our entire test suite is contained inside of the `describe()` call. `describe` is simply used for grouping and labeling tests. The first argument is a string that describes the contents of that `describe` block, and the second argument is a callback function that contains all the tests that are grouped under that `describe` block.

> Inside of describe, we have an `it` block. `it` is similar to `describe` in that its first argument is a string describing the test, and then the second argument is a callback function that contains a specific test. Unlike `describe`, `it` is more specific. Whereas `describe` is for describing/grouping multiple tests, `it` is supposed to contain a single test. 

> Inside of the test in the `it` block, there may be multiple expectations, but the example above has only one. `expect` is a function that takes an expression, and lets us make an assertion about its value. The above example has a simple assertion, testing that it is equal to some specific value, `5`. If that's not true, `expect` will throw an error. After running your tests, the test runner will show you all the tests that failed, with their labels printed out. For a failed test, we might see output like this: 

```
 FAIL  tests/unit/math.test.js > Math.max > should return the largest number
AssertionError: expected 5 to be 1
```

> Notice how the strings from our `describe` and `it` blocks were concatenated together in the error message. If you are thoughtful about how you write these strings, then the error output from your tests will be a grammatical english sentence that describes exactly what went wrong. 

> Like we mentioned before, a good test suite should contain both optimistic and pessimistic tests. Let's add some more tests to our suite.

```javascript
import { expect, it, describe} from 'vitest'

describe('Math.max', ()=>{
    describe('with valid inputs', ()=>{
        it('should return the largest number', ()=>{
            const biggerNumber = Math.max(1,5)
            expect(biggerNumber).toBe(5) 
        })
        it('should handle negative numbers', ()=>{
            const biggerNumber = Math.max(1,-5)
            expect(biggerNumber).toBe(1) 
        })
        it('should handle any number of inputs', ()=>{
            const biggerNumber = Math.max(1,2,3,4,5,6)
            expect(biggerNumber).toBe(6) 
        })
    })
    describe('with invalid inputs', ()=>{
        it('cannot return the largest value from an array', ()=>{
            expect(Math.max([1,2])).toBe(NaN)
        })
        it('cannot return the largest value from a list of strings', ()=>{
            expect(Math.max('a', 'b')).toBe(NaN)
        })
    })
})
```


> In order to unit test our code, we might need to refactor it to make it testable. You want as much of your application as possible to consist of small, pure functions, that only take input and return output, without causing side effects. These functions should be exported from the files they're written in, so that they can be imported into the test file. 

```javascript
const getCSRFToken = (cookieString)=>{
    let csrfToken
  
    // the browser's cookies for this page are all in one string, separated by semi-colons
    const cookies = cookieString.split(';')
    for ( let cookie of cookies ) {
        // individual cookies have their key and value separated by an equal sign
        const crumbs = cookie.split('=')
        if ( crumbs[0].trim() === 'csrftoken') {
            csrfToken = crumbs[1]
        }
    }
    return csrfToken
  }

export {
    getCSRFToken,
}
```

> The code above is the function we use for getting the CSRF token from the cookie string, but we've made some changes to it to make it testable. First, instead of letting this function directly access the cookie string from the document, it is passed in as an argument. Also, we defined this function in its own file and exported it, instead of defining it directly in a component's file. 

##### Mocking
> It's very important that our unit tests are fast, but sometimes we want to test functions that perform slow or expensive operations. We can use a mock function that simply returns some hardcoded value instead of actually performing the slow operation. For example, you might create a mock to generate API responses, or database query sets, because sending API requests and querying the database are both slower than a unit test should be. 

#### Integration testing
> Tests the connection between two or more components. These are slower than unit tests, but still relatively fast. An individual integration test is generally more valuable than an individual unit test, because it simultaneously tests many parts of the system. 

- Usually tests a `process` within an application, but does not usually test an entire `feature`.
- Common examples:
  - testing functions that query the database
  - testing API routes




#### Functional/End-to-end testing
> Test an entire feature, from the client to the server and back. These are the slowest kinds of tests you can write, because they require automating a web browser, but they also give you the most reliable information about whether your application as a whole "works" from a user's perspective. You can drive a browser to click links, submit forms, read text off the screen, and most other actions that a human user could do with a browser. 



- Verifies that each `feature` of a piece of software satisfies the `application requirements`
- Mainly involves `black box` testing, meaning the tests are not concerned about the `source code` of the application
  - Functional tests can be done by a dedicated testing team that doesn't even know the language the app is written in
- Each and every `feature` of the system is tested by providing appropriate input (optimistic), verifying the output, and comparing the actual results with the expected results
- Involves testing the UI, APIs, Database, security, and the client & server side of applications
- Can be `automated` or driven `manually`
- Use tools such as Selenium or puppeteer. 

> Traditionally, Selenium was by far the most popular choice for browser automation. More recently, many other similar tools have been created that are simpler and more convenient. Today, we'll be using Puppeteer.

```bash
npm install puppeteer --save-dev
```

```javascript
describe('the application', ()=>{
    let browser
    let page
    beforeAll( async ()=>{
        browser = await puppeteer.launch({headless:false, slowMo: 100})
        page = await browser.newPage()
    })
    afterAll( async ()=>{
        await browser.close()
    })
    describe('homepage', ()=>{
        it('should welcome the user', async ()=>{
            await page.goto('http://localhost:8000')
            await page.waitForSelector('#welcome')
            const welcomeEl = await page.$('#welcome')
            const welcomeText = await welcomeEl.evaluate((el)=> el.innerText)
            console.log(welcomeText)
            expect(welcomeText.includes('Welcome')).toBe(true)
        })
	})
})
      
```

##### Steps
1. Understand the feature requirements
2. Establish sensible input
3. Establish expected output
4. Execute test cases
5. Compare actual results with expected results

### HOW MANY tests to write?
> Writing tests is expensive. 100% test coverage is not necessarily your goal.

- It takes time to write tests initially, and they need to be maintained as your application changes over time.
- Tests themselves can have bugs
- Each test raises the possibility of false-positive, which waste time
- Each test increases the length of your test results, making them harder to read

Make sure you get more value from your tests than they cost you to create. Only test 'important' features of your application.

- The CSS on the admin dashboard of your app will probably never break, and if it does, barely anyone will notice. If they do, they might not even care. Don't Go crazy testing that every CSS rule in your app applies correctly on every page.
- Signup/Login is probably critical to your application. Many applications are worthless if users can't log in. Do test the signup and login features of your app. Test all of the common failure cases (wrong username, wrong password, etc.) to be sure that your login/signup functionality behaves correctly in all cases.

### WHEN to WRITE tests
- **basic**: Writes tests after you complete a feature to make sure that it works, and won't break in the future.
- **reactive**: When a bug happens in production, fix the bug and write a test to make sure it doesn't happen again.
- **TDD**: Write tests before you even start writing the code for a feature and watch it fail. 
  - This helps define the requirements for that feature. 
  - This style of programming tends to slow down development while reducing bugs, which is useful depending on what you're writing code for, e.g. medical devices, security systems, etc. 

### WHEN to RUN tests
- **basic**: Run tests manually after making major changes, and before you deploy your app.
- **continuous integration**: Run your tests automatically, so you can deploy automatically.
- **before deploying to a different environment**: Run selective tests in Development before releasing to Staging, run all tests in Staging before releasing to Production.
- If your tests are fast enough to run in seconds, you can configure your editor to run them when you save a file.
- If your tests are fast enough to run in minutes, you can configure git to run the tests every time you commit.

## External Resources
- [Jest](https://jestjs.io/docs/getting-started)
- [Puppeteer](https://github.com/puppeteer/puppeteer)

## Assignments
